!function(){"use strict";var __webpack_modules__={706:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new Map;t.default=n},8905:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,s,a,l){return new(a=a||Promise)(function(n,t){function r(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,i)}o((l=l.apply(e,s||[])).next())})},a=this&&this.__generator||function(r,i){var o,s,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,s=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!((a=0<(a=l.trys).length&&a[a.length-1])||6!==t[0]&&2!==t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){l.label=t[1];break}if(6===t[0]&&l.label<a[1]){l.label=a[1],a=t;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(t);break}a[2]&&l.ops.pop(),l.trys.pop();continue}t=i.call(r,l)}catch(e){t=[6,e],s=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sreReady=t.Sre=void 0;var c=o(n(9037)),u=o(n(907)),d=o(n(7317)),p=o(n(4998)),h=l(n(4886)),f=n(3955),o=o(n(9009)),m=n(4513),g=l(n(706));(n=l=t.Sre||(t.Sre={})).locales=m.Variables.LOCALES,n.sreReady=c.engineReady,n.setupEngine=c.setupEngine,n.engineSetup=c.engineSetup,n.toEnriched=c.toEnriched,n.toSpeech=c.toSpeech,n.clearspeakPreferences=f.ClearspeakPreferences,n.getHighlighter=o.highlighter,n.getSpeechGenerator=d.generator,n.getWalker=u.walker,n.clearspeakStyle=function(){return p.DOMAIN_TO_STYLES.clearspeak},n.preloadLocales=function(t){return s(this,void 0,void 0,function(){var n;return a(this,function(e){return[2,(n=g.default.get(t))?new Promise(function(e,t){return e(JSON.stringify(n))}):c.localeLoader()(t)]})})},t.sreReady=l.sreReady,h.default.getInstance().delay=!0,t.default=l},7306:function(e,t){t.q=void 0,t.q="3.2.2"},3021:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.MJContextMenu=void 0,n(9964)),d=n(2745),n=(i=s.ContextMenu,o(p,i),p.prototype.post=function(e,t){var n,r;this.mathItem&&(void 0!==t&&(n=this.mathItem.inputJax.name,(r=this.findID("Show","Original")).content="MathML"===n?"Original MathML":n+" Commands",this.findID("Copy","Original").content=r.content,r=this.findID("Settings","semantics"),"MathML"===n?r.disable():r.enable(),this.getAnnotationMenu(),this.dynamicSubmenus()),i.prototype.post.call(this,e,t))},p.prototype.unpost=function(){i.prototype.unpost.call(this),this.mathItem=null},p.prototype.findID=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=this,o=null;try{for(var s=c(n),a=s.next();!a.done;a=s.next()){var l=a.value;i?i=(o=i.find(l))instanceof d.Submenu?o.submenu:null:o=null}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return o},p.prototype.getAnnotationMenu=function(){var e=this,t=this.getAnnotations(this.getSemanticNode());this.createAnnotationMenu("Show",t,function(){return e.showAnnotation.post()}),this.createAnnotationMenu("Copy",t,function(){return e.copyAnnotation()})},p.prototype.getSemanticNode=function(){for(var e=this.mathItem.root;e&&!e.isKind("semantics");){if(e.isToken||1!==e.childNodes.length)return null;e=e.childNodes[0]}return e},p.prototype.getAnnotations=function(e){var t,n,r=[];if(!e)return r;try{for(var i=c(e.childNodes),o=i.next();!o.done;o=i.next()){var s,a,l=o.value;!l.isKind("annotation")||(s=this.annotationMatch(l))&&(a=l.childNodes.reduce(function(e,t){return e+t.toString()},""),r.push([s,a]))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},p.prototype.annotationMatch=function(e){var t,n,r=e.attributes.get("encoding");try{for(var i=c(Object.keys(this.annotationTypes)),o=i.next();!o.done;o=i.next()){var s=o.value;if(0<=this.annotationTypes[s].indexOf(r))return s}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null},p.prototype.createAnnotationMenu=function(e,t,r){var i=this,e=this.findID(e,"Annotation");e.submenu=this.factory.get("subMenu")(this.factory,{items:t.map(function(e){var e=u(e,2),t=e[0],n=e[1];return{type:"command",id:t,content:t,action:function(){i.annotation=n,r()}}}),id:"annotations"},e),t.length?e.enable():e.disable()},p.prototype.dynamicSubmenus=function(){var t,e;try{for(var n=c(p.DynamicSubmenus),r=n.next();!r.done;r=n.next()){var i,o=u(r.value,2),s=o[0],a=o[1],l=this.find(s);l&&(i=a(this,l),(l.submenu=i).items.length?l.enable():l.disable())}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},p.DynamicSubmenus=new Map,p);function p(){var e=null!==i&&i.apply(this,arguments)||this;return e.mathItem=null,e.annotation="",e.annotationTypes={},e}t.MJContextMenu=n},1062:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=(Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=void 0,n(3184)),c=n(4769),s=n(8723),a=n(9077),l=n(3021),d=n(9232),p=n(7309),h=n(6932),f=n(7258),m=n(1156),g=n(6837),b=i(n(8905)),y=s.MathJax,S="undefined"!=typeof window&&window.navigator&&"Mac"===window.navigator.platform.substr(0,3);function E(e,t){void 0===t&&(t={});var n=this;this.settings=null,this.defaultSettings=null,this.menu=null,this.MmlVisitor=new d.MmlVisitor,this.jax={CHTML:null,SVG:null},this.rerenderStart=c.STATE.LAST,this.about=new h.Info('<b style="font-size:120%;">MathJax</b> v'+o.mathjax.version,function(){var e=[];return e.push("Input Jax: "+n.document.inputJax.map(function(e){return e.name}).join(", ")),e.push("Output Jax: "+n.document.outputJax.name),e.push("Document Type: "+n.document.kind),e.join("<br/>")},'<a href="https://www.mathjax.org">www.mathjax.org</a>'),this.help=new h.Info("<b>MathJax Help</b>",function(){return["<p><b>MathJax</b> is a JavaScript library that allows page"," authors to include mathematics within their web pages."," As a reader, you don't need to do anything to make that happen.</p>","<p><b>Browsers</b>: MathJax works with all modern browsers including"," Edge, Firefox, Chrome, Safari, Opera, and most mobile browsers.</p>","<p><b>Math Menu</b>: MathJax adds a contextual menu to equations."," Right-click or CTRL-click on any mathematics to access the menu.</p>",'<div style="margin-left: 1em;">',"<p><b>Show Math As:</b> These options allow you to view the formula's"," source markup (as MathML or in its original format).</p>","<p><b>Copy to Clipboard:</b> These options copy the formula's source markup,"," as MathML or in its original format, to the clipboard"," (in browsers that support that).</p>","<p><b>Math Settings:</b> These give you control over features of MathJax,"," such the size of the mathematics, and the mechanism used"," to display equations.</p>","<p><b>Accessibility</b>: MathJax can work with screen"," readers to make mathematics accessible to the visually impaired."," Turn on the explorer to enable generation of speech strings"," and the ability to investigate expressions interactively.</p>","<p><b>Language</b>: This menu lets you select the language used by MathJax"," for its menus and warning messages. (Not yet implemented in version 3.)</p>","</div>","<p><b>Math Zoom</b>: If you are having difficulty reading an"," equation, MathJax can enlarge it to help you see it better, or"," you can scall all the math on the page to make it larger."," Turn these features on in the <b>Math Settings</b> menu.</p>","<p><b>Preferences</b>: MathJax uses your browser's localStorage database"," to save the preferences set via this menu locally in your browser.  These"," are not used to track you, and are not transferred or used remotely by"," MathJax in any way.</p>"].join("\n")},'<a href="https://www.mathjax.org">www.mathjax.org</a>'),this.mathmlCode=new p.SelectableInfo("MathJax MathML Expression",function(){if(!n.menu.mathItem)return"";var e=n.toMML(n.menu.mathItem);return"<pre>"+n.formatSource(e)+"</pre>"},""),this.originalText=new p.SelectableInfo("MathJax Original Source",function(){if(!n.menu.mathItem)return"";var e=n.menu.mathItem.math;return'<pre style="font-size:125%; margin:0">'+n.formatSource(e)+"</pre>"},""),this.annotationText=new p.SelectableInfo("MathJax Annotation Text",function(){if(!n.menu.mathItem)return"";var e=n.menu.annotation;return'<pre style="font-size:125%; margin:0">'+n.formatSource(e)+"</pre>"},""),this.zoomBox=new h.Info("MathJax Zoomed Expression",function(){if(!n.menu.mathItem)return"";var e=n.menu.mathItem.typesetRoot.cloneNode(!0);return e.style.margin="0",'<div style="font-size: '+1.25*parseFloat(n.settings.zscale)+'%">'+e.outerHTML+"</div>"},""),this.document=e,this.options=(0,a.userOptions)((0,a.defaultOptions)({},this.constructor.OPTIONS),t),this.initSettings(),this.mergeUserSettings(),this.initMenu(),this.applySettings()}Object.defineProperty(E.prototype,"isLoading",{get:function(){return 0<E.loading},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"loadingPromise",{get:function(){return this.isLoading?E._loadingPromise=E._loadingPromise?E._loadingPromise:new Promise(function(e,t){E._loadingOK=e,E._loadingFailed=t}):Promise.resolve()},enumerable:!1,configurable:!0}),E.prototype.initSettings=function(){this.settings=this.options.settings,this.jax=this.options.jax;var e=this.document.outputJax;this.jax[e.name]=e,this.settings.renderer=e.name,y._.a11y&&y._.a11y.explorer&&Object.assign(this.settings,this.document.options.a11y),this.settings.scale=e.options.scale,this.defaultSettings=Object.assign({},this.settings)},E.prototype.initMenu=function(){var n=this,e=new f.Parser([["contextMenu",l.MJContextMenu.fromJson.bind(l.MJContextMenu)]]),e=(this.menu=e.parse({type:"contextMenu",id:"MathJax_Menu",pool:[this.variable("texHints"),this.variable("semantics"),this.variable("zoom"),this.variable("zscale"),this.variable("renderer",function(e){return n.setRenderer(e)}),this.variable("alt"),this.variable("cmd"),this.variable("ctrl"),this.variable("shift"),this.variable("scale",function(e){return n.setScale(e)}),this.variable("explorer",function(e){return n.setExplorer(e)}),this.a11yVar("highlight"),this.a11yVar("backgroundColor"),this.a11yVar("backgroundOpacity"),this.a11yVar("foregroundColor"),this.a11yVar("foregroundOpacity"),this.a11yVar("speech"),this.a11yVar("subtitles"),this.a11yVar("braille"),this.a11yVar("viewBraille"),this.a11yVar("locale",function(e){return b.default.setupEngine({locale:e})}),this.a11yVar("speechRules",function(e){var e=r(e.split("-"),2),t=e[0],e=e[1];n.document.options.sre.domain=t,n.document.options.sre.style=e}),this.a11yVar("magnification"),this.a11yVar("magnify"),this.a11yVar("treeColoring"),this.a11yVar("infoType"),this.a11yVar("infoRole"),this.a11yVar("infoPrefix"),this.variable("autocollapse"),this.variable("collapsible",function(e){return n.setCollapsible(e)}),this.variable("inTabOrder",function(e){return n.setTabOrder(e)}),this.variable("assistiveMml",function(e){return n.setAssistiveMml(e)})],items:[this.submenu("Show","Show Math As",[this.command("MathMLcode","MathML Code",function(){return n.mathmlCode.post()}),this.command("Original","Original Form",function(){return n.originalText.post()}),this.submenu("Annotation","Annotation")]),this.submenu("Copy","Copy to Clipboard",[this.command("MathMLcode","MathML Code",function(){return n.copyMathML()}),this.command("Original","Original Form",function(){return n.copyOriginal()}),this.submenu("Annotation","Annotation")]),this.rule(),this.submenu("Settings","Math Settings",[this.submenu("Renderer","Math Renderer",this.radioGroup("renderer",[["CHTML"],["SVG"]])),this.rule(),this.submenu("ZoomTrigger","Zoom Trigger",[this.command("ZoomNow","Zoom Once Now",function(){return n.zoom(null,"",n.menu.mathItem)}),this.rule(),this.radioGroup("zoom",[["Click"],["DoubleClick","Double-Click"],["NoZoom","No Zoom"]]),this.rule(),this.label("TriggerRequires","Trigger Requires:"),this.checkbox(S?"Option":"Alt",S?"Option":"Alt","alt"),this.checkbox("Command","Command","cmd",{hidden:!S}),this.checkbox("Control","Control","ctrl",{hiddne:S}),this.checkbox("Shift","Shift","shift")]),this.submenu("ZoomFactor","Zoom Factor",this.radioGroup("zscale",[["150%"],["175%"],["200%"],["250%"],["300%"],["400%"]])),this.rule(),this.command("Scale","Scale All Math...",function(){return n.scaleAllMath()}),this.rule(),this.checkbox("texHints","Add TeX hints to MathML","texHints"),this.checkbox("semantics","Add original as annotation","semantics"),this.rule(),this.command("Reset","Reset to defaults",function(){return n.resetDefaults()})]),this.submenu("Accessibility","Accessibility",[this.checkbox("Activate","Activate","explorer"),this.submenu("Speech","Speech",[this.checkbox("Speech","Speech Output","speech"),this.checkbox("Subtitles","Speech Subtitles","subtitles"),this.checkbox("Braille","Braille Output","braille"),this.checkbox("View Braille","Braille Subtitles","viewBraille"),this.rule(),this.submenu("A11yLanguage","Language"),this.rule(),this.submenu("Mathspeak","Mathspeak Rules",this.radioGroup("speechRules",[["mathspeak-default","Verbose"],["mathspeak-brief","Brief"],["mathspeak-sbrief","Superbrief"]])),this.submenu("Clearspeak","Clearspeak Rules",this.radioGroup("speechRules",[["clearspeak-default","Auto"]])),this.submenu("ChromeVox","ChromeVox Rules",this.radioGroup("speechRules",[["chromevox-default","Standard"],["chromevox-alternative","Alternative"]]))]),this.submenu("Highlight","Highlight",[this.submenu("Background","Background",this.radioGroup("backgroundColor",[["Blue"],["Red"],["Green"],["Yellow"],["Cyan"],["Magenta"],["White"],["Black"]])),{type:"slider",variable:"backgroundOpacity",content:" "},this.submenu("Foreground","Foreground",this.radioGroup("foregroundColor",[["Black"],["White"],["Magenta"],["Cyan"],["Yellow"],["Green"],["Red"],["Blue"]])),{type:"slider",variable:"foregroundOpacity",content:" "},this.rule(),this.radioGroup("highlight",[["None"],["Hover"],["Flame"]]),this.rule(),this.checkbox("TreeColoring","Tree Coloring","treeColoring")]),this.submenu("Magnification","Magnification",[this.radioGroup("magnification",[["None"],["Keyboard"],["Mouse"]]),this.rule(),this.radioGroup("magnify",[["200%"],["300%"],["400%"],["500%"]])]),this.submenu("Semantic Info","Semantic Info",[this.checkbox("Type","Type","infoType"),this.checkbox("Role","Role","infoRole"),this.checkbox("Prefix","Prefix","infoPrefix")],!0),this.rule(),this.checkbox("Collapsible","Collapsible Math","collapsible"),this.checkbox("AutoCollapse","Auto Collapse","autocollapse",{disabled:!0}),this.rule(),this.checkbox("InTabOrder","Include in Tab Order","inTabOrder"),this.checkbox("AssistiveMml","Include Hidden MathML","assistiveMml")]),this.submenu("Language","Language"),this.rule(),this.command("About","About MathJax",function(){return n.about.post()}),this.command("Help","MathJax Help",function(){return n.help.post()})]}),this.menu);this.about.attachMenu(e),this.help.attachMenu(e),this.originalText.attachMenu(e),this.annotationText.attachMenu(e),this.mathmlCode.attachMenu(e),this.zoomBox.attachMenu(e),this.checkLoadableItems(),this.enableExplorerItems(this.settings.explorer),e.showAnnotation=this.annotationText,e.copyAnnotation=this.copyAnnotation.bind(this),e.annotationTypes=this.options.annotationTypes,g.CssStyles.addInfoStyles(this.document.document),g.CssStyles.addMenuStyles(this.document.document)},E.prototype.checkLoadableItems=function(){var e,t;if(y&&y._&&y.loader&&y.startup)!this.settings.collapsible||y._.a11y&&y._.a11y.complexity||this.loadA11y("complexity"),!this.settings.explorer||y._.a11y&&y._.a11y.explorer||this.loadA11y("explorer"),!this.settings.assistiveMml||y._.a11y&&y._.a11y["assistive-mml"]||this.loadA11y("assistive-mml");else{var n=this.menu;try{for(var r=u(Object.keys(this.jax)),i=r.next();!i.done;i=r.next()){var o=i.value;this.jax[o]||n.findID("Settings","Renderer",o).disable()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}n.findID("Accessibility","Activate").disable(),n.findID("Accessibility","AutoCollapse").disable(),n.findID("Accessibility","Collapsible").disable()}},E.prototype.enableExplorerItems=function(e){var t,n,r=this.menu.findID("Accessibility","Activate").menu;try{for(var i=u(r.items.slice(1)),o=i.next();!o.done;o=i.next()){var s=o.value;if(s instanceof m.Rule)break;e?s.enable():s.disable()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},E.prototype.mergeUserSettings=function(){try{var e=localStorage.getItem(E.MENU_STORAGE);if(!e)return;Object.assign(this.settings,JSON.parse(e)),this.setA11y(this.settings)}catch(e){console.log("MathJax localStorage error: "+e.message)}},E.prototype.saveUserSettings=function(){var t,e,n={};try{for(var r=u(Object.keys(this.settings)),i=r.next();!i.done;i=r.next()){var o=i.value;this.settings[o]!==this.defaultSettings[o]&&(n[o]=this.settings[o])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}try{Object.keys(n).length?localStorage.setItem(E.MENU_STORAGE,JSON.stringify(n)):localStorage.removeItem(E.MENU_STORAGE)}catch(e){console.log("MathJax localStorage error: "+e.message)}},E.prototype.setA11y=function(e){y._.a11y&&y._.a11y.explorer&&y._.a11y.explorer_ts.setA11yOptions(this.document,e)},E.prototype.getA11y=function(e){if(y._.a11y&&y._.a11y.explorer)return(void 0!==this.document.options.a11y[e]?this.document.options.a11y:this.document.options.sre)[e]},E.prototype.applySettings=function(){this.setTabOrder(this.settings.inTabOrder),this.document.options.enableAssistiveMml=this.settings.assistiveMml,this.document.outputJax.options.scale=parseFloat(this.settings.scale),this.settings.renderer!==this.defaultSettings.renderer&&this.setRenderer(this.settings.renderer)},E.prototype.setScale=function(e){this.document.outputJax.options.scale=parseFloat(e),this.document.rerender()},E.prototype.setRenderer=function(t){var n,r=this;this.jax[t]?this.setOutputJax(t):(n=t.toLowerCase(),this.loadComponent("output/"+n,function(){var e=y.startup;n in e.constructors&&(e.useOutput(n,!0),e.output=e.getOutputJax(),r.jax[t]=e.output,r.setOutputJax(t))}))},E.prototype.setOutputJax=function(e){this.jax[e].setAdaptor(this.document.adaptor),this.document.outputJax=this.jax[e],this.rerender()},E.prototype.setTabOrder=function(e){this.menu.store.inTaborder(e)},E.prototype.setAssistiveMml=function(e){!(this.document.options.enableAssistiveMml=e)||y._.a11y&&y._.a11y["assistive-mml"]?this.rerender():this.loadA11y("assistive-mml")},E.prototype.setExplorer=function(e){this.enableExplorerItems(e),!(this.document.options.enableExplorer=e)||y._.a11y&&y._.a11y.explorer?this.rerender(this.settings.collapsible?c.STATE.RERENDER:c.STATE.COMPILED):this.loadA11y("explorer")},E.prototype.setCollapsible=function(e){!(this.document.options.enableComplexity=e)||y._.a11y&&y._.a11y.complexity?this.rerender(c.STATE.COMPILED):this.loadA11y("complexity")},E.prototype.scaleAllMath=function(){var e=(100*parseFloat(this.settings.scale)).toFixed(1).replace(/.0$/,""),e=prompt("Scale all mathematics (compared to surrounding text) by",e+"%");e&&(e.match(/^\s*\d+(\.\d*)?\s*%?\s*$/)?(e=parseFloat(e)/100)?this.menu.pool.lookup("scale").setValue(String(e)):alert("The scale should not be zero"):alert("The scale should be a percentage (e.g., 120%)"))},E.prototype.resetDefaults=function(){E.loading++;var t,e,n=this.menu.pool,r=this.defaultSettings;try{for(var i=u(Object.keys(this.settings)),o=i.next();!o.done;o=i.next()){var s,a=o.value,l=n.lookup(a);l?(l.setValue(r[a]),(s=l.items[0])&&s.executeCallbacks_()):this.settings[a]=r[a]}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}E.loading--,this.rerender(c.STATE.COMPILED)},E.prototype.checkComponent=function(e){e=E.loadingPromises.get(e);e&&o.mathjax.retryAfter(e)},E.prototype.loadComponent=function(e,t){var n;E.loadingPromises.has(e)||(n=y.loader)&&(E.loading++,n=n.load(e).then(function(){E.loading--,E.loadingPromises.delete(e),t(),0===E.loading&&E._loadingPromise&&(E._loadingPromise=null,E._loadingOK())}).catch(function(e){E._loadingPromise?(E._loadingPromise=null,E._loadingFailed(e)):console.log(e)}),E.loadingPromises.set(e,n))},E.prototype.loadA11y=function(n){var r=this,i=!c.STATE.ENRICHED;this.loadComponent("a11y/"+n,function(){var e=y.startup,t=(o.mathjax.handlers.unregister(e.handler),e.handler=e.getHandler(),o.mathjax.handlers.register(e.handler),r.document);r.document=e.document=e.getDocument(),(r.document.menu=r).document.outputJax.reset(),r.transferMathList(t),r.document.processed=t.processed,E._loadingPromise||(r.document.outputJax.reset(),r.rerender("complexity"===n||i?c.STATE.COMPILED:c.STATE.TYPESET))})},E.prototype.transferMathList=function(e){var t,n,r=this.document.options.MathItem;try{for(var i=u(e.math),o=i.next();!o.done;o=i.next()){var s=o.value,a=new r;Object.assign(a,s),this.document.math.push(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},E.prototype.formatSource=function(e){return e.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},E.prototype.toMML=function(e){return this.MmlVisitor.visitTree(e.root,e,{texHints:this.settings.texHints,semantics:this.settings.semantics&&"MathML"!==e.inputJax.name})},E.prototype.zoom=function(e,t,n){e&&!this.isZoomEvent(e,t)||(this.menu.mathItem=n,e&&this.menu.post(e),this.zoomBox.post())},E.prototype.isZoomEvent=function(e,t){return this.settings.zoom===t&&(!this.settings.alt||e.altKey)&&(!this.settings.ctrl||e.ctrlKey)&&(!this.settings.cmd||e.metaKey)&&(!this.settings.shift||e.shiftKey)},E.prototype.rerender=function(e){void 0===e&&(e=c.STATE.TYPESET),this.rerenderStart=Math.min(e,this.rerenderStart),E.loading||(this.rerenderStart<=c.STATE.COMPILED&&this.document.reset({inputJax:[]}),this.document.rerender(this.rerenderStart),this.rerenderStart=c.STATE.LAST)},E.prototype.copyMathML=function(){this.copyToClipboard(this.toMML(this.menu.mathItem))},E.prototype.copyOriginal=function(){this.copyToClipboard(this.menu.mathItem.math.trim())},E.prototype.copyAnnotation=function(){this.copyToClipboard(this.menu.annotation.trim())},E.prototype.copyToClipboard=function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.cssText="height: 1px; width: 1px; padding: 1px; position: absolute; left: -10px",document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){alert("Can't copy to clipboard: "+e.message)}document.body.removeChild(t)},E.prototype.addMenu=function(t){var n=this,e=t.typesetRoot;e.addEventListener("contextmenu",function(){return n.menu.mathItem=t},!0),e.addEventListener("keydown",function(){return n.menu.mathItem=t},!0),e.addEventListener("click",function(e){return n.zoom(e,"Click",t)},!0),e.addEventListener("dblclick",function(e){return n.zoom(e,"DoubleClick",t)},!0),this.menu.store.insert(e)},E.prototype.clear=function(){this.menu.store.clear()},E.prototype.variable=function(t,n){var r=this;return{name:t,getter:function(){return r.settings[t]},setter:function(e){r.settings[t]=e,n&&n(e),r.saveUserSettings()}}},E.prototype.a11yVar=function(n,r){var i=this;return{name:n,getter:function(){return i.getA11y(n)},setter:function(e){i.settings[n]=e;var t={};t[n]=e,i.setA11y(t),r&&r(e),i.saveUserSettings()}}},E.prototype.submenu=function(e,t,n,r){void 0===n&&(n=[]),void 0===r&&(r=!1);var i,o,s=[];try{for(var a=u(n),l=a.next();!l.done;l=a.next()){var c=l.value;Array.isArray(c)?s=s.concat(c):s.push(c)}}catch(e){i={error:e}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}return{type:"submenu",id:e,content:t,menu:{items:s},disabled:0===s.length||r}},E.prototype.command=function(e,t,n,r){return void 0===r&&(r={}),Object.assign({type:"command",id:e,content:t,action:n},r)},E.prototype.checkbox=function(e,t,n,r){return void 0===r&&(r={}),Object.assign({type:"checkbox",id:e,content:t,variable:n},r)},E.prototype.radioGroup=function(t,e){var n=this;return e.map(function(e){return n.radio(e[0],e[1]||e[0],t)})},E.prototype.radio=function(e,t,n,r){return void 0===r&&(r={}),Object.assign({type:"radio",id:e,content:t,variable:n},r)},E.prototype.label=function(e,t){return{type:"label",id:e,content:t}},E.prototype.rule=function(){return{type:"rule"}},E.MENU_STORAGE="MathJax-Menu-Settings",E.OPTIONS={settings:{texHints:!0,semantics:!1,zoom:"NoZoom",zscale:"200%",renderer:"CHTML",alt:!1,cmd:!1,ctrl:!1,shift:!1,scale:1,autocollapse:!1,collapsible:!1,inTabOrder:!0,assistiveMml:!0,explorer:!1},jax:{CHTML:null,SVG:null},annotationTypes:(0,a.expandable)({TeX:["TeX","LaTeX","application/x-tex"],StarMath:["StarMath 5.0"],Maple:["Maple"],ContentMathML:["MathML-Content","application/mathml-content+xml"],OpenMath:["OpenMath"]})},E.loading=0,E.loadingPromises=new Map,E._loadingPromise=null,E._loadingOK=null,E._loadingFailed=null,t.Menu=E},9003:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=(Object.defineProperty(t,"__esModule",{value:!0}),t.MenuHandler=t.MenuMathDocumentMixin=t.MenuMathItemMixin=void 0,n(3184)),d=n(4769),p=n(9077),h=n(1062);function f(e){return o(t,n=e),t.prototype.addMenu=function(e,t){void 0===t&&(t=!1),this.state()>=d.STATE.CONTEXT_MENU||(this.isEscaped||!e.options.enableMenu&&!t||e.menu.addMenu(this),this.state(d.STATE.CONTEXT_MENU))},t.prototype.checkLoading=function(e){e.checkLoading()},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}function i(e){var t,i;return o(n,i=e),n.prototype.addMenu=function(){var e,t;if(!this.processed.isSet("context-menu")){try{for(var n=c(this.math),r=n.next();!r.done;r=n.next())r.value.addMenu(this)}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.processed.set("context-menu")}return this},n.prototype.checkLoading=function(){this.menu.isLoading&&u.mathjax.retryAfter(this.menu.loadingPromise.catch(function(e){return console.log(e)}));var e=this.menu.settings;return e.collapsible&&(this.options.enableComplexity=!0,this.menu.checkComponent("a11y/complexity")),e.explorer&&(this.options.enableEnrichment=!0,this.options.enableExplorer=!0,this.menu.checkComponent("a11y/explorer")),this},n.prototype.state=function(e,t){return i.prototype.state.call(this,e,t=void 0===t?!1:t),e<d.STATE.CONTEXT_MENU&&this.processed.clear("context-menu"),this},n.prototype.updateDocument=function(){return i.prototype.updateDocument.call(this),this.menu.menu.store.sort(),this},(t=n).OPTIONS=s(s({enableEnrichment:!0,enableComplexity:!0,enableExplorer:!0,enrichSpeech:"none",enrichError:function(e,t,n){return console.warn("Enrichment Error:",n)}},e.OPTIONS),{MenuClass:h.Menu,menuOptions:h.Menu.OPTIONS,enableMenu:!0,sre:e.OPTIONS.sre||(0,p.expandable)({}),a11y:e.OPTIONS.a11y||(0,p.expandable)({}),renderActions:(0,p.expandable)(s(s({},e.OPTIONS.renderActions),{addMenu:[d.STATE.CONTEXT_MENU],checkLoading:[d.STATE.UNPROCESSED+1]}))}),t;function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.apply(this,l([],a(e),!1))||this,r=(n.menu=new n.options.MenuClass(n,n.options.menuOptions),n.constructor.ProcessBits);return r.has("context-menu")||r.allocate("context-menu"),n.options.MathItem=f(n.options.MathItem),n}}(0,d.newState)("CONTEXT_MENU",170),t.MenuMathItemMixin=f,t.MenuMathDocumentMixin=i,t.MenuHandler=function(e){return e.documentClass=i(e.documentClass),e}},9232:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.MmlVisitor=void 0,n(2433)),a=n(9077),n=(i=s.SerializedMmlVisitor,o(l,i),l.prototype.visitTree=function(e,t,n){return void 0===n&&(n={}),this.mathItem=t=void 0===t?null:t,(0,a.userOptions)(this.options,n),this.visitNode(e,"")},l.prototype.visitTeXAtomNode=function(e,t){return this.options.texHints?i.prototype.visitTeXAtomNode.call(this,e,t):e.childNodes[0]&&1===e.childNodes[0].childNodes.length?this.visitNode(e.childNodes[0],t):t+"<mrow"+this.getAttributes(e)+">\n"+this.childNodeMml(e,t+"  ","\n")+t+"</mrow>"},l.prototype.visitMathNode=function(e,t){if(!this.options.semantics||"TeX"!==this.mathItem.inputJax.name)return i.prototype.visitDefault.call(this,e,t);var n=e.childNodes.length&&1<e.childNodes[0].childNodes.length;return t+"<math"+this.getAttributes(e)+">\n"+t+"  <semantics>\n"+(n?t+"    <mrow>\n":"")+this.childNodeMml(e,t+(n?"      ":"    "),"\n")+(n?t+"    </mrow>\n":"")+t+'    <annotation encoding="application/x-tex">'+this.mathItem.math+"</annotation>\n"+t+"  </semantics>\n"+t+"</math>"},l);function l(){var e=null!==i&&i.apply(this,arguments)||this;return e.options={texHints:!0,semantics:!1},e.mathItem=null,e}t.MmlVisitor=n},7309:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.SelectableInfo=void 0,n(6932)),a=n(1698),n=(i=s.Info,o(l,i),l.prototype.addEvents=function(e){var t=this;e.addEventListener("keypress",function(e){"a"===e.key&&(e.ctrlKey||e.metaKey)&&(t.selectAll(),t.stop(e))})},l.prototype.selectAll=function(){document.getSelection().selectAllChildren(this.html.querySelector("pre"))},l.prototype.copyToClipboard=function(){this.selectAll();try{document.execCommand("copy")}catch(e){alert("Can't copy to clipboard: "+e.message)}document.getSelection().removeAllRanges()},l.prototype.generateHtml=function(){var t=this,e=(i.prototype.generateHtml.call(this),this.html.querySelector("span."+a.HtmlClasses.INFOSIGNATURE).appendChild(document.createElement("input")));e.type="button",e.value="Copy to Clipboard",e.addEventListener("click",function(e){return t.copyToClipboard()})},l);function l(){return null!==i&&i.apply(this,arguments)||this}t.SelectableInfo=n},8723:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=MathJax._.components.global.isObject,t.combineConfig=MathJax._.components.global.combineConfig,t.combineDefaults=MathJax._.components.global.combineDefaults,t.combineWithMathJax=MathJax._.components.global.combineWithMathJax,t.MathJax=MathJax._.components.global.MathJax},4769:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.protoItem=MathJax._.core.MathItem.protoItem,t.AbstractMathItem=MathJax._.core.MathItem.AbstractMathItem,t.STATE=MathJax._.core.MathItem.STATE,t.newState=MathJax._.core.MathItem.newState},2433:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DATAMJX=MathJax._.core.MmlTree.SerializedMmlVisitor.DATAMJX,t.toEntity=MathJax._.core.MmlTree.SerializedMmlVisitor.toEntity,t.SerializedMmlVisitor=MathJax._.core.MmlTree.SerializedMmlVisitor.SerializedMmlVisitor},3184:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mathjax=MathJax._.mathjax.mathjax},9077:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=MathJax._.util.Options.isObject,t.APPEND=MathJax._.util.Options.APPEND,t.REMOVE=MathJax._.util.Options.REMOVE,t.OPTIONS=MathJax._.util.Options.OPTIONS,t.Expandable=MathJax._.util.Options.Expandable,t.expandable=MathJax._.util.Options.expandable,t.makeArray=MathJax._.util.Options.makeArray,t.keys=MathJax._.util.Options.keys,t.copy=MathJax._.util.Options.copy,t.insert=MathJax._.util.Options.insert,t.defaultOptions=MathJax._.util.Options.defaultOptions,t.userOptions=MathJax._.util.Options.userOptions,t.selectOptions=MathJax._.util.Options.selectOptions,t.selectOptionsFromKeys=MathJax._.util.Options.selectOptionsFromKeys,t.separateOptions=MathJax._.util.Options.separateOptions,t.lookup=MathJax._.util.Options.lookup},2612:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractEntry=void 0,n(9943)),a=n(1698),n=(i=s.MenuElement,o(l,i),Object.defineProperty(l.prototype,"menu",{get:function(){return this._menu},set:function(e){this._menu=e},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),l.prototype.hide=function(){this.hidden=!0,this.menu.generateMenu()},l.prototype.show=function(){this.hidden=!1,this.menu.generateMenu()},l.prototype.isHidden=function(){return this.hidden},l);function l(e,t){var n=i.call(this)||this;return n._menu=e,n._type=t,n.className=a.HtmlClasses.MENUITEM,n.role="menuitem",n.hidden=!1,n}t.AbstractEntry=n},1341:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=(Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractItem=void 0,n(2612)),l=n(865),c=n(1698),n=(i=a.AbstractEntry,o(u,i),Object.defineProperty(u.prototype,"content",{get:function(){return this._content},set:function(e){this._content=e,this.generateHtml(),this.menu&&this.menu.generateHtml()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),u.prototype.press=function(){this.disabled||(this.executeAction(),this.executeCallbacks_())},u.prototype.executeAction=function(){},u.prototype.registerCallback=function(e){-1===this.callbacks.indexOf(e)&&this.callbacks.push(e)},u.prototype.unregisterCallback=function(e){e=this.callbacks.indexOf(e);-1!==e&&this.callbacks.splice(e,1)},u.prototype.mousedown=function(e){this.press(),this.stop(e)},u.prototype.mouseover=function(e){this.focus(),this.stop(e)},u.prototype.mouseout=function(e){this.deactivate(),this.stop(e)},u.prototype.generateHtml=function(){i.prototype.generateHtml.call(this);var e=this.html;e.setAttribute("aria-disabled","false"),e.textContent=this.content},u.prototype.activate=function(){this.disabled||this.html.classList.add(c.HtmlClasses.MENUACTIVE)},u.prototype.deactivate=function(){this.html.classList.remove(c.HtmlClasses.MENUACTIVE)},u.prototype.focus=function(){this.menu.focused=this,i.prototype.focus.call(this),this.activate()},u.prototype.unfocus=function(){this.deactivate(),i.prototype.unfocus.call(this)},u.prototype.escape=function(e){l.MenuUtil.close(this)},u.prototype.up=function(e){this.menu.up(e)},u.prototype.down=function(e){this.menu.down(e)},u.prototype.left=function(e){this.menu.left(e)},u.prototype.right=function(e){this.menu.right(e)},u.prototype.space=function(e){this.press()},u.prototype.disable=function(){this.disabled=!0;var e=this.html;e.classList.add(c.HtmlClasses.MENUDISABLED),e.setAttribute("aria-disabled","true")},u.prototype.enable=function(){this.disabled=!1;var e=this.html;e.classList.remove(c.HtmlClasses.MENUDISABLED),e.removeAttribute("aria-disabled")},u.prototype.executeCallbacks_=function(){var e,t;try{for(var n=s(this.callbacks),r=n.next();!r.done;r=n.next()){var i=r.value;try{i(this)}catch(e){l.MenuUtil.error(e,"Callback for menu entry "+this.id+" failed.")}}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},u);function u(e,t,n,r){e=i.call(this,e,t)||this;return e._content=n,e.disabled=!1,e.callbacks=[],e._id=r||n,e}t.AbstractItem=n},1585:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMenu=void 0,n(3757)),l=n(1341),c=n(1698),u=n(2745),n=(i=s.AbstractPostable,o(d,i),Object.defineProperty(d.prototype,"baseMenu",{get:function(){return this._baseMenu},set:function(e){this._baseMenu=e},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"items",{get:function(){return this._items},set:function(e){this._items=e},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"pool",{get:function(){return this.variablePool},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"focused",{get:function(){return this._focused},set:function(e){var t;this._focused!==e&&(this._focused||this.unfocus(),t=this._focused,this._focused=e,t&&t.unfocus())},enumerable:!1,configurable:!0}),d.prototype.up=function(e){var t,n=this.items.filter(function(e){return e instanceof l.AbstractItem&&!e.isHidden()});0!==n.length&&(this.focused?-1!==(t=n.indexOf(this.focused))&&n[t=t?--t:n.length-1].focus():n[n.length-1].focus())},d.prototype.down=function(e){var t,n=this.items.filter(function(e){return e instanceof l.AbstractItem&&!e.isHidden()});0!==n.length&&(this.focused?-1!==(t=n.indexOf(this.focused))&&n[t=++t===n.length?0:t].focus():n[0].focus())},d.prototype.generateHtml=function(){i.prototype.generateHtml.call(this),this.generateMenu()},d.prototype.generateMenu=function(){var e,t,n=this.html;n.classList.add(c.HtmlClasses.MENU);try{for(var r=a(this.items),i=r.next();!i.done;i=r.next()){var o,s=i.value;s.isHidden()?(o=s.html).parentNode&&o.parentNode.removeChild(o):n.appendChild(s.html)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},d.prototype.post=function(e,t){this.variablePool.update(),i.prototype.post.call(this,e,t)},d.prototype.unpostSubmenus=function(){var e,t,n=this.items.filter(function(e){return e instanceof u.Submenu});try{for(var r=a(n),i=r.next();!i.done;i=r.next()){var o=i.value;o.submenu.unpost(),o!==this.focused&&o.unfocus()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},d.prototype.unpost=function(){i.prototype.unpost.call(this),this.unpostSubmenus(),this.focused=null},d.prototype.find=function(e){var t,n;try{for(var r=a(this.items),i=r.next();!i.done;i=r.next()){var o=i.value;if("rule"!==o.type){if(o.id===e)return o;if("submenu"===o.type){var s=o.submenu.find(e);if(s)return s}}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null},d);function d(){var e=null!==i&&i.apply(this,arguments)||this;return e.className=c.HtmlClasses.CONTEXTMENU,e.role="menu",e._items=[],e._baseMenu=null,e}t.AbstractMenu=n},2817:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractNavigatable=void 0;var r=n(2635),i=n(9674);function o(){this.bubble=!1}o.prototype.bubbleKey=function(){this.bubble=!0},o.prototype.keydown=function(e){switch(e.keyCode){case r.KEY.ESCAPE:this.escape(e);break;case r.KEY.RIGHT:this.right(e);break;case r.KEY.LEFT:this.left(e);break;case r.KEY.UP:this.up(e);break;case r.KEY.DOWN:this.down(e);break;case r.KEY.RETURN:case r.KEY.SPACE:this.space(e);break;default:return}this.bubble?this.bubble=!1:this.stop(e)},o.prototype.escape=function(e){},o.prototype.space=function(e){},o.prototype.left=function(e){},o.prototype.right=function(e){},o.prototype.up=function(e){},o.prototype.down=function(e){},o.prototype.stop=function(e){e&&(e.stopPropagation(),e.preventDefault(),e.cancelBubble=!0)},o.prototype.mousedown=function(e){return this.stop(e)},o.prototype.mouseup=function(e){return this.stop(e)},o.prototype.mouseover=function(e){return this.stop(e)},o.prototype.mouseout=function(e){return this.stop(e)},o.prototype.click=function(e){return this.stop(e)},o.prototype.addEvents=function(e){e.addEventListener(i.MOUSE.DOWN,this.mousedown.bind(this)),e.addEventListener(i.MOUSE.UP,this.mouseup.bind(this)),e.addEventListener(i.MOUSE.OVER,this.mouseover.bind(this)),e.addEventListener(i.MOUSE.OUT,this.mouseout.bind(this)),e.addEventListener(i.MOUSE.CLICK,this.click.bind(this)),e.addEventListener("keydown",this.keydown.bind(this)),e.addEventListener("dragstart",this.stop.bind(this)),e.addEventListener(i.MOUSE.SELECTSTART,this.stop.bind(this)),e.addEventListener("contextmenu",this.stop.bind(this)),e.addEventListener(i.MOUSE.DBLCLICK,this.stop.bind(this))},t.AbstractNavigatable=o},3757:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=(Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractPostable=void 0,i=n(9943).MenuElement,o(s,i),s.prototype.isPosted=function(){return this.posted},s.prototype.post=function(e,t){this.posted||(void 0!==e&&void 0!==t&&this.html.setAttribute("style","left: "+e+"px; top: "+t+"px;"),this.display(),this.posted=!0)},s.prototype.unpost=function(){var e;this.posted&&((e=this.html).parentNode&&e.parentNode.removeChild(e),this.posted=!1)},s);function s(){var e=null!==i&&i.apply(this,arguments)||this;return e.posted=!1,e}t.AbstractPostable=n},2467:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=(Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractVariableItem=void 0,i=n(1341).AbstractItem,o(s,i),s.prototype.generateHtml=function(){i.prototype.generateHtml.call(this);var e=this.html;this.span||this.generateSpan(),e.appendChild(this.span),this.update()},s.prototype.register=function(){this.variable.register(this)},s.prototype.unregister=function(){this.variable.unregister(this)},s.prototype.update=function(){this.updateAria(),this.span&&this.updateSpan()},s);function s(){return null!==i&&i.apply(this,arguments)||this}t.AbstractVariableItem=n},725:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.CloseButton=void 0,n(3757)),a=n(1698),n=(i=s.AbstractPostable,o(l,i),l.prototype.generateHtml=function(){var e=document.createElement("span"),t=(e.classList.add(this.className),e.setAttribute("role",this.role),e.setAttribute("tabindex","0"),document.createElement("span"));t.textContent="×",e.appendChild(t),this.html=e},l.prototype.display=function(){},l.prototype.unpost=function(){i.prototype.unpost.call(this),this.element.unpost()},l.prototype.keydown=function(e){this.bubbleKey(),i.prototype.keydown.call(this,e)},l.prototype.space=function(e){this.unpost(),this.stop(e)},l.prototype.mousedown=function(e){this.unpost(),this.stop(e)},l);function l(e){var t=i.call(this)||this;return t.element=e,t.className=a.HtmlClasses.MENUCLOSE,t.role="button",t}t.CloseButton=n},9964:function(e,t,n){var r,s,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=(Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenu=void 0,n(1585)),a=n(1698),l=n(8525),c=n(6964),n=(s=o.AbstractMenu,i(u,s),u.fromJson=function(t,e){var n=e.pool,r=e.items,e=e.id,e=void 0===e?"":e,i=new this(t),o=(i.id=e,t.get("variable")),e=(n.forEach(function(e){return o(t,e,i.pool)}),t.get("items")(t,r,i));return i.items=e,i},u.prototype.generateHtml=function(){this.isPosted()&&this.unpost(),s.prototype.generateHtml.call(this),this._frame=document.createElement("div"),this._frame.classList.add(a.HtmlClasses.MENUFRAME);var e="left: 0px; top: 0px; z-index: 200; width: 100%; height: 100%; border: 0px; padding: 0px; margin: 0px;",t=(this._frame.setAttribute("style","position: absolute; "+e),document.createElement("div"));t.setAttribute("style","position: fixed; "+e),this._frame.appendChild(t),t.addEventListener("mousedown",function(e){this.unpost(),this.unpostWidgets(),this.stop(e)}.bind(this))},u.prototype.display=function(){document.body.appendChild(this.frame),this.frame.appendChild(this.html),this.focus()},u.prototype.escape=function(e){this.unpost(),this.unpostWidgets()},u.prototype.unpost=function(){var e;s.prototype.unpost.call(this),0<this.widgets.length||(this.frame.parentNode.removeChild(this.frame),e=this.store,this.moving||e.insertTaborder(),e.active.focus())},u.prototype.left=function(e){this.move_(this.store.previous())},u.prototype.right=function(e){this.move_(this.store.next())},Object.defineProperty(u.prototype,"frame",{get:function(){return this._frame},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),u.prototype.post=function(e,t){if(void 0!==t)return this.moving||this.store.removeTaborder(),void s.prototype.post.call(this,e,t);var n,r,i,o,t=e,e=(t instanceof Event?(n=t.target,this.stop(t)):n=t,t instanceof MouseEvent&&(i=t.pageX,o=t.pageY,i||o||!t.clientX||(i=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=t.clientY+document.body.scrollTop+document.documentElement.scrollTop)),i||o||!n||(e=window.pageXOffset||document.documentElement.scrollLeft,t=window.pageYOffset||document.documentElement.scrollTop,i=((r=n.getBoundingClientRect()).right+r.left)/2+e,o=(r.bottom+r.top)/2+t),this.store.active=n,this.anchor=this.store.active,this.html);i+e.offsetWidth>document.body.offsetWidth-5&&(i=document.body.offsetWidth-e.offsetWidth-5),this.post(i,o)},u.prototype.registerWidget=function(e){this.widgets.push(e)},u.prototype.unregisterWidget=function(e){e=this.widgets.indexOf(e);-1<e&&this.widgets.splice(e,1),0===this.widgets.length&&this.unpost()},u.prototype.unpostWidgets=function(){this.widgets.forEach(function(e){return e.unpost()})},u.prototype.toJson=function(){return{type:""}},u.prototype.move_=function(e){this.anchor&&e!==this.anchor&&(this.moving=!0,this.unpost(),this.post(e),this.moving=!1)},u);function u(e){var t=s.call(this)||this;return t.factory=e,t.id="",t.moving=!1,t._store=new l.MenuStore(t),t.widgets=[],t.variablePool=new c.VariablePool,t}t.ContextMenu=n},6837:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CssStyles=void 0;var r,i,o,s,a,l,c=n(1698);function u(e){return"."+(c.HtmlClasses[e]||e)}function d(e){l||(p(o,e),l=!0)}function p(e,t){var n,t=t||document,r=t.createElement("style"),i=(r.type="text/css","");for(n in e)i+=n,i+=" ",i+=e[n],i+="\n";r.innerHTML=i,t.head.appendChild(r)}n=t.CssStyles||(t.CssStyles={}),(r={})[u("INFOCLOSE")]="{  top:.2em; right:.2em;}",r[u("INFOCONTENT")]="{  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}",r[u("INFO")+u("MOUSEPOST")]="{outline:none;}",r[u("INFO")]='{  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}',(i={})[u("MENU")]="{  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}",i[u("MENUITEM")]="{  padding: 1px 2em;  background:transparent;}",i[u("MENUARROW")]="{  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}",i[u("MENUACTIVE")+" "+u("MENUARROW")]="{color:white}",i[u("MENUARROW")+u("RTL")]="{left:.5em; right:auto}",i[u("MENUCHECK")]="{  position:absolute; left:.7em;  font-family: null}",i[u("MENUCHECK")+u("RTL")]="{ right:.7em; left:auto }",i[u("MENURADIOCHECK")]="{  position:absolute; left: .7em;}",i[u("MENURADIOCHECK")+u("RTL")]="{  right: .7em; left:auto}",i[u("MENUINPUTBOX")]="{  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}",i[u("MENUINPUTBOX")+u("RTL")]="{  left: .1em;}",i[u("MENUCOMBOBOX")]="{  left:.1em; padding-bottom:.5em;}",i[u("MENUSLIDER")]="{  left: .1em;}",i[u("SLIDERVALUE")]="{  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}",i[u("SLIDERBAR")]="{  outline: none; background: #d3d3d3}",i[u("MENULABEL")]="{  padding: 1px 2em 3px 1.33em;  font-style:italic}",i[u("MENURULE")]="{  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}",i[u("MENUDISABLED")]="{  color:GrayText}",i[u("MENUACTIVE")]="{  background-color: #606872;  color: white;}",i[u("MENUDISABLED")+":focus"]="{  background-color: #E8E8E8}",i[u("MENULABEL")+":focus"]="{  background-color: #E8E8E8}",i[u("CONTEXTMENU")+":focus"]="{  outline:none}",i[u("CONTEXTMENU")+" "+u("MENUITEM")+":focus"]="{  outline:none}",i[u("SELECTIONMENU")]="{  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }",i[u("SELECTIONITEM")]="{  padding-right: 1em;}",i[u("SELECTION")]="{  right: 40%; width:50%; }",i[u("SELECTIONBOX")]="{  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}",i[u("SELECTIONDIVIDER")]="{  clear: both; border-top: 2px solid #000000;}",i[u("MENU")+" "+u("MENUCLOSE")]="{  top:-10px; left:-10px}",(o={})[u("MENUCLOSE")]='{  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}',o[u("MENUCLOSE")+" span"]="{  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}",o[u("MENUCLOSE")+":hover"]="{  color:white!important;  border:2px solid #CCC!important}",o[u("MENUCLOSE")+":hover span"]="{  background-color:#CCC!important}",s=!(o[u("MENUCLOSE")+":hover:focus"]="{  outline:none}"),l=a=!1,n.addMenuStyles=function(e){a||(p(i,e),a=!0,d(e))},n.addInfoStyles=function(e){s||(p(r,e),s=!0,d(e))}},1698:function(e,t){function n(e){return"CtxtMenu_"+e}Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlAttrs=t.HtmlClasses=void 0,t.HtmlClasses={ATTACHED:n("Attached"),CONTEXTMENU:n("ContextMenu"),MENU:n("Menu"),MENUARROW:n("MenuArrow"),MENUACTIVE:n("MenuActive"),MENUCHECK:n("MenuCheck"),MENUCLOSE:n("MenuClose"),MENUCOMBOBOX:n("MenuComboBox"),MENUDISABLED:n("MenuDisabled"),MENUFRAME:n("MenuFrame"),MENUITEM:n("MenuItem"),MENULABEL:n("MenuLabel"),MENURADIOCHECK:n("MenuRadioCheck"),MENUINPUTBOX:n("MenuInputBox"),MENURULE:n("MenuRule"),MENUSLIDER:n("MenuSlider"),MOUSEPOST:n("MousePost"),RTL:n("RTL"),INFO:n("Info"),INFOCLOSE:n("InfoClose"),INFOCONTENT:n("InfoContent"),INFOSIGNATURE:n("InfoSignature"),INFOTITLE:n("InfoTitle"),SLIDERVALUE:n("SliderValue"),SLIDERBAR:n("SliderBar"),SELECTION:n("Selection"),SELECTIONBOX:n("SelectionBox"),SELECTIONMENU:n("SelectionMenu"),SELECTIONDIVIDER:n("SelectionDivider"),SELECTIONITEM:n("SelectionItem")},t.HtmlAttrs={COUNTER:n("Counter"),KEYDOWNFUNC:n("keydownFunc"),CONTEXTMENUFUNC:n("contextmenuFunc"),OLDTAB:n("Oldtabindex"),TOUCHFUNC:n("TouchFunc")}},6932:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Info=void 0,n(725)),a=n(1698),n=(i=n(3757).AbstractPostable,o(l,i),l.prototype.attachMenu=function(e){this.menu=e},l.prototype.generateHtml=function(){i.prototype.generateHtml.call(this);var e=this.html;e.appendChild(this.generateTitle()),e.appendChild(this.contentDiv),e.appendChild(this.generateSignature()),e.appendChild(this.close.html),e.setAttribute("tabindex","0")},l.prototype.post=function(){i.prototype.post.call(this);var e=document.documentElement,t=this.html,e=window.innerHeight||e.clientHeight||e.scrollHeight||0,n=Math.floor(-t.offsetWidth/2),e=Math.floor((e-t.offsetHeight)/3);t.setAttribute("style","margin-left: "+n+"px; top: "+e+"px;"),window.event instanceof MouseEvent&&t.classList.add(a.HtmlClasses.MOUSEPOST),t.focus()},l.prototype.display=function(){this.menu.registerWidget(this),this.contentDiv.innerHTML=this.content();var e=this.menu.html;e.parentNode&&e.parentNode.removeChild(e),this.menu.frame.appendChild(this.html)},l.prototype.click=function(e){},l.prototype.keydown=function(e){this.bubbleKey(),i.prototype.keydown.call(this,e)},l.prototype.escape=function(e){this.unpost()},l.prototype.unpost=function(){i.prototype.unpost.call(this),this.html.classList.remove(a.HtmlClasses.MOUSEPOST),this.menu.unregisterWidget(this)},l.prototype.generateClose=function(){var e=new s.CloseButton(this),t=e.html;return t.classList.add(a.HtmlClasses.INFOCLOSE),t.setAttribute("aria-label","Close Dialog Box"),e},l.prototype.generateTitle=function(){var e=document.createElement("span");return e.innerHTML=this.title,e.classList.add(a.HtmlClasses.INFOTITLE),e},l.prototype.generateContent=function(){var e=document.createElement("div");return e.classList.add(a.HtmlClasses.INFOCONTENT),e.setAttribute("tabindex","0"),e},l.prototype.generateSignature=function(){var e=document.createElement("span");return e.innerHTML=this.signature,e.classList.add(a.HtmlClasses.INFOSIGNATURE),e},l.prototype.toJson=function(){return{type:""}},l);function l(e,t,n){var r=i.call(this)||this;return r.title=e,r.signature=n,r.className=a.HtmlClasses.INFO,r.role="dialog",r.contentDiv=r.generateContent(),r.close=r.generateClose(),r.content=t||function(){return""},r}t.Info=n},3177:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Checkbox=void 0,n(2467)),a=n(865),l=n(1698),n=(i=s.AbstractVariableItem,o(c,i),c.fromJson=function(e,t,n){return new this(n,t.content,t.variable,t.id)},c.prototype.executeAction=function(){this.variable.setValue(!this.variable.getValue()),a.MenuUtil.close(this)},c.prototype.generateSpan=function(){this.span=document.createElement("span"),this.span.textContent="✓",this.span.classList.add(l.HtmlClasses.MENUCHECK)},c.prototype.updateAria=function(){this.html.setAttribute("aria-checked",this.variable.getValue()?"true":"false")},c.prototype.updateSpan=function(){this.span.style.display=this.variable.getValue()?"":"none"},c.prototype.toJson=function(){return{type:""}},c);function c(e,t,n,r){t=i.call(this,e,"checkbox",t,r)||this;return t.role="menuitemcheckbox",t.variable=e.pool.lookup(n),t.register(),t}t.Checkbox=n},7253:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Combo=void 0,n(2467)),a=n(865),l=n(1698),c=n(2635),n=(i=s.AbstractVariableItem,o(u,i),u.fromJson=function(e,t,n){return new this(n,t.content,t.variable,t.id)},u.prototype.executeAction=function(){this.variable.setValue(this.input.value,a.MenuUtil.getActiveElement(this))},u.prototype.space=function(e){i.prototype.space.call(this,e),a.MenuUtil.close(this)},u.prototype.focus=function(){i.prototype.focus.call(this),this.input.focus()},u.prototype.unfocus=function(){i.prototype.unfocus.call(this),this.updateSpan()},u.prototype.generateHtml=function(){i.prototype.generateHtml.call(this),this.html.classList.add(l.HtmlClasses.MENUCOMBOBOX)},u.prototype.generateSpan=function(){this.span=document.createElement("span"),this.span.classList.add(l.HtmlClasses.MENUINPUTBOX),this.input=document.createElement("input"),this.input.addEventListener("keydown",this.inputKey.bind(this)),this.input.setAttribute("size","10em"),this.input.setAttribute("type","text"),this.input.setAttribute("tabindex","-1"),this.span.appendChild(this.input)},u.prototype.inputKey=function(e){this.bubbleKey(),this.inputEvent=!0},u.prototype.keydown=function(e){if(this.inputEvent&&e.keyCode!==c.KEY.ESCAPE&&e.keyCode!==c.KEY.RETURN)return this.inputEvent=!1,void e.stopPropagation();i.prototype.keydown.call(this,e),e.stopPropagation()},u.prototype.updateAria=function(){},u.prototype.updateSpan=function(){var t;try{t=this.variable.getValue(a.MenuUtil.getActiveElement(this))}catch(e){t=""}this.input.value=t},u.prototype.toJson=function(){return{type:""}},u);function u(e,t,n,r){t=i.call(this,e,"combobox",t,r)||this;return t.role="combobox",t.inputEvent=!1,t.variable=e.pool.lookup(n),t.register(),t}t.Combo=n},9665:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Command=void 0,n(1341)),a=n(865),n=(i=s.AbstractItem,o(l,i),l.fromJson=function(e,t,n){return new this(n,t.content,t.action,t.id)},l.prototype.executeAction=function(){try{this.command(a.MenuUtil.getActiveElement(this))}catch(e){a.MenuUtil.error(e,"Illegal command callback.")}a.MenuUtil.close(this)},l.prototype.toJson=function(){return{type:""}},l);function l(e,t,n,r){e=i.call(this,e,"command",t,r)||this;return e.command=n,e}t.Command=n},1817:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Label=void 0,n(1341)),a=n(1698),n=(i=s.AbstractItem,o(l,i),l.fromJson=function(e,t,n){return new this(n,t.content,t.id)},l.prototype.generateHtml=function(){i.prototype.generateHtml.call(this),this.html.classList.add(a.HtmlClasses.MENULABEL)},l.prototype.toJson=function(){return{type:""}},l);function l(e,t,n){return i.call(this,e,"label",t,n)||this}t.Label=n},3348:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Radio=void 0,n(2467)),a=n(865),l=n(1698),n=(i=s.AbstractVariableItem,o(c,i),c.fromJson=function(e,t,n){return new this(n,t.content,t.variable,t.id)},c.prototype.executeAction=function(){this.variable.setValue(this.id),a.MenuUtil.close(this)},c.prototype.generateSpan=function(){this.span=document.createElement("span"),this.span.textContent="✓",this.span.classList.add(l.HtmlClasses.MENURADIOCHECK)},c.prototype.updateAria=function(){this.html.setAttribute("aria-checked",this.variable.getValue()===this.id?"true":"false")},c.prototype.updateSpan=function(){this.span.style.display=this.variable.getValue()===this.id?"":"none"},c.prototype.toJson=function(){return{type:""}},c);function c(e,t,n,r){t=i.call(this,e,"radio",t,r)||this;return t.role="menuitemradio",t.variable=e.pool.lookup(n),t.register(),t}t.Radio=n},1156:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Rule=void 0,n(2612)),a=n(1698),n=(i=s.AbstractEntry,o(l,i),l.fromJson=function(e,t,n){return new this(n)},l.prototype.generateHtml=function(){i.prototype.generateHtml.call(this);var e=this.html;e.classList.add(a.HtmlClasses.MENURULE),e.setAttribute("aria-orientation","vertical")},l.prototype.addEvents=function(e){},l.prototype.toJson=function(){return{type:"rule"}},l);function l(e){e=i.call(this,e,"rule")||this;return e.className=a.HtmlClasses.MENUITEM,e.role="separator",e}t.Rule=n},2129:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Slider=void 0,n(2467)),a=n(865),l=n(1698),c=n(2635),n=(i=s.AbstractVariableItem,o(u,i),u.fromJson=function(e,t,n){return new this(n,t.content,t.variable,t.id)},u.prototype.executeAction=function(){this.variable.setValue(this.input.value,a.MenuUtil.getActiveElement(this)),this.update()},u.prototype.space=function(e){i.prototype.space.call(this,e),a.MenuUtil.close(this)},u.prototype.focus=function(){i.prototype.focus.call(this),this.input.focus()},u.prototype.unfocus=function(){i.prototype.unfocus.call(this),this.updateSpan()},u.prototype.generateHtml=function(){i.prototype.generateHtml.call(this),this.html.classList.add(l.HtmlClasses.MENUSLIDER),this.valueSpan=document.createElement("span"),this.valueSpan.setAttribute("id",this.valueId),this.valueSpan.classList.add(l.HtmlClasses.SLIDERVALUE),this.html.appendChild(this.valueSpan)},u.prototype.generateSpan=function(){this.span=document.createElement("span"),this.labelSpan=document.createElement("span"),this.labelSpan.setAttribute("id",this.labelId),this.labelSpan.appendChild(this.html.childNodes[0]),this.html.appendChild(this.labelSpan),this.input=document.createElement("input"),this.input.setAttribute("type","range"),this.input.setAttribute("min","0"),this.input.setAttribute("max","100"),this.input.setAttribute("aria-valuemin","0"),this.input.setAttribute("aria-valuemax","100"),this.input.setAttribute("aria-labelledby",this.labelId),this.input.addEventListener("keydown",this.inputKey.bind(this)),this.input.addEventListener("input",this.executeAction.bind(this)),this.input.classList.add(l.HtmlClasses.SLIDERBAR),this.span.appendChild(this.input)},u.prototype.inputKey=function(e){this.inputEvent=!0},u.prototype.mousedown=function(e){e.stopPropagation()},u.prototype.mouseup=function(e){event.stopPropagation()},u.prototype.keydown=function(e){var t=e.keyCode;return t===c.KEY.UP||t===c.KEY.DOWN?(e.preventDefault(),void i.prototype.keydown.call(this,e)):(this.inputEvent&&t!==c.KEY.ESCAPE&&t!==c.KEY.RETURN?this.inputEvent=!1:i.prototype.keydown.call(this,e),void e.stopPropagation())},u.prototype.updateAria=function(){var e=this.variable.getValue();e&&this.input&&(this.input.setAttribute("aria-valuenow",e),this.input.setAttribute("aria-valuetext",e+"%"))},u.prototype.updateSpan=function(){var t;try{t=this.variable.getValue(a.MenuUtil.getActiveElement(this)),this.valueSpan.innerHTML=t+"%"}catch(e){t=""}this.input.value=t},u.prototype.toJson=function(){return{type:""}},u);function u(e,t,n,r){t=i.call(this,e,"slider",t,r)||this;return t.role="slider",t.labelId="ctx_slideLabel"+a.MenuUtil.counter(),t.valueId="ctx_slideValue"+a.MenuUtil.counter(),t.inputEvent=!1,t.variable=e.pool.lookup(n),t.register(),t}t.Slider=n},2745:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Submenu=void 0,n(1341)),a=n(1698),n=(i=s.AbstractItem,o(l,i),l.fromJson=function(e,t,n){var r=t.content,i=t.menu,n=new this(n,r,t.id),r=e.get("subMenu")(e,i,n);return n.submenu=r,n},Object.defineProperty(l.prototype,"submenu",{get:function(){return this._submenu},set:function(e){this._submenu=e},enumerable:!1,configurable:!0}),l.prototype.mouseover=function(e){this.focus(),this.stop(e)},l.prototype.mouseout=function(e){this.stop(e)},l.prototype.unfocus=function(){if(this.submenu.isPosted()){if(this.menu.focused!==this)return i.prototype.unfocus.call(this),void this.menu.unpostSubmenus();this.html.setAttribute("tabindex","-1"),this.html.blur()}else i.prototype.unfocus.call(this)},l.prototype.focus=function(){i.prototype.focus.call(this),this.submenu.isPosted()||this.disabled||this.submenu.post()},l.prototype.executeAction=function(){this.submenu.isPosted()?this.submenu.unpost():this.submenu.post()},l.prototype.generateHtml=function(){i.prototype.generateHtml.call(this);var e=this.html;this.span=document.createElement("span"),this.span.textContent="►",this.span.classList.add(a.HtmlClasses.MENUARROW),e.appendChild(this.span),e.setAttribute("aria-haspopup","true")},l.prototype.left=function(e){this.submenu.isPosted()?this.submenu.unpost():i.prototype.left.call(this,e)},l.prototype.right=function(e){this.submenu.isPosted()?this.submenu.down(e):this.submenu.post()},l.prototype.toJson=function(){return{type:""}},l);function l(e,t,n){e=i.call(this,e,"submenu",t,n)||this;return e._submenu=null,e}t.Submenu=n},2635:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.KEY=void 0,(t=t.KEY||(t.KEY={}))[t.RETURN=13]="RETURN",t[t.ESCAPE=27]="ESCAPE",t[t.SPACE=32]="SPACE",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN"},9943:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=(Object.defineProperty(t,"__esModule",{value:!0}),t.MenuElement=void 0,i=n(2817).AbstractNavigatable,o(s,i),s.prototype.addAttributes=function(e){for(var t in e)this.html.setAttribute(t,e[t])},Object.defineProperty(s.prototype,"html",{get:function(){return this._html||this.generateHtml(),this._html},set:function(e){this._html=e,this.addEvents(e)},enumerable:!1,configurable:!0}),s.prototype.generateHtml=function(){var e=document.createElement("div");e.classList.add(this.className),e.setAttribute("role",this.role),this.html=e},s.prototype.focus=function(){var e=this.html;e.setAttribute("tabindex","0"),e.focus()},s.prototype.unfocus=function(){var e=this.html;e.hasAttribute("tabindex")&&e.setAttribute("tabindex","-1");try{e.blur()}catch(e){}e.blur()},s);function s(){return null!==i&&i.apply(this,arguments)||this}t.MenuElement=n},8525:function(e,t,n){var a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=(Object.defineProperty(t,"__esModule",{value:!0}),t.MenuStore=void 0,n(865)),i=n(1698),o=n(2635),n=(Object.defineProperty(s.prototype,"active",{get:function(){return this._active},set:function(e){do{if(-1!==this.store.indexOf(e)){this._active=e;break}}while(e=e.parentNode)},enumerable:!1,configurable:!0}),s.prototype.next=function(){var e=this.store.length;if(0===e)return this.active=null;var t=-1!==(t=this.store.indexOf(this.active))&&t<e-1?t+1:0;return this.active=this.store[t],this.active},s.prototype.previous=function(){var e=this.store.length;if(0===e)return this.active=null;var e=e-1,t=-1===(t=this.store.indexOf(this.active))||0===t?e:t-1;return this.active=this.store[t],this.active},s.prototype.clear=function(){this.remove(this.store)},s.prototype.insert=function(e){var t,n,r=e instanceof HTMLElement?[e]:e;try{for(var i=a(r),o=i.next();!o.done;o=i.next()){var s=o.value;this.insertElement(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}this.sort()},s.prototype.remove=function(e){var t,n,r=e instanceof HTMLElement?[e]:e;try{for(var i=a(r),o=i.next();!o.done;o=i.next()){var s=o.value;this.removeElement(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}this.sort()},s.prototype.inTaborder=function(e){this.taborder&&!e&&this.removeTaborder(),!this.taborder&&e&&this.insertTaborder(),this.taborder=e},s.prototype.insertTaborder=function(){this.taborder&&this.insertTaborder_()},s.prototype.removeTaborder=function(){this.taborder&&this.removeTaborder_()},s.prototype.insertElement=function(e){e.classList.contains(this.attachedClass)||(e.classList.add(this.attachedClass),this.taborder&&this.addTabindex(e),this.addEvents(e))},s.prototype.removeElement=function(e){e.classList.contains(this.attachedClass)&&(e.classList.remove(this.attachedClass),this.taborder&&this.removeTabindex(e),this.removeEvents(e))},s.prototype.sort=function(){var e=document.getElementsByClassName(this.attachedClass);this.store=[].slice.call(e)},s.prototype.insertTaborder_=function(){this.store.forEach(function(e){return e.setAttribute("tabindex","0")})},s.prototype.removeTaborder_=function(){this.store.forEach(function(e){return e.setAttribute("tabindex","-1")})},s.prototype.addTabindex=function(e){e.hasAttribute("tabindex")&&e.setAttribute(i.HtmlAttrs.OLDTAB,e.getAttribute("tabindex")),e.setAttribute("tabindex","0")},s.prototype.removeTabindex=function(e){e.hasAttribute(i.HtmlAttrs.OLDTAB)?(e.setAttribute("tabindex",e.getAttribute(i.HtmlAttrs.OLDTAB)),e.removeAttribute(i.HtmlAttrs.OLDTAB)):e.removeAttribute("tabindex")},s.prototype.addEvents=function(e){e.hasAttribute(i.HtmlAttrs.COUNTER)||(this.addEvent(e,"contextmenu",this.menu.post.bind(this.menu)),this.addEvent(e,"keydown",this.keydown.bind(this)),e.setAttribute(i.HtmlAttrs.COUNTER,this.counter.toString()),this.counter++)},s.prototype.addEvent=function(e,t,n){var r=i.HtmlAttrs[t.toUpperCase()+"FUNC"];this.attrMap[r+this.counter]=n,e.addEventListener(t,n)},s.prototype.removeEvents=function(e){var t;e.hasAttribute(i.HtmlAttrs.COUNTER)&&(t=e.getAttribute(i.HtmlAttrs.COUNTER),this.removeEvent(e,"contextmenu",t),this.removeEvent(e,"keydown",t),e.removeAttribute(i.HtmlAttrs.COUNTER))},s.prototype.removeEvent=function(e,t,n){var r=i.HtmlAttrs[t.toUpperCase()+"FUNC"],r=this.attrMap[r+n];e.removeEventListener(t,r)},s.prototype.keydown=function(e){e.keyCode===o.KEY.SPACE&&(this.menu.post(e),e.preventDefault(),e.stopImmediatePropagation())},s);function s(e){this.menu=e,this.store=[],this._active=null,this.counter=0,this.attachedClass=i.HtmlClasses.ATTACHED+"_"+r.MenuUtil.counter(),this.taborder=!0,this.attrMap={}}t.MenuStore=n},865:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MenuUtil=void 0,(t=t.MenuUtil||(t.MenuUtil={})).close=function(e){e=e.menu;(e.baseMenu||e).unpost()},t.getActiveElement=function(e){e=e.menu;return(e.baseMenu||e).store.active},t.error=function(e,t){console.error("ContextMenu Error: "+t)},t.counter=function(){return n++},n=0},9674:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MOUSE=void 0,t.MOUSE={CLICK:"click",DBLCLICK:"dblclick",DOWN:"mousedown",UP:"mouseup",OVER:"mouseover",OUT:"mouseout",MOVE:"mousemove",SELECTEND:"selectend",SELECTSTART:"selectstart"}},7258:function(e,t,n){var i=this&&this.__rest||function(e,t){var n={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0,n(9665)),a=n(9964),l=n(4842),c=n(3177),d=n(7253),p=n(1817),h=n(3348),f=n(2745),m=n(1156),g=n(2129),b=n(9467),y=n(7365),S=n(8534);function E(e){var n=this;void 0===e&&(e=[]),this._initList=[["command",s.Command.fromJson.bind(s.Command)],["checkbox",c.Checkbox.fromJson.bind(c.Checkbox)],["combo",d.Combo.fromJson.bind(d.Combo)],["slider",g.Slider.fromJson.bind(g.Slider)],["label",p.Label.fromJson.bind(p.Label)],["radio",h.Radio.fromJson.bind(h.Radio)],["rule",m.Rule.fromJson.bind(m.Rule)],["submenu",f.Submenu.fromJson.bind(f.Submenu)],["contextMenu",a.ContextMenu.fromJson.bind(a.ContextMenu)],["subMenu",b.SubMenu.fromJson.bind(b.SubMenu)],["variable",l.Variable.fromJson.bind(l.Variable)],["items",this.items.bind(this)],["selectionMenu",y.SelectionMenu.fromJson.bind(y.SelectionMenu)],["selectionBox",y.SelectionBox.fromJson.bind(y.SelectionBox)]],this._factory=new S.ParserFactory(this._initList),e.forEach(function(e){var e=r(e,2),t=e[0],e=e[1];return n.factory.add(t,e)})}Object.defineProperty(E.prototype,"factory",{get:function(){return this._factory},enumerable:!1,configurable:!0}),E.prototype.items=function(e,t,n){var r,i,o=[];try{for(var s=u(t),a=s.next();!a.done;a=s.next()){var l=a.value,c=this.parse(l,n);c&&(n.items.push(c),l.disabled&&c.disable(),l.hidden&&o.push(c))}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o.forEach(function(e){return e.hide()}),n.items},E.prototype.parse=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e.type,e=i(e,["type"]),r=this.factory.get(r);return r?r.apply(void 0,o([this.factory,e],t)):null},t.Parser=E},8534:function(e,t){function n(e){this._parser=new Map(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ParserFactory=void 0,n.prototype.get=function(e){return this._parser.get(e)},n.prototype.add=function(e,t){this._parser.set(e,t)},t.ParserFactory=n},7365:function(e,t,n){var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionBox=t.SelectionMenu=void 0,n(865)),a=n(1698),l=n(1585),n=n(6932),l=(i=l.AbstractMenu,o(c,i),c.fromJson=function(t,e,n){var r=e.title,i=e.values,o=e.variable,s=new this(n),e=t.get("label")(t,{content:r||"",id:r||"id"},s),n=t.get("rule")(t,{},s),r=i.map(function(e){return t.get("radio")(t,{content:e,variable:o,id:e},s)}),i=[e,n].concat(r);return s.items=i,s},c.prototype.generateHtml=function(){i.prototype.generateHtml.call(this),this.items.forEach(function(e){return e.html.classList.add(a.HtmlClasses.SELECTIONITEM)})},c.prototype.display=function(){},c.prototype.right=function(e){this.anchor.right(e)},c.prototype.left=function(e){this.anchor.left(e)},c);function c(e){var t=i.call(this)||this;return t.anchor=e,t.className=a.HtmlClasses.SELECTIONMENU,t.variablePool=t.anchor.menu.pool,t.baseMenu=t.anchor.menu,t}t.SelectionMenu=l;d=n.Info,o(p,d),p.fromJson=function(t,e,n){var r=e.title,i=e.signature,o=e.selections,s=new this(r,i,e.order,e.grid),r=(s.attachMenu(n),o.map(function(e){return t.get("selectionMenu")(t,e,s)}));return s.selections=r,s},p.prototype.attachMenu=function(e){this.menu=e},Object.defineProperty(p.prototype,"selections",{get:function(){return this._selections},set:function(e){var t=this;this._selections=[],e.forEach(function(e){return t.addSelection(e)})},enumerable:!1,configurable:!0}),p.prototype.addSelection=function(e){(e.anchor=this)._selections.push(e)},p.prototype.rowDiv=function(e){var t=this,n=document.createElement("div"),e=(this.contentDiv.appendChild(n),e.map(function(e){return n.appendChild(e.html),e.html.id||(e.html.id=t.prefix+s.MenuUtil.counter()),e.html.getBoundingClientRect()})),r=e.map(function(e){return e.width}),i=r.reduce(function(e,t){return e+t},0),e=e.reduce(function(e,t){return Math.max(e,t.height)},0);return n.classList.add(a.HtmlClasses.SELECTIONDIVIDER),n.setAttribute("style","height: "+e+"px;"),[n,i,e,r]},p.prototype.display=function(){if(d.prototype.display.call(this),this.order(),this.selections.length){for(var o=[],s=0,a=[],l=this.getChunkSize(this.selections.length),c=this,e=0;e<this.selections.length;e+=l)!function(e){var e=c.selections.slice(e,e+l),t=u(c.rowDiv(e),4),n=t[0],r=t[1],i=t[2],t=t[3];o.push(n),s=Math.max(s,r),e.forEach(function(e){return e.html.style.height=i+"px"}),a=c.combineColumn(a,t)}(e);this._balanced&&(this.balanceColumn(o,a),s=a.reduce(function(e,t){return e+t},20)),o.forEach(function(e){return e.style.width=s+"px"})}},p.prototype.getChunkSize=function(e){switch(this.grid){case"square":return Math.floor(Math.sqrt(e));case"horizontal":return Math.floor(e/p.chunkSize);default:return p.chunkSize}},p.prototype.balanceColumn=function(e,i){e.forEach(function(e){for(var t=Array.from(e.children),n=0,r=void 0;r=t[n];n++)r.style.width=i[n]+"px"})},p.prototype.combineColumn=function(e,t){for(var n=[],r=0;e[r]||t[r];){if(!e[r]){n=n.concat(t.slice(r));break}if(!t[r]){n=n.concat(e.slice(r));break}n.push(Math.max(e[r],t[r])),r++}return n},p.prototype.left=function(e){var t=this;this.move(e,function(e){return(0===e?t.selections.length:e)-1})},p.prototype.right=function(e){var t=this;this.move(e,function(e){return e===t.selections.length-1?0:e+1})},p.prototype.generateHtml=function(){d.prototype.generateHtml.call(this),this.html.classList.add(a.HtmlClasses.SELECTION)},p.prototype.generateContent=function(){var e=d.prototype.generateContent.call(this);return e.classList.add(a.HtmlClasses.SELECTIONBOX),e.removeAttribute("tabindex"),e},p.prototype.findSelection=function(e){var t,n=e.target,e=null;return(e=n.id?this.selections.find(function(e){return e.html.id===n.id}):e)||(t=n.parentElement.id,e=this.selections.find(function(e){return e.html.id===t})),e},p.prototype.move=function(e,t){e=this.findSelection(e),e.focused&&e.focused.unfocus(),t=t(this.selections.indexOf(e));this.selections[t].focus()},p.prototype.order=function(){this.selections.sort(p.orderMethod.get(this.style))},p.prototype.toJson=function(){return{type:""}},p.chunkSize=4,p.orderMethod=new Map([["alphabetical",function(e,t){return e.items[0].content.localeCompare(t.items[0].content)}],["none",function(e,t){return 1}],["decreasing",function(e,t){e=e.items.length,t=t.items.length;return e<t?1:t<e?-1:0}],["increasing",function(e,t){e=e.items.length,t=t.items.length;return e<t?-1:t<e?1:0}]]);var d,l=p;function p(e,t,n,r){void 0===n&&(n="none"),void 0===r&&(r="vertical");e=d.call(this,e,null,t)||this;return e.style=n,e.grid=r,e._selections=[],e.prefix="ctxt-selection",e._balanced=!0,e}t.SelectionBox=l},9467:function(e,t,n){var r,s,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=(Object.defineProperty(t,"__esModule",{value:!0}),t.SubMenu=void 0,s=n(1585).AbstractMenu,i(o,s),o.fromJson=function(e,t,n){t=t.items,n=new this(n),e=e.get("items")(e,t,n);return n.items=e,n},Object.defineProperty(o.prototype,"anchor",{get:function(){return this._anchor},enumerable:!1,configurable:!0}),o.prototype.post=function(){if(this.anchor.menu.isPosted()){for(var e=this.anchor.html,t=this.html,n=this.baseMenu.frame,r=e.offsetWidth,i=r-2,o=0;e&&e!==n;)i+=e.offsetLeft,o+=e.offsetTop,e=e.parentNode;i+t.offsetWidth>document.body.offsetWidth-5&&(i=Math.max(5,i-r-t.offsetWidth+6)),s.prototype.post.call(this,i,o)}},o.prototype.display=function(){this.baseMenu.frame.appendChild(this.html)},o.prototype.setBaseMenu=function(){for(var e=this;(e=e.anchor.menu)instanceof o;);this.baseMenu=e},o.prototype.left=function(e){this.focused=null,this.anchor.focus()},o.prototype.toJson=function(){return{type:""}},o);function o(e){var t=s.call(this)||this;return t._anchor=e,t.variablePool=t.anchor.menu.pool,t.setBaseMenu(),t}t.SubMenu=n},4842:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Variable=void 0;var r=n(865);function i(e,t,n){this._name=e,this.getter=t,this.setter=n,this.items=[]}i.fromJson=function(e,t,n){t=new this(t.name,t.getter,t.setter);n.insert(t)},Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),i.prototype.getValue=function(e){try{return this.getter(e)}catch(e){return r.MenuUtil.error(e,"Command of variable "+this.name+" failed."),null}},i.prototype.setValue=function(e,t){try{this.setter(e,t)}catch(e){r.MenuUtil.error(e,"Command of variable "+this.name+" failed.")}this.update()},i.prototype.register=function(e){-1===this.items.indexOf(e)&&this.items.push(e)},i.prototype.unregister=function(e){e=this.items.indexOf(e);-1!==e&&this.items.splice(e,1)},i.prototype.update=function(){this.items.forEach(function(e){return e.update()})},i.prototype.registerCallback=function(t){this.items.forEach(function(e){return e.registerCallback(t)})},i.prototype.unregisterCallback=function(t){this.items.forEach(function(e){return e.unregisterCallback(t)})},i.prototype.toJson=function(){return{type:"variable",name:this.name,getter:this.getter.toString(),setter:this.setter.toString()}},t.Variable=i},6964:function(e,t){function n(){this.pool={}}Object.defineProperty(t,"__esModule",{value:!0}),t.VariablePool=void 0,n.prototype.insert=function(e){this.pool[e.name]=e},n.prototype.lookup=function(e){return this.pool[e]},n.prototype.remove=function(e){delete this.pool[e]},n.prototype.update=function(){for(var e in this.pool)this.pool[e].update()},t.VariablePool=n},7086:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractAudioRenderer=void 0;const r=n(4886);t.AbstractAudioRenderer=class{constructor(){this.separator_=" "}setSeparator(e){this.separator_=e}getSeparator(){return"braille"===r.default.getInstance().modality?"":this.separator_}error(e){return null}merge(n){let r="";var i=n.length-1;for(let e,t=0;e=n[t];t++)if(r+=e.speech,t<i){const n=e.attributes.separator;r+=void 0!==n?n:this.getSeparator()}return r}finalize(e){return e}pauseValue(e){let t;switch(e){case"long":t=750;break;case"medium":t=500;break;case"short":t=250;break;default:t=parseInt(e,10)}return Math.floor(t*r.default.getInstance().getRate()/100)}}},9202:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AcssRenderer=void 0;const r=n(4998),i=n(6988),l=n(2599),o=n(9610);class s extends o.MarkupRenderer{markup(e){this.setScaleFunction(-2,2,0,10,0);const n=l.personalityMarkup(e),r=[],i={open:[]};let o=null,s=!1;for(let e,t=0;e=n[t];t++)if(l.isMarkupElement(e))l.mergeMarkup(i,e);else if(l.isPauseElement(e))s&&(o=l.mergePause(o,e,Math.max));else{const n='"'+this.merge(e.span)+'"';s=!0,o&&(r.push(this.pause(o)),o=null);var a=this.prosody_(i);r.push(a?"(text ("+a+") "+n+")":n)}return"(exp "+r.join(" ")+")"}error(e){return'(error "'+i.Move.get(e)+'")'}prosodyElement(e,t){switch(t=this.applyScaleFunction(t),e){case r.personalityProps.RATE:return"(richness . "+t+")";case r.personalityProps.PITCH:return"(average-pitch . "+t+")";case r.personalityProps.VOLUME:return"(stress . "+t+")"}return"(value . "+t+")"}pause(e){return"(pause . "+this.pauseValue(e[r.personalityProps.PAUSE])+")"}prosody_(n){const r=n.open,i=[];for(let e,t=0;e=r[t];t++)i.push(this.prosodyElement(e,n[e]));return i.join(" ")}}t.AcssRenderer=s},2599:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isSpanElement=t.isPauseElement=t.isMarkupElement=t.personalityMarkup=t.sortClose=t.mergeMarkup=t.mergePause=void 0;const a=n(1426),h=n(4998),f=n(1930);function m(n,r,e){return(e||function(e,t){return"number"==typeof e&&"number"==typeof t?e+t:"number"==typeof e?t:"number"==typeof t?e:[n,r].sort()[0]}).call(null,n,r)}t.mergePause=function(e,t,n){return e?{pause:m(e.pause,t.pause,n)}:t},t.mergeMarkup=function(t,n){delete t.open,n.close.forEach(e=>delete t[e]),n.open.forEach(e=>t[e]=n[e]);var e=Object.keys(t);t.open=e},t.sortClose=function(n,r){if(n.length<=1)return n;const i=[];for(let e,t=0;e=r[t],n.length;t++)e.close&&e.close.length&&e.close.forEach(function(e){var t=n.indexOf(e);-1!==t&&(i.unshift(e),n.splice(t,1))});return i};let g={},b=[];function y(e,t){const n=e[e.length-1];if(n){if(v(t)&&v(n)){if(void 0===n.join)return n.span=n.span.concat(t.span);const e=n.span.pop(),r=t.span.shift();return n.span.push(e+n.join+r),n.span=n.span.concat(t.span),n.join=t.join}N(t)&&N(n)?n.pause=m(n.pause,t.pause):e.push(t)}else e.push(t)}function S(e,t){e.rate&&(t.rate=e.rate),e.pitch&&(t.pitch=e.pitch),e.volume&&(t.volume=e.volume)}function E(e){return"object"==typeof e&&e.open}function N(e){return"object"==typeof e&&1===Object.keys(e).length&&Object.keys(e)[0]===h.personalityProps.PAUSE}function v(e){var t=Object.keys(e);return"object"==typeof e&&(1===t.length&&"span"===t[0]||2===t.length&&("span"===t[0]&&"join"===t[1]||"span"===t[1]&&"join"===t[0]))}function A(e,n){if(!n)return e;const r={};for(const a of h.personalityPropList){const h=e[a],s=n[a];var t;!h&&!s||h&&s&&h===s||(t=h||0,E(r)||(r.open=[],r.close=[]),h||r.close.push(a),s||r.open.push(a),s&&h&&(r.close.push(a),r.open.push(a)),n[a]=t,r[a]=t,g[a]?g[a].push(t):g[a]=[t])}if(E(r)){let e=r.close.slice();for(;0<e.length;){var i=b.pop(),o=(0,a.setdifference)(i,e);if(e=(0,a.setdifference)(e,i),i=o,0!==e.length){if(0!==i.length){r.close=r.close.concat(i),r.open=r.open.concat(i);for(let e,t=0;e=i[t];t++)r[e]=n[e]}}else 0!==i.length&&b.push(i)}b.push(r.open)}return r}t.personalityMarkup=function(n){g={},b=[];let r=[];var i={};for(let t,e=0;t=n[e];e++){let e=null;const d=t.descriptionSpan(),p=t.personality,g=p[h.personalityProps.JOIN];delete p[h.personalityProps.JOIN],void 0!==p[h.personalityProps.PAUSE]&&(e={[h.personalityProps.PAUSE]:p[h.personalityProps.PAUSE]},delete p[h.personalityProps.PAUSE]),u=c=l=a=s=o=void 0;var o=r,s=d,a=A(p,i),l=g,c=e,u=!0;if(u){const u=o[o.length-1];let e;if(u&&(e=u[h.personalityProps.JOIN]),u&&!s.speech&&c&&N(u)){const o=h.personalityProps.PAUSE;u[o]=m(u[o],c[o]),c=null}if(u&&s.speech&&0===Object.keys(a).length&&v(u)){if(void 0!==e){const o=u.span.pop();s=new f.Span(o.speech+e+s.speech,o.attributes)}u.span.push(s),s=new f.Span("",{}),u[h.personalityProps.JOIN]=l}}0!==Object.keys(a).length&&o.push(a),s.speech&&o.push({span:[s],join:l}),c&&o.push(c)}return r=function(r){const i={},o=[];for(let t,n=0;t=r[n];n++)if(E(t))if(!t.close||1!==t.close.length||t.open.length)S(t,i),o.push(t);else{let e=r[n+1];var s;!e||v(e)?(S(t,i),o.push(t)):(s=N(e)?e:null,(e=s?r[n+2]:e)&&E(e)&&e.open[0]===t.close[0]&&!e.close.length&&e[e.open[0]]===i[e.open[0]]?s?(y(o,s),n+=2):n+=1:(S(t,i),o.push(t)))}else y(o,t);return o}(r=r.concat(function(){const t=[];for(let e=b.length-1;0<=e;e--){var n=b[e];if(n.length){const i={open:[],close:[]};for(let e=0;e<n.length;e++){var r=n[e];i.close.push(r),i[r]=0}t.push(i)}}return t}()))},t.isMarkupElement=E,t.isPauseElement=N,t.isSpanElement=v},4148:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AuditoryDescription=void 0;const r=n(1058),i=n(1930);t.AuditoryDescription=class o{constructor({context:e,text:t,userValue:n,annotation:r,attributes:i,personality:o,layout:s}){this.context=e||"",this.text=t||"",this.userValue=n||"",this.annotation=r||"",this.attributes=i||{},this.personality=o||{},this.layout=s||""}static create(e,t={}){return e.text=r.Grammar.getInstance().apply(e.text,t),new o(e)}isEmpty(){return 0===this.context.length&&0===this.text.length&&0===this.userValue.length&&0===this.annotation.length}clone(){let e,t;if(this.personality){e={};for(const t in this.personality)e[t]=this.personality[t]}if(this.attributes){t={};for(const e in this.attributes)t[e]=this.attributes[e]}return new o({context:this.context,text:this.text,userValue:this.userValue,annotation:this.annotation,personality:e,attributes:t,layout:this.layout})}toString(){return'AuditoryDescription(context="'+this.context+'"  text="'+this.text+'"  userValue="'+this.userValue+'"  annotation="'+this.annotation+'")'}descriptionString(){return this.context&&this.text?this.context+" "+this.text:this.context||this.text}descriptionSpan(){return new i.Span(this.descriptionString(),this.attributes)}equals(e){return this.context===e.context&&this.text===e.text&&this.userValue===e.userValue&&this.annotation===e.annotation}}},4253:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isXml=t.registerRenderer=t.error=t.finalize=t.merge=t.markup=t.getSeparator=t.setSeparator=void 0;const r=n(4886),i=n(4998),o=n(9202),s=n(1292),a=n(1674),l=n(8078),c=n(1930),u=n(4115),d=n(6123),p=n(8244),h=n(4708),f=new u.SsmlRenderer,m=new Map([[i.Markup.NONE,new p.StringRenderer],[i.Markup.PUNCTUATION,new a.PunctuationRenderer],[i.Markup.LAYOUT,new s.LayoutRenderer],[i.Markup.ACSS,new o.AcssRenderer],[i.Markup.SABLE,new l.SableRenderer],[i.Markup.VOICEXML,f],[i.Markup.SSML,f],[i.Markup.SSML_STEP,new d.SsmlStepRenderer]]);t.setSeparator=function(e){const t=m.get(r.default.getInstance().markup);t&&t.setSeparator(e)},t.getSeparator=function(){const e=m.get(r.default.getInstance().markup);return e?e.getSeparator():""},t.markup=function(e){const t=m.get(r.default.getInstance().markup);return t?t.markup(e):""},t.merge=function(e){const t=e.map(e=>"string"==typeof e?new c.Span(e,{}):e),n=m.get(r.default.getInstance().markup);return n?n.merge(t):e.join()},t.finalize=function(e){const t=m.get(r.default.getInstance().markup);return t?t.finalize(e):e},t.error=function(e){const t=m.get(r.default.getInstance().markup);return t?t.error(e):""},t.registerRenderer=function(e,t){m.set(e,t)},t.isXml=function(){return m.get(r.default.getInstance().markup)instanceof h.XmlRenderer}},1292:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.LayoutRenderer=void 0;const r=n(1984),s=n(6671),i=n(4998),o=n(2599),a=n(4708);class l extends a.XmlRenderer{finalize(e){{c="";const t=s.parseInput(`<all>${e}</all>`);return r.Debugger.getInstance().output(s.formatXml(t.toString())),c=h(t)}}pause(e){return""}prosodyElement(e,t){return e===i.personalityProps.LAYOUT?`<${t}>`:""}closeTag(e){return`</${e}>`}markup(e){const t=[];let n=[];for(const r of e)if(r.layout){t.push(this.processContent(n)),n=[];const e=r.layout;e.match(/^begin/)?t.push("<"+e.replace(/^begin/,"")+">"):e.match(/^end/)?t.push("</"+e.replace(/^end/,"")+">"):console.warn("Something went wrong with layout markup: "+e)}else n.push(r);return t.push(this.processContent(n)),t.join("")}processContent(e){const n=[],r=o.personalityMarkup(e);for(let e,t=0;e=r[t];t++)e.span?n.push(this.merge(e.span)):o.isPauseElement(e);return n.join("")}}t.LayoutRenderer=l;let c="";const u={TABLE:function(e){let t=b(e);t.forEach(e=>{e.cells=e.cells.slice(1).slice(0,-1),e.width=e.width.slice(1).slice(0,-1)});var[e,n]=y(t);return E(t=S(t,n),e)},CASES:function(e){let t=b(e);t.forEach(e=>{e.cells=e.cells.slice(0,-1),e.width=e.width.slice(0,-1)});var[e,n]=y(t);return E(t=S(t,n),e)},CAYLEY:function(e){let t=b(e);t.forEach(e=>{e.cells=e.cells.slice(1).slice(0,-1),e.width=e.width.slice(1).slice(0,-1),e.sep=e.sep+e.sep});const[n,r]=y(t),i={lfence:"",rfence:"",cells:r.map(e=>"⠐"+new Array(e).join("⠒")),width:r,height:1,sep:t[0].sep};return t.splice(1,0,i),E(t=S(t,r),n)},MATRIX:function(e){var e=b(e),[t,n]=y(e);return E(S(e,n),t)},CELL:h,FENCE:h,ROW:h,FRACTION:function(e){var[e,t,,n,r]=Array.from(e.childNodes),t=d(t),n=d(n),i=m(t),o=m(n),i=Math.max(i,o),o=e+new Array(i+1).join("⠒")+r;return A(t,i=o.length)+`
${o}
`+A(n,i)},NUMERATOR:_,DENOMINATOR:_};function d(e){const t=s.tagName(e),n=u[t];return n?n(e):e.textContent}function p(e,t){if(!e||!t)return e+t;var n=f(e),r=f(t),i=n-r;e=i<0?g(e,r,m(e)):e,t=0<i?g(t,n,m(t)):t;const o=e.split(/\r\n|\r|\n/),s=t.split(/\r\n|\r|\n/),a=[];for(let e=0;e<o.length;e++)a.push(o[e]+s[e]);return a.join("\n")}function h(e){let t="";for(const n of Array.from(e.childNodes))t=n.nodeType!==s.NodeType.TEXT_NODE?p(t,d(n)):p(t,n.textContent);return t}function f(e){return e.split(/\r\n|\r|\n/).length}function m(e){return e.split(/\r\n|\r|\n/).reduce((e,t)=>Math.max(t.length,e),0)}function g(e,t,n){o=t-f(t=e),e=t+(0<o?new Array(1+o).join("\n"):"");{var r=e,i=n;const s=r.split(/\r\n|\r|\n/),a=[];for(const r of s){const s=i-r.length;a.push(r+(0<s?new Array(1+s).join("⠀"):""))}return a.join("\n")}var o}function b(e){const t=Array.from(e.childNodes),n=[];for(const e of t)e.nodeType===s.NodeType.ELEMENT_NODE&&n.push(function(e){const t=Array.from(e.childNodes),n=v(t[0]),r=v(t[t.length-1]);n&&t.shift(),r&&t.pop();let i="";const o=[];for(const e of t)if(e.nodeType===s.NodeType.TEXT_NODE)i=e.textContent;else{const t=d(e);o.push(t)}return{lfence:n,rfence:r,sep:i,cells:o,height:o.reduce((e,t)=>Math.max(f(t),e),0),width:o.map(m)}}(e));return n}function y(e){const t=e.reduce((e,t)=>Math.max(t.height,e),0),n=[];for(let t=0;t<e[0].width.length;t++)n.push(e.map(e=>e.width[t]).reduce((e,t)=>Math.max(e,t),0));return[t,n]}function S(t,n){const e=[];for(const r of t)if(0!==r.height){const t=[];for(let e=0;e<r.cells.length;e++)t.push(g(r.cells[e],r.height,n[e]));r.cells=t,e.push(r)}return e}function E(t,n){if(1===n)return t.map(e=>e.lfence+e.cells.join(e.sep)+e.rfence).join("\n");const r=[];for(const n of t){const t=N(n.sep,n.height);let e=n.cells.shift();for(;n.cells.length;)e=p(e,t),e=p(e,n.cells.shift());e=p(N(n.lfence,n.height),e),e=p(e,N(n.rfence,n.height)),r.push(e),r.push(n.lfence+new Array(m(e)-3).join(n.sep)+n.rfence)}return r.slice(0,-1).join("\n")}function N(e,t){let n="";for(;t;)n+=e+"\n",t--;return n.slice(0,-1)}function v(e){return e.nodeType===s.NodeType.ELEMENT_NODE&&"FENCE"===s.tagName(e)?d(e):""}function A(e,t){const n=(t-m(e))/2,[r,i]=Math.floor(n)===n?[n,n]:[Math.floor(n),Math.ceil(n)],o=e.split(/\r\n|\r|\n/),s=[],[a,l]=[new Array(r+1).join("⠀"),new Array(i+1).join("⠀")];for(const e of o)s.push(a+e+l);return s.join("\n")}function _(e){var t=e.firstChild,e=h(e);if(t&&t.nodeType===s.NodeType.ELEMENT_NODE){if("ENGLISH"===s.tagName(t))return"⠰"+e;if("NUMBER"===s.tagName(t))return"⠼"+e}return e}},9610:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.MarkupRenderer=void 0;const r=n(4998),i=n(7086);class o extends i.AbstractAudioRenderer{constructor(){super(...arguments),this.ignoreElements=[r.personalityProps.LAYOUT],this.scaleFunction=null}setScaleFunction(t,n,r,i,o=0){this.scaleFunction=e=>{e=(e-t)/(n-t);return+(Math.round(r*(1-e)+i*e+"e+"+o)+"e-"+o)}}applyScaleFunction(e){return this.scaleFunction?this.scaleFunction(e):e}ignoreElement(e){return-1!==this.ignoreElements.indexOf(e)}}t.MarkupRenderer=o},1674:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.PunctuationRenderer=void 0;const s=n(4998),r=n(7086),a=n(2599);class i extends r.AbstractAudioRenderer{markup(e){var n=a.personalityMarkup(e);let r="",i=null,o=!1;for(let e,t=0;e=n[t];t++)a.isMarkupElement(e)||(a.isPauseElement(e)?o&&(i=a.mergePause(i,e,Math.max)):(i&&(r+=this.pause(i[s.personalityProps.PAUSE]),i=null),r+=(o?this.getSeparator():"")+this.merge(e.span),o=!0));return r}pause(e){e="number"==typeof e?e<=250?"short":e<=500?"medium":"long":e;return i.PAUSE_PUNCTUATION.get(e)||""}}(t.PunctuationRenderer=i).PAUSE_PUNCTUATION=new Map([["short",","],["medium",";"],["long","."]])},8078:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SableRenderer=void 0;const r=n(4998),i=n(4708);class o extends i.XmlRenderer{finalize(e){return'<?xml version="1.0"?><!DOCTYPE SABLE PUBLIC "-//SABLE//DTD SABLE speech mark up//EN" "Sable.v0_2.dtd" []><SABLE>'+this.getSeparator()+e+this.getSeparator()+"</SABLE>"}pause(e){return'<BREAK MSEC="'+this.pauseValue(e[r.personalityProps.PAUSE])+'"/>'}prosodyElement(e,t){switch(t=this.applyScaleFunction(t),e){case r.personalityProps.PITCH:return'<PITCH RANGE="'+t+'%">';case r.personalityProps.RATE:return'<RATE SPEED="'+t+'%">';case r.personalityProps.VOLUME:return'<VOLUME LEVEL="'+t+'%">';default:return"<"+e.toUpperCase()+' VALUE="'+t+'">'}}closeTag(e){return"</"+e.toUpperCase()+">"}}t.SableRenderer=o},1930:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Span=void 0,t.Span=class{constructor(e,t){this.speech=e,this.attributes=t}}},4115:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SsmlRenderer=void 0;const r=n(4886),i=n(4998),o=n(4708);class s extends o.XmlRenderer{finalize(e){return'<?xml version="1.0"?><speak version="1.1" xmlns="http://www.w3.org/2001/10/synthesis"><prosody rate="'+r.default.getInstance().getRate()+'%">'+this.getSeparator()+e+this.getSeparator()+"</prosody></speak>"}pause(e){return'<break time="'+this.pauseValue(e[i.personalityProps.PAUSE])+'ms"/>'}prosodyElement(e,t){t=(t=Math.floor(this.applyScaleFunction(t)))<0?t.toString():"+"+t.toString();return"<prosody "+e.toLowerCase()+'="'+t+(e===i.personalityProps.VOLUME?">":'%">')}closeTag(e){return"</prosody>"}}t.SsmlRenderer=s},6123:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SsmlStepRenderer=void 0;class o extends n(4115).SsmlRenderer{markup(e){return o.MARKS={},super.markup(e)}merge(t){const n=[];for(let e=0;e<t.length;e++){const r=t[e],i=r.attributes.extid;i&&!o.MARKS[i]&&(n.push('<mark name="'+i+'"/>'),o.MARKS[i]=!0),1===r.speech.length&&r.speech.match(/[a-zA-Z]/)?n.push('<say-as interpret-as="'+o.CHARACTER_ATTR+'">'+r.speech+"</say-as>"):n.push(r.speech)}return n.join(this.getSeparator())}}(t.SsmlStepRenderer=o).CHARACTER_ATTR="character",o.MARKS={}},8244:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.StringRenderer=void 0;const r=n(7086),o=n(2599);class i extends r.AbstractAudioRenderer{markup(e){let n="";const r=(0,o.personalityMarkup)(e).filter(e=>e.span);if(!r.length)return n;var i=r.length-1;for(let e,t=0;e=r[t];t++)if(e.span&&(n+=this.merge(e.span)),!(t>=i)){const r=e.join;n+=void 0===r?this.getSeparator():r}return n}}t.StringRenderer=i},4708:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.XmlRenderer=void 0;const o=n(4886),s=n(2599),r=n(9610);class i extends r.MarkupRenderer{markup(e){this.setScaleFunction(-2,2,-100,100,2);const n=s.personalityMarkup(e),r=[],i=[];for(let t,e=0;t=n[e];e++)if(t.span)r.push(this.merge(t.span));else if(s.isPauseElement(t))r.push(this.pause(t));else{if(t.close.length)for(let e=0;e<t.close.length;e++){const n=i.pop();if(-1===t.close.indexOf(n))throw new o.SREError("Unknown closing markup element: "+n);r.push(this.closeTag(n))}t.open.length&&s.sortClose(t.open.slice(),n.slice(e+1)).forEach(e=>{r.push(this.prosodyElement(e,t[e])),i.push(e)})}return r.join(" ")}}t.XmlRenderer=i},1426:function(e,t){function n(e,t){return e?t?e.filter(e=>t.indexOf(e)<0):e:[]}Object.defineProperty(t,"__esModule",{value:!0}),t.union=t.setdifference=t.interleaveLists=t.removeEmpty=void 0,t.removeEmpty=function(e){return e.filter(e=>e)},t.interleaveLists=function(e,t){const n=[];for(;e.length||t.length;)e.length&&n.push(e.shift()),t.length&&n.push(t.shift());return n},t.setdifference=n,t.union=function(e,t){return e&&t?e.concat(n(t,e)):e||t||[]}},9501:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.loadScript=t.loadMapsForIE_=t.installWGXpath_=t.loadWGXpath_=t.mapsForIE=t.detectEdge=t.detectIE=void 0;const r=n(4755),i=n(5024);function o(e){l(r.default.WGXpath),s(e)}function s(e,t){let n=t||1;"undefined"==typeof wgxpath&&n<10?setTimeout(function(){s(e,n++)},200):10<=n||(r.default.wgxpath=wgxpath,e?r.default.wgxpath.install({document:document}):r.default.wgxpath.install(),i.xpath.evaluate=document.evaluate,i.xpath.result=XPathResult,i.xpath.createNSResolver=document.createNSResolver)}function a(){l(r.default.mathmapsIePath)}function l(e){const t=r.default.document.createElement("script");t.type="text/javascript",t.src=e,(r.default.document.head||r.default.document.body).appendChild(t)}t.detectIE=function(){return"undefined"!=typeof window&&"ActiveXObject"in window&&"clipboardData"in window&&(a(),o(),!0)},t.detectEdge=function(){var e;return"undefined"!=typeof window&&"MSGestureEvent"in window&&null===(null==(e=window.chrome)?void 0:e.loadTimes)&&(o(!(document.evaluate=null)),!0)},t.mapsForIE=null,t.loadWGXpath_=o,t.installWGXpath_=s,t.loadMapsForIE_=a,t.loadScript=l},1984:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Debugger=void 0;const r=n(4755);class i{constructor(){this.isActive_=!1,this.outputFunction_=console.info,this.stream_=null}static getInstance(){return i.instance=i.instance||new i,i.instance}init(e){e&&this.startDebugFile_(e),this.isActive_=!0}output(...e){this.isActive_&&this.output_(e)}generateOutput(e){this.isActive_&&this.output_(e.apply(e,[]))}exit(e=()=>{}){this.isActive_&&this.stream_&&this.stream_.end("","",e)}startDebugFile_(e){this.stream_=r.default.fs.createWriteStream(e),this.outputFunction_=function(...e){this.stream_.write(e.join(" ")),this.stream_.write("\n")}.bind(this),this.stream_.on("error",function(e){console.info("Invalid log file. Debug information sent to console."),this.outputFunction_=console.info}.bind(this)),this.stream_.on("finish",function(){console.info("Finalizing debug file.")})}output_(e){this.outputFunction_.apply(console.info===this.outputFunction_?console:this.outputFunction_,["Speech Rule Engine Debugger:"].concat(e))}}t.Debugger=i},6671:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeXml=t.cloneNode=t.tagName=t.querySelectorAll=t.querySelectorAllByAttrValue=t.querySelectorAllByAttr=t.formatXml=t.createTextNode=t.createElementNS=t.createElement=t.replaceNode=t.NodeType=t.parseInput=t.XML_ENTITIES=t.trimInput_=t.toArray=void 0;const i=n(4886),o=n(4998),s=n(4755),a=n(5024);function r(n){const r=[];for(let e=0,t=n.length;e<t;e++)r.push(n[e]);return r}function l(e){return(e=e.replace(/&nbsp;/g," ")).replace(/>[ \f\n\r\t\v\u200b]+</g,"><").trim()}t.toArray=r,t.trimInput_=l,t.XML_ENTITIES={"&lt;":!0,"&gt;":!0,"&amp;":!0,"&quot;":!0,"&apos;":!0},t.parseInput=function(e){const t=new s.default.xmldom.DOMParser,n=l(e),r=!!n.match(/&(?!lt|gt|amp|quot|apos)\w+;/g);if(!n)throw new Error("Empty input!");try{const e=t.parseFromString(n,r?"text/html":"text/xml");return i.default.getInstance().mode===o.Mode.HTTP?(a.xpath.currentDocument=e,r?e.body.childNodes[0]:e.documentElement):e.documentElement}catch(e){throw new i.SREError("Illegal input: "+e.message)}},(n=t.NodeType||(t.NodeType={}))[n.ELEMENT_NODE=1]="ELEMENT_NODE",n[n.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",n[n.TEXT_NODE=3]="TEXT_NODE",n[n.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",n[n.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",n[n.ENTITY_NODE=6]="ENTITY_NODE",n[n.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",n[n.COMMENT_NODE=8]="COMMENT_NODE",n[n.DOCUMENT_NODE=9]="DOCUMENT_NODE",n[n.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",n[n.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE",n[n.NOTATION_NODE=12]="NOTATION_NODE",t.replaceNode=function(e,t){e.parentNode&&(e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e))},t.createElement=function(e){return s.default.document.createElement(e)},t.createElementNS=function(e,t){return s.default.document.createElementNS(e,t)},t.createTextNode=function(e){return s.default.document.createTextNode(e)},t.formatXml=function(e){let n="",t=/(>)(<)(\/*)/g,r=0,i=(e=e.replace(t,"$1\r\n$2$3")).split("\r\n");for(t=/(\.)*(<)(\/*)/g,i=i.map(e=>e.replace(t,"$1\r\n$2$3").split("\r\n")).reduce((e,t)=>e.concat(t),[]);i.length;){let t=i.shift();if(t){let e=0;if(t.match(/^<\w[^>/]*>[^>]+$/)){o=t;const n=(s=i[0])?(o=o.match(/^<([^> ]+).*>/),s=s.match(/^<\/([^>]+)>(.*)/),o&&s&&o[1]===s[1]?[!0,s[2]]:[!1,""]):[!1,""];n[0]?n[1]?(t+=i.shift().slice(0,-n[1].length),n[1].trim()&&i.unshift(n[1])):t+=i.shift():e=1}else if(t.match(/^<\/\w/))0!==r&&--r;else if(t.match(/^<\w[^>]*[^/]>.*$/))e=1;else if(t.match(/^<\w[^>]*\/>.+$/)){const n=t.indexOf(">")+1;t.slice(n).trim()&&i.unshift(),t=t.slice(0,n)}else e=0;n+=new Array(r+1).join("  ")+t+"\r\n",r+=e}}var o,s;return n},t.querySelectorAllByAttr=function(e,t){return e.querySelectorAll?r(e.querySelectorAll(`[${t}]`)):a.evalXPath(`.//*[@${t}]`,e)},t.querySelectorAllByAttrValue=function(e,t,n){return e.querySelectorAll?r(e.querySelectorAll(`[${t}="${n}"]`)):a.evalXPath(`.//*[@${t}="${n}"]`,e)},t.querySelectorAll=function(e,t){return e.querySelectorAll?r(e.querySelectorAll(t)):a.evalXPath(".//"+t,e)},t.tagName=function(e){return e.tagName.toUpperCase()},t.cloneNode=function(e){return e.cloneNode(!0)},t.serializeXml=function(e){return(new s.default.xmldom.XMLSerializer).serializeToString(e)}},4886:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.EnginePromise=t.SREError=void 0;const o=n(8310),a=n(4998),l=n(1984),r=n(4513);class i extends Error{constructor(e=""){super(),this.message=e,this.name="SRE Error"}}t.SREError=i;class s{constructor(){this.customLoader=null,this.parsers={},this.comparator=null,this.mode=a.Mode.SYNC,this.init=!0,this.delay=!1,this.comparators={},this.domain="mathspeak",this.style=o.DynamicCstr.DEFAULT_VALUES[o.Axis.STYLE],this._defaultLocale=o.DynamicCstr.DEFAULT_VALUES[o.Axis.LOCALE],this.locale=this.defaultLocale,this.subiso="",this.modality=o.DynamicCstr.DEFAULT_VALUES[o.Axis.MODALITY],this.speech=a.Speech.NONE,this.markup=a.Markup.NONE,this.walker="Table",this.structure=!1,this.ruleSets=[],this.strict=!1,this.isIE=!1,this.isEdge=!1,this.rate="100",this.pprint=!1,this.config=!1,this.rules="",this.prune="",this.evaluator=s.defaultEvaluator,this.defaultParser=new o.DynamicCstrParser(o.DynamicCstr.DEFAULT_ORDER),this.parser=this.defaultParser,this.dynamicCstr=o.DynamicCstr.defaultCstr()}set defaultLocale(e){this._defaultLocale=r.Variables.ensureLocale(e,this._defaultLocale)}get defaultLocale(){return this._defaultLocale}static getInstance(){return s.instance=s.instance||new s,s.instance}static defaultEvaluator(e,t){return e}static evaluateNode(e){return s.nodeEvaluator(e)}getRate(){var e=parseInt(this.rate,10);return isNaN(e)?100:e}setDynamicCstr(t){if(this.defaultLocale&&(o.DynamicCstr.DEFAULT_VALUES[o.Axis.LOCALE]=this.defaultLocale),t){const n=Object.keys(t);for(let e=0;e<n.length;e++){const a=n[e];if(-1!==o.DynamicCstr.DEFAULT_ORDER.indexOf(a)){const n=t[a];this[a]=n}}}a.DOMAIN_TO_STYLES[this.domain]=this.style;const n=[this.locale,this.modality,this.domain,this.style].join("."),e=o.DynamicProperties.createProp([o.DynamicCstr.DEFAULT_VALUES[o.Axis.LOCALE]],[o.DynamicCstr.DEFAULT_VALUES[o.Axis.MODALITY]],[o.DynamicCstr.DEFAULT_VALUES[o.Axis.DOMAIN]],[o.DynamicCstr.DEFAULT_VALUES[o.Axis.STYLE]]),r=this.comparators[this.domain],i=this.parsers[this.domain];this.parser=i||this.defaultParser,this.dynamicCstr=this.parser.parse(n),this.dynamicCstr.updateProperties(e.getProperties()),this.comparator=r?r():new o.DefaultComparator(this.dynamicCstr)}configurate(e){if(this.mode===a.Mode.HTTP&&!this.config){{var n=e;const s=document.documentElement.querySelectorAll('script[type="text/x-sre-config"]');for(let t=0,e=s.length;t<e;t++){let e;try{e=s[t].innerHTML;var r=JSON.parse(e);for(const s in r)n[s]=r[s]}catch(n){l.Debugger.getInstance().output("Illegal configuration ",e)}}}this.config=!0}var t=e;if("undefined"!=typeof SREfeature)for(var[i,o]of Object.entries(SREfeature))t[i]=o}setCustomLoader(e){e&&(this.customLoader=e)}}(t.default=s).BINARY_FEATURES=["strict","structure","pprint"],s.STRING_FEATURES=["markup","style","domain","speech","walker","defaultLocale","locale","delay","modality","rate","rules","subiso","prune"],s.nodeEvaluator=function(e){return[]};class c{static get(e=s.getInstance().locale){return c.promises[e]||Promise.resolve("")}static getall(){return Promise.all(Object.values(c.promises))}}(t.EnginePromise=c).loaded={},c.promises={}},4998:function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.DOMAIN_TO_STYLES=t.Markup=t.Speech=t.personalityPropList=t.personalityProps=t.Mode=void 0,(r=t.Mode||(t.Mode={})).SYNC="sync",r.ASYNC="async",r.HTTP="http",(n=r=t.personalityProps||(t.personalityProps={})).PITCH="pitch",n.RATE="rate",n.VOLUME="volume",n.PAUSE="pause",n.JOIN="join",n.LAYOUT="layout",t.personalityPropList=[r.PITCH,r.RATE,r.VOLUME,r.PAUSE,r.JOIN],(n=t.Speech||(t.Speech={})).NONE="none",n.SHALLOW="shallow",n.DEEP="deep",(r=t.Markup||(t.Markup={})).NONE="none",r.LAYOUT="layout",r.PUNCTUATION="punctuation",r.SSML="ssml",r.SSML_STEP="ssml_step",r.ACSS="acss",r.SABLE="sable",r.VOICEXML="voicexml",t.DOMAIN_TO_STYLES={mathspeak:"default",clearspeak:"default"}},985:function(e,t,n){var r=this&&this.__awaiter||function(e,s,a,l){return new(a=a||Promise)(function(n,t){function r(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,i)}o((l=l.apply(e,s||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.setup=void 0;const i=n(2371),o=n(5659),s=n(9501),a=n(4886),l=n(7129),c=n(4755);t.setup=function(n){return r(this,void 0,void 0,function*(){const t=a.default.getInstance();"default"!==n.domain||"speech"!==n.modality&&n.modality&&"speech"!==t.modality||(n.domain="mathspeak");var e=e=>{void 0!==n[e]&&(t[e]=n[e])};return e("mode"),t.configurate(n),a.default.BINARY_FEATURES.forEach(e=>{void 0!==n[e]&&(t[e]=!!n[e])}),a.default.STRING_FEATURES.forEach(e),n.json&&(c.default.jsonPath=l.makePath(n.json)),n.xpath&&(c.default.WGXpath=n.xpath),t.setCustomLoader(n.custom),(e=t).isIE=s.detectIE(),e.isEdge=s.detectEdge(),i.setLocale(),t.setDynamicCstr(),t.init?(a.EnginePromise.promises.init=new Promise((e,t)=>{setTimeout(()=>{e("init")},10)}),t.init=!1,a.EnginePromise.get()):t.delay?(t.delay=!1,a.EnginePromise.get()):o.loadLocale()})}},6988:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Event=t.EventType=t.Move=t.KeyCode=void 0,(n=t.KeyCode||(t.KeyCode={}))[n.ENTER=13]="ENTER",n[n.ESC=27]="ESC",n[n.SPACE=32]="SPACE",n[n.PAGE_UP=33]="PAGE_UP",n[n.PAGE_DOWN=34]="PAGE_DOWN",n[n.END=35]="END",n[n.HOME=36]="HOME",n[n.LEFT=37]="LEFT",n[n.UP=38]="UP",n[n.RIGHT=39]="RIGHT",n[n.DOWN=40]="DOWN",n[n.TAB=9]="TAB",n[n.LESS=188]="LESS",n[n.GREATER=190]="GREATER",n[n.DASH=189]="DASH",n[n.ZERO=48]="ZERO",n[n.ONE=49]="ONE",n[n.TWO=50]="TWO",n[n.THREE=51]="THREE",n[n.FOUR=52]="FOUR",n[n.FIVE=53]="FIVE",n[n.SIX=54]="SIX",n[n.SEVEN=55]="SEVEN",n[n.EIGHT=56]="EIGHT",n[n.NINE=57]="NINE",n[n.A=65]="A",n[n.B=66]="B",n[n.C=67]="C",n[n.D=68]="D",n[n.E=69]="E",n[n.F=70]="F",n[n.G=71]="G",n[n.H=72]="H",n[n.I=73]="I",n[n.J=74]="J",n[n.K=75]="K",n[n.L=76]="L",n[n.M=77]="M",n[n.N=78]="N",n[n.O=79]="O",n[n.P=80]="P",n[n.Q=81]="Q",n[n.R=82]="R",n[n.S=83]="S",n[n.T=84]="T",n[n.U=85]="U",n[n.V=86]="V",n[n.W=87]="W",n[n.X=88]="X",n[n.Y=89]="Y",n[n.Z=90]="Z",t.Move=new Map([[13,"ENTER"],[27,"ESC"],[32,"SPACE"],[33,"PAGE_UP"],[34,"PAGE_DOWN"],[35,"END"],[36,"HOME"],[37,"LEFT"],[38,"UP"],[39,"RIGHT"],[40,"DOWN"],[9,"TAB"],[188,"LESS"],[190,"GREATER"],[189,"DASH"],[48,"ZERO"],[49,"ONE"],[50,"TWO"],[51,"THREE"],[52,"FOUR"],[53,"FIVE"],[54,"SIX"],[55,"SEVEN"],[56,"EIGHT"],[57,"NINE"],[65,"A"],[66,"B"],[67,"C"],[68,"D"],[69,"E"],[70,"F"],[71,"G"],[72,"H"],[73,"I"],[74,"J"],[75,"K"],[76,"L"],[77,"M"],[78,"N"],[79,"O"],[80,"P"],[81,"Q"],[82,"R"],[83,"S"],[84,"T"],[85,"U"],[86,"V"],[87,"W"],[88,"X"],[89,"Y"],[90,"Z"]]),(n=t.EventType||(t.EventType={})).CLICK="click",n.DBLCLICK="dblclick",n.MOUSEDOWN="mousedown",n.MOUSEUP="mouseup",n.MOUSEOVER="mouseover",n.MOUSEOUT="mouseout",n.MOUSEMOVE="mousemove",n.SELECTSTART="selectstart",n.KEYPRESS="keypress",n.KEYDOWN="keydown",n.KEYUP="keyup",n.TOUCHSTART="touchstart",n.TOUCHMOVE="touchmove",n.TOUCHEND="touchend",n.TOUCHCANCEL="touchcancel",t.Event=class{constructor(e,t,n){this.src=e,this.type=t,this.callback=n}add(){this.src.addEventListener(this.type,this.callback)}remove(){this.src.removeEventListener(this.type,this.callback)}}},7129:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.localePath=t.makePath=void 0;const r=n(4755);function i(e){return e.match("/$")?e:e+"/"}t.makePath=i,t.localePath=function(e,t="json"){return i(r.default.jsonPath)+e+(t.match(/^\./)?t:"."+t)}},3539:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.KeyProcessor=t.Processor=void 0;const r=n(6988);class i{constructor(e,t){this.name=e,this.process=t.processor,this.postprocess=t.postprocessor||((e,t)=>e),this.processor=this.postprocess?function(e){return this.postprocess(this.process(e),e)}:this.process,this.print=t.print||i.stringify_,this.pprint=t.pprint||this.print}static stringify_(e){return e&&e.toString()}}(t.Processor=i).LocalState={walker:null,speechGenerator:null,highlighter:null};i;t.KeyProcessor=class o extends i{constructor(e,t){super(e,t),this.key=t.key||o.getKey_}static getKey_(e){return"string"==typeof e?r.KeyCode[e.toUpperCase()]:e}}},9615:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.keypress=t.output=t.print=t.process=t.set=void 0;const a=n(4253),r=n(7450),i=n(9009),o=n(4524),l=n(1939),s=n(7317),c=n(144),u=n(907),d=n(8835),p=n(6671),h=n(4886),f=n(4998),m=n(3539),g=n(5024),b=new Map;function y(e){b.set(e.name,e)}function S(e){var t=b.get(e);if(t)return t;throw new h.SREError("Unknown processor "+e)}function E(e,t){const n=S(e);try{return n.processor(t)}catch(e){throw new h.SREError("Processing error for expression "+t)}}function N(e,t){const n=S(e);return h.default.getInstance().pprint?n.pprint(t):n.print(t)}t.set=y,t.process=E,t.print=N,t.output=function(e,t){const n=S(e);try{const e=n.processor(t);return h.default.getInstance().pprint?n.pprint(e):n.print(e)}catch(e){throw new h.SREError("Processing error for expression "+t)}},t.keypress=function(e,t){const n=S(e),r=n instanceof m.KeyProcessor?n.key(t):t,i=n.processor(r);return h.default.getInstance().pprint?n.pprint(i):n.print(i)},y(new m.Processor("semantic",{processor:function(e){e=p.parseInput(e);return l.xmlTree(e)},postprocessor:function(e,t){var n=h.default.getInstance().speech;if(n===f.Speech.NONE)return e;var r=p.cloneNode(e);let i=c.computeMarkup(r);if(n===f.Speech.SHALLOW)return e.setAttribute("speech",a.finalize(i)),e;var o=g.evalXPath(".//*[@id]",e),s=g.evalXPath(".//*[@id]",r);for(let e,t,n=0;e=o[n],t=s[n];n++)i=c.computeMarkup(t),e.setAttribute("speech",a.finalize(i));return e},pprint:function(e){return p.formatXml(e.toString())}})),y(new m.Processor("speech",{processor:function(e){e=p.parseInput(e),e=l.xmlTree(e),e=c.computeSpeech(e);return a.finalize(a.markup(e))},pprint:function(e){e=e.toString();return a.isXml()?p.formatXml(e):e}})),y(new m.Processor("json",{processor:function(e){e=p.parseInput(e);return l.getTree(e).toJson()},postprocessor:function(e,t){var n=h.default.getInstance().speech;if(n===f.Speech.NONE)return e;const r=p.parseInput(t),i=l.xmlTree(r),o=c.computeMarkup(i);if(n===f.Speech.SHALLOW)return e.stree.speech=a.finalize(o),e;const s=e=>{var t=g.evalXPath(`.//*[@id=${e.id}]`,i)[0],t=c.computeMarkup(t);e.speech=a.finalize(t),e.children&&e.children.forEach(s)};return s(e.stree),e},print:function(e){return JSON.stringify(e)},pprint:function(e){return JSON.stringify(e,null,2)}})),y(new m.Processor("description",{processor:function(e){e=p.parseInput(e),e=l.xmlTree(e);return c.computeSpeech(e)},print:function(e){return JSON.stringify(e)},pprint:function(e){return JSON.stringify(e,null,2)}})),y(new m.Processor("enriched",{processor:function(e){return r.semanticMathmlSync(e)},postprocessor:function(e,t){var n=d.getSemanticRoot(e);let r;switch(h.default.getInstance().speech){case f.Speech.NONE:break;case f.Speech.SHALLOW:(r=s.generator("Adhoc")).getSpeech(n,e);break;case f.Speech.DEEP:(r=s.generator("Tree")).getSpeech(e,e)}return e},pprint:function(e){return p.formatXml(e.toString())}})),y(new m.Processor("walker",{processor:function(e){const t=s.generator("Node");(m.Processor.LocalState.speechGenerator=t).setOptions({modality:h.default.getInstance().modality,locale:h.default.getInstance().locale,domain:h.default.getInstance().domain,style:h.default.getInstance().style}),m.Processor.LocalState.highlighter=i.highlighter({color:"black"},{color:"white"},{renderer:"NativeMML"});var e=E("enriched",e),n=N("enriched",e);return m.Processor.LocalState.walker=u.walker(h.default.getInstance().walker,e,t,m.Processor.LocalState.highlighter,n),m.Processor.LocalState.walker},print:function(e){return m.Processor.LocalState.walker.speech()}})),y(new m.KeyProcessor("move",{processor:function(e){return m.Processor.LocalState.walker?!1===m.Processor.LocalState.walker.move(e)?a.error(e):m.Processor.LocalState.walker.speech():null}})),y(new m.Processor("number",{processor:function(e){e=parseInt(e,10);return isNaN(e)?"":o.LOCALE.NUMBERS.numberToWords(e)}})),y(new m.Processor("ordinal",{processor:function(e){e=parseInt(e,10);return isNaN(e)?"":o.LOCALE.NUMBERS.wordOrdinal(e)}})),y(new m.Processor("numericOrdinal",{processor:function(e){e=parseInt(e,10);return isNaN(e)?"":o.LOCALE.NUMBERS.numericOrdinal(e)}})),y(new m.Processor("vulgar",{processor:function(e){var[e,t]=e.split("/").map(e=>parseInt(e,10));return isNaN(e)||isNaN(t)?"":E("speech",`<mfrac><mn>${e}</mn><mn>${t}</mn></mfrac>`)}}))},9037:function(e,t,n){var s=this&&this.__awaiter||function(e,s,a,l){return new(a=a||Promise)(function(n,t){function r(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,i)}o((l=l.apply(e,s||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.localePath=t.exit=t.move=t.walk=t.processFile=t.file=t.vulgar=t.numericOrdinal=t.ordinal=t.number=t.toEnriched=t.toDescription=t.toJson=t.toSemantic=t.toSpeech=t.localeLoader=t.engineReady=t.engineSetup=t.setupEngine=t.version=void 0;const a=n(4886),r=n(985),l=n(4998),i=n(7129),c=n(9615),u=n(4755),o=n(4513),d=n(5659);function p(e){return s(this,void 0,void 0,function*(){return(0,r.setup)(e)})}function h(e,t){return c.process(e,t)}function f(e,t,n){switch(a.default.getInstance().mode){case l.Mode.ASYNC:return function(t,n,r){return s(this,void 0,void 0,function*(){var e=yield u.default.fs.promises.readFile(n,{encoding:"utf8"}),e=c.output(t,e);if(r)try{u.default.fs.promises.writeFile(r,e)}catch(e){throw new a.SREError("Can not write to file: "+r)}return e})}(e,t,n);case l.Mode.SYNC:var r=e,i=n,o=function(e){let t;try{t=u.default.fs.readFileSync(e,{encoding:"utf8"})}catch(t){throw new a.SREError("Can not open file: "+e)}return t}(t),o=c.output(r,o);if(i)try{u.default.fs.writeFileSync(i,o)}catch(r){throw new a.SREError("Can not write to file: "+i)}return o;default:throw new a.SREError(`Can process files in ${a.default.getInstance().mode} mode`)}}t.version=o.Variables.VERSION,t.setupEngine=p,t.engineSetup=function(){const e=["mode"].concat(a.default.STRING_FEATURES,a.default.BINARY_FEATURES),t=a.default.getInstance(),n={};return e.forEach(function(e){n[e]=t[e]}),n.json=u.default.jsonPath,n.xpath=u.default.WGXpath,n.rules=t.ruleSets.slice(),n},t.engineReady=function(){return s(this,void 0,void 0,function*(){return p({}).then(()=>a.EnginePromise.getall())})},t.localeLoader=d.standardLoader,t.toSpeech=function(e){return h("speech",e)},t.toSemantic=function(e){return h("semantic",e)},t.toJson=function(e){return h("json",e)},t.toDescription=function(e){return h("description",e)},t.toEnriched=function(e){return h("enriched",e)},t.number=function(e){return h("number",e)},t.ordinal=function(e){return h("ordinal",e)},t.numericOrdinal=function(e){return h("numericOrdinal",e)},t.vulgar=function(e){return h("vulgar",e)},t.file={},t.file.toSpeech=function(e,t){return f("speech",e,t)},t.file.toSemantic=function(e,t){return f("semantic",e,t)},t.file.toJson=function(e,t){return f("json",e,t)},t.file.toDescription=function(e,t){return f("description",e,t)},t.file.toEnriched=function(e,t){return f("enriched",e,t)},t.processFile=f,t.walk=function(e){return c.output("walker",e)},t.move=function(e){return c.keypress("move",e)},t.exit=function(e){const t=e||0;a.EnginePromise.getall().then(()=>process.exit(t))},t.localePath=i.localePath,u.default.documentSupported?p({mode:l.Mode.HTTP}).then(()=>p({})):p({mode:l.Mode.SYNC}).then(()=>p({mode:l.Mode.ASYNC}))},4755:function(__unused_webpack_module,exports,__webpack_require__){var __dirname="/";Object.defineProperty(exports,"__esModule",{value:!0});const variables_1=__webpack_require__(4513);class SystemExternal{static extRequire(library){if("undefined"==typeof process)return null;{const nodeRequire=eval("require");return nodeRequire(library)}}}exports.default=SystemExternal,SystemExternal.windowSupported=!("undefined"==typeof window),SystemExternal.documentSupported=SystemExternal.windowSupported&&!(void 0===window.document),SystemExternal.xmldom=SystemExternal.documentSupported?window:SystemExternal.extRequire("xmldom-sre"),SystemExternal.document=SystemExternal.documentSupported?window.document:(new SystemExternal.xmldom.DOMImplementation).createDocument("","",0),SystemExternal.xpath=SystemExternal.documentSupported?document:function(){const e={document:{},XPathResult:{}};return SystemExternal.extRequire("wicked-good-xpath").install(e),e.document.XPathResult=e.XPathResult,e.document}(),SystemExternal.mathmapsIePath="https://cdn.jsdelivr.net/npm/sre-mathmaps-ie@"+variables_1.Variables.VERSION+"mathmaps_ie.js",SystemExternal.commander=SystemExternal.documentSupported?null:SystemExternal.extRequire("commander"),SystemExternal.fs=SystemExternal.documentSupported?null:SystemExternal.extRequire("fs"),SystemExternal.url=variables_1.Variables.url,SystemExternal.jsonPath=(SystemExternal.documentSupported?SystemExternal.url:process.env.SRE_JSON_PATH||__webpack_require__.g.SRE_JSON_PATH||__dirname+"/mathmaps")+"/",SystemExternal.WGXpath=variables_1.Variables.WGXpath,SystemExternal.wgxpath=null},4513:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Variables=void 0;class n{static ensureLocale(e,t){return n.LOCALES.get(e)?e:(console.error(`Locale ${e} does not exist! Using ${n.LOCALES.get(t)} instead.`),t)}}(t.Variables=n).VERSION="4.0.6",n.LOCALES=new Map([["ca","Catalan"],["da","Danish"],["de","German"],["en","English"],["es","Spanish"],["fr","French"],["hi","Hindi"],["it","Italian"],["nb","Bokmål"],["nn","Nynorsk"],["sv","Swedish"],["nemeth","Nemeth"]]),n.mathjaxVersion="3.2.1",n.url="https://cdn.jsdelivr.net/npm/speech-rule-engine@"+n.VERSION+"/lib/mathmaps",n.WGXpath="https://cdn.jsdelivr.net/npm/wicked-good-xpath@1.3.0/dist/wgxpath.install.js"},5024:function(e,i,t){Object.defineProperty(i,"__esModule",{value:!0}),i.updateEvaluator=i.evaluateString=i.evaluateBoolean=i.getLeafNodes=i.evalXPath=i.resolveNameSpace=i.xpath=void 0;const r=t(4886),o=t(4998),n=t(4755);function s(){return"undefined"!=typeof XPathResult}i.xpath={currentDocument:null,evaluate:(s()?document:n.default.xpath).evaluate,result:s()?XPathResult:n.default.xpath.XPathResult,createNSResolver:(s()?document:n.default.xpath).createNSResolver};const a={xhtml:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",mml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function l(e){return a[e]||null}i.resolveNameSpace=l;class c{constructor(){this.lookupNamespaceURI=l}}function u(e,t,n){return r.default.getInstance().mode!==o.Mode.HTTP||r.default.getInstance().isIE||r.default.getInstance().isEdge?i.xpath.evaluate(e,t,new c,n,null):i.xpath.currentDocument.evaluate(e,t,l,n,null)}function d(e,t){let n;try{n=u(e,t,i.xpath.result.ORDERED_NODE_ITERATOR_TYPE)}catch(e){return[]}const r=[];for(let e=n.iterateNext();e;e=n.iterateNext())r.push(e);return r}i.evalXPath=d,i.getLeafNodes=function(e){return d(".//*[count(*)=0]",e)},i.evaluateBoolean=function(e,t){let n;try{n=u(e,t,i.xpath.result.BOOLEAN_TYPE)}catch(e){return!1}return n.booleanValue},i.evaluateString=function(e,t){let n;try{n=u(e,t,i.xpath.result.STRING_TYPE)}catch(e){return""}return n.stringValue},i.updateEvaluator=function(t){if(r.default.getInstance().mode===o.Mode.HTTP){let e=t;for(;e&&!e.evaluate;)e=e.parentNode;e&&e.evaluate?i.xpath.currentDocument=e:t.ownerDocument&&(i.xpath.currentDocument=t.ownerDocument)}}},9341:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractEnrichCase=void 0,t.AbstractEnrichCase=class{constructor(e){this.semantic=e}}},4306:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseBinomial=void 0;const r=n(6671),i=n(9341),o=n(8672),s=n(8171);class a extends i.AbstractEnrichCase{constructor(e){super(e),this.mml=e.mathmlTree}static test(e){return!e.mathmlTree&&"line"===e.type&&"binomial"===e.role}getMathml(){if(!this.semantic.childNodes.length)return this.mml;const e=this.semantic.childNodes[0];if(this.mml=(0,o.walkTree)(e),this.mml.hasAttribute(s.Attribute.TYPE)){const e=r.createElement("mrow");e.setAttribute(s.Attribute.ADDED,"true"),r.replaceNode(this.mml,e),e.appendChild(this.mml),this.mml=e}return(0,s.setAttributes)(this.mml,this.semantic),this.mml}}t.CaseBinomial=a},8871:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseDoubleScript=void 0;const r=n(6671),i=n(9341),a=n(8672),l=n(8171);class o extends i.AbstractEnrichCase{constructor(e){super(e),this.mml=e.mathmlTree}static test(e){if(!e.mathmlTree||!e.childNodes.length)return!1;var t=r.tagName(e.mathmlTree),e=e.childNodes[0].role;return"MSUBSUP"===t&&"subsup"===e||"MUNDEROVER"===t&&"underover"===e}getMathml(){const e=this.semantic.childNodes[0],t=e.childNodes[0],n=this.semantic.childNodes[1],r=e.childNodes[1],i=a.walkTree(n),o=a.walkTree(t),s=a.walkTree(r);return(0,l.setAttributes)(this.mml,this.semantic),this.mml.setAttribute(l.Attribute.CHILDREN,(0,l.makeIdList)([t,r,n])),[o,s,i].forEach(e=>a.getInnerNode(e).setAttribute(l.Attribute.PARENT,this.mml.getAttribute(l.Attribute.ID))),this.mml.setAttribute(l.Attribute.TYPE,e.role),a.addCollapsedAttribute(this.mml,[this.semantic.id,[e.id,t.id,r.id],n.id]),this.mml}}t.CaseDoubleScript=o},928:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseEmbellished=void 0;const s=n(6671),r=n(9444),i=n(9341),a=n(8871),l=n(4308),c=n(439),u=n(8672),d=n(8171);class p extends i.AbstractEnrichCase{constructor(e){super(e),this.fenced=null,this.fencedMml=null,this.fencedMmlNodes=[],this.ofence=null,this.ofenceMml=null,this.ofenceMap={},this.cfence=null,this.cfenceMml=null,this.cfenceMap={},this.parentCleanup=[]}static test(e){return!(!e.mathmlTree||!e.fencePointer||e.mathmlTree.getAttribute("data-semantic-type"))}static makeEmptyNode_(e){const t=s.createElement("mrow"),n=new r.SemanticNode(e);return n.type="empty",n.mathmlTree=t,n}static fencedMap_(e,t){t[e.id]=e.mathmlTree,e.embellished&&p.fencedMap_(e.childNodes[0],t)}getMathml(){return this.getFenced_(),this.fencedMml=u.walkTree(this.fenced),this.getFencesMml_(),"empty"!==this.fenced.type||this.fencedMml.parentNode||(this.fencedMml.setAttribute(d.Attribute.ADDED,"true"),this.cfenceMml.parentNode.insertBefore(this.fencedMml,this.cfenceMml)),this.getFencedMml_(),this.rewrite_()}fencedElement(e){return"fenced"===e.type||"matrix"===e.type||"vector"===e.type}getFenced_(){let e=this.semantic;for(;!this.fencedElement(e);)e=e.childNodes[0];this.fenced=e.childNodes[0],this.ofence=e.contentNodes[0],this.cfence=e.contentNodes[1],p.fencedMap_(this.ofence,this.ofenceMap),p.fencedMap_(this.cfence,this.cfenceMap)}getFencedMml_(){let e=this.ofenceMml.nextSibling;for(e=e===this.fencedMml?e:this.fencedMml;e&&e!==this.cfenceMml;)this.fencedMmlNodes.push(e),e=e.nextSibling}getFencesMml_(){let e=this.semantic;const t=Object.keys(this.ofenceMap),n=Object.keys(this.cfenceMap);for(;!(this.ofenceMml&&this.cfenceMml||e===this.fenced);)-1===t.indexOf(e.fencePointer)||this.ofenceMml||(this.ofenceMml=e.mathmlTree),-1===n.indexOf(e.fencePointer)||this.cfenceMml||(this.cfenceMml=e.mathmlTree),e=e.childNodes[0];this.ofenceMml||(this.ofenceMml=this.ofence.mathmlTree),this.cfenceMml||(this.cfenceMml=this.cfence.mathmlTree),this.ofenceMml&&(this.ofenceMml=u.ascendNewNode(this.ofenceMml)),this.cfenceMml&&(this.cfenceMml=u.ascendNewNode(this.cfenceMml))}rewrite_(){let n=this.semantic,r=null;var e=this.introduceNewLayer_();for((0,d.setAttributes)(e,this.fenced.parent);!this.fencedElement(n);){var t=n.mathmlTree,i=this.specialCase_(n,t);if(i)n=i;else{(0,d.setAttributes)(t,n);const r=[];for(let e,t=1;e=n.childNodes[t];t++)r.push(u.walkTree(e));n=n.childNodes[0]}var i=s.createElement("dummy"),o=t.childNodes[0];s.replaceNode(t,i),s.replaceNode(e,t),s.replaceNode(t.childNodes[0],e),s.replaceNode(i,o),r=r||t}return u.walkTree(this.ofence),u.walkTree(this.cfence),this.cleanupParents_(),r||e}specialCase_(e,t){var n=s.tagName(t);let r,i=null;if("MSUBSUP"===n?(i=e.childNodes[0],r=a.CaseDoubleScript):"MMULTISCRIPTS"===n&&("superscript"===e.type||"subscript"===e.type?r=l.CaseMultiscripts:"tensor"===e.type&&(r=c.CaseTensor),i=r&&e.childNodes[0]&&"subsup"===e.childNodes[0].role?e.childNodes[0]:e),!i)return null;var n=i.childNodes[0],o=p.makeEmptyNode_(n.id);return i.childNodes[0]=o,t=new r(e).getMathml(),i.childNodes[0]=n,this.parentCleanup.push(t),i.childNodes[0]}introduceNewLayer_(){const e=this.fullFence(this.ofenceMml),t=this.fullFence(this.cfenceMml);let n=s.createElement("mrow");if(s.replaceNode(this.fencedMml,n),this.fencedMmlNodes.forEach(e=>n.appendChild(e)),n.insertBefore(e,this.fencedMml),n.appendChild(t),!n.parentNode){const e=s.createElement("mrow");for(;0<n.childNodes.length;)e.appendChild(n.childNodes[0]);n.appendChild(e),n=e}return n}fullFence(e){var t=this.fencedMml.parentNode;let n=e;for(;n.parentNode&&n.parentNode!==t;)n=n.parentNode;return n}cleanupParents_(){this.parentCleanup.forEach(function(e){var t=e.childNodes[1].getAttribute(d.Attribute.PARENT);e.childNodes[0].setAttribute(d.Attribute.PARENT,t)})}}t.CaseEmbellished=p},9763:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseLimit=void 0;const r=n(6671),i=n(9341),o=n(8672),s=n(8171);class a extends i.AbstractEnrichCase{constructor(e){super(e),this.mml=e.mathmlTree}static test(e){if(!e.mathmlTree||!e.childNodes.length)return!1;var t=r.tagName(e.mathmlTree),e=e.type;return("limupper"===e||"limlower"===e)&&("MSUBSUP"===t||"MUNDEROVER"===t)||"limboth"===e&&("MSUB"===t||"MUNDER"===t||"MSUP"===t||"MOVER"===t)}static walkTree_(e){e&&o.walkTree(e)}getMathml(){const e=this.semantic.childNodes;return"limboth"!==this.semantic.type&&3<=this.mml.childNodes.length&&(this.mml=o.introduceNewLayer([this.mml],this.semantic)),(0,s.setAttributes)(this.mml,this.semantic),e[0].mathmlTree||(e[0].mathmlTree=this.semantic.mathmlTree),e.forEach(a.walkTree_),this.mml}}t.CaseLimit=a},7978:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseLine=void 0;const r=n(9341),i=n(8672),o=n(8171);class s extends r.AbstractEnrichCase{constructor(e){super(e),this.mml=e.mathmlTree}static test(e){return!!e.mathmlTree&&"line"===e.type}getMathml(){return this.semantic.contentNodes.length&&i.walkTree(this.semantic.contentNodes[0]),this.semantic.childNodes.length&&i.walkTree(this.semantic.childNodes[0]),(0,o.setAttributes)(this.mml,this.semantic),this.mml}}t.CaseLine=s},2124:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseMultiindex=void 0;const o=n(6671),r=n(9341),s=n(8672),a=n(8171);class l extends r.AbstractEnrichCase{constructor(e){super(e),this.mml=e.mathmlTree}static multiscriptIndex(e){return"punctuated"===e.type&&"dummy"===e.contentNodes[0].role?s.collapsePunctuated(e):(s.walkTree(e),e.id)}static createNone_(e){const t=o.createElement("none");return e&&(0,a.setAttributes)(t,e),t.setAttribute(a.Attribute.ADDED,"true"),t}completeMultiscript(e,t){const r=o.toArray(this.mml.childNodes).slice(1);let i=0;var n=n=>{for(let t,e=0;t=n[e];e++){const n=r[i];if(n&&t===parseInt(s.getInnerNode(n).getAttribute(a.Attribute.ID)))s.getInnerNode(n).setAttribute(a.Attribute.PARENT,this.semantic.id.toString()),i++;else{const r=this.semantic.querySelectorAll(e=>e.id===t);this.mml.insertBefore(l.createNone_(r[0]),n||null)}}};n(e),r[i]&&"MPRESCRIPTS"!==o.tagName(r[i])?this.mml.insertBefore(r[i],o.createElement("mprescripts")):i++,n(t)}}t.CaseMultiindex=l},4308:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseMultiscripts=void 0;const r=n(6671),o=n(7984),s=n(2124),a=n(8672),l=n(8171);class i extends s.CaseMultiindex{static test(e){return!!e.mathmlTree&&("MMULTISCRIPTS"===r.tagName(e.mathmlTree)&&("superscript"===e.type||"subscript"===e.type))}constructor(e){super(e)}getMathml(){let e,t,n;if((0,l.setAttributes)(this.mml,this.semantic),this.semantic.childNodes[0]&&"subsup"===this.semantic.childNodes[0].role){const r=this.semantic.childNodes[0],i=(e=r.childNodes[0],t=s.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]),n=s.CaseMultiindex.multiscriptIndex(r.childNodes[1]),[this.semantic.id,[r.id,e.id,n],t]);a.addCollapsedAttribute(this.mml,i),this.mml.setAttribute(l.Attribute.TYPE,r.role),this.completeMultiscript(o.SemanticSkeleton.interleaveIds(n,t),[])}else{e=this.semantic.childNodes[0],t=s.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]);const n=[this.semantic.id,e.id,t];a.addCollapsedAttribute(this.mml,n)}const r=o.SemanticSkeleton.collapsedLeafs(n||[],t),i=a.walkTree(e);return a.getInnerNode(i).setAttribute(l.Attribute.PARENT,this.semantic.id.toString()),r.unshift(e.id),this.mml.setAttribute(l.Attribute.CHILDREN,r.join(",")),this.mml}}t.CaseMultiscripts=i},5326:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseProof=void 0;const r=n(9341),i=n(8672),o=n(8171);class s extends r.AbstractEnrichCase{constructor(e){super(e),this.mml=e.mathmlTree}static test(e){return!!e.mathmlTree&&("inference"===e.type||"premises"===e.type)}getMathml(){return this.semantic.childNodes.length&&(this.semantic.contentNodes.forEach(function(e){i.walkTree(e),(0,o.setAttributes)(e.mathmlTree,e)}),this.semantic.childNodes.forEach(function(e){i.walkTree(e)}),(0,o.setAttributes)(this.mml,this.semantic),this.mml.getAttribute("data-semantic-id")===this.mml.getAttribute("data-semantic-parent")&&this.mml.removeAttribute("data-semantic-parent")),this.mml}}t.CaseProof=s},6998:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseTable=void 0;const i=n(6671),r=n(9341),o=n(8672),s=n(8171);class a extends r.AbstractEnrichCase{constructor(e){super(e),this.inner=[],this.mml=e.mathmlTree}static test(e){return"matrix"===e.type||"vector"===e.type||"cases"===e.type}getMathml(){const e=o.cloneContentNode(this.semantic.contentNodes[0]),t=this.semantic.contentNodes[1]?o.cloneContentNode(this.semantic.contentNodes[1]):null;if(this.inner=this.semantic.childNodes.map(o.walkTree),this.mml)if("MFENCED"===i.tagName(this.mml)){var n=this.mml.childNodes;this.mml.insertBefore(e,n[0]||null),t&&this.mml.appendChild(t),this.mml=o.rewriteMfenced(this.mml)}else{const r=[e,this.mml];t&&r.push(t),this.mml=o.introduceNewLayer(r,this.semantic)}else this.mml=o.introduceNewLayer([e].concat(this.inner,[t]),this.semantic);return(0,s.setAttributes)(this.mml,this.semantic),this.mml}}t.CaseTable=a},439:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseTensor=void 0;const s=n(7984),a=n(2124),l=n(8672),c=n(8171);class r extends a.CaseMultiindex{static test(e){return!!e.mathmlTree&&"tensor"===e.type}constructor(e){super(e)}getMathml(){l.walkTree(this.semantic.childNodes[0]);var e=a.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]),t=a.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[2]),n=a.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[3]),r=a.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[4]),i=((0,c.setAttributes)(this.mml,this.semantic),[this.semantic.id,this.semantic.childNodes[0].id,e,t,n,r]);l.addCollapsedAttribute(this.mml,i);const o=s.SemanticSkeleton.collapsedLeafs(e,t,n,r);return o.unshift(this.semantic.childNodes[0].id),this.mml.setAttribute(c.Attribute.CHILDREN,o.join(",")),this.completeMultiscript(s.SemanticSkeleton.interleaveIds(n,r),s.SemanticSkeleton.interleaveIds(e,t)),this.mml}}t.CaseTensor=r},598:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CaseText=void 0;const r=n(9341),i=n(8672),o=n(8171);class s extends r.AbstractEnrichCase{constructor(e){super(e),this.mml=e.mathmlTree}static test(e){return"punctuated"===e.type&&("text"===e.role||e.contentNodes.every(e=>"dummy"===e.role))}getMathml(){var e=[],t=i.collapsePunctuated(this.semantic,e);return this.mml=i.introduceNewLayer(e,this.semantic),(0,o.setAttributes)(this.mml,this.semantic),this.mml.removeAttribute(o.Attribute.CONTENT),i.addCollapsedAttribute(this.mml,t),this.mml}}t.CaseText=s},7450:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.prepareMmlString=t.testTranslation__=t.semanticMathml=t.semanticMathmlSync=t.semanticMathmlNode=void 0;const r=n(1984),i=n(6671),o=n(4886),s=n(1939),a=n(8672),l=n(8171);function c(e){var e=i.cloneNode(e),t=s.getTree(e);return a.enrich(e,t)}function u(e){return c(i.parseInput(e))}function d(e){return(e=e.match(/^<math/)?e:"<math>"+e).match(/\/math>$/)||(e+="</math>"),e}n(7813),t.semanticMathmlNode=c,t.semanticMathmlSync=u,t.semanticMathml=function(t,n){o.EnginePromise.getall().then(()=>{var e=i.parseInput(t);n(c(e))})},t.testTranslation__=function(e){r.Debugger.getInstance().init();e=u(d(e)).toString();return(0,l.removeAttributePrefix)(e),r.Debugger.getInstance().exit(),e},t.prepareMmlString=d},8171:function(e,i){var o,t;function s(e){return e.map(function(e){return e.id}).join(",")}function a(e,t){const n=[];"mglyph"===t.role&&n.push("image"),t.attributes.href&&n.push("link"),n.length&&e.setAttribute(o.POSTFIX,n.join(" "))}Object.defineProperty(i,"__esModule",{value:!0}),i.addPrefix=i.removeAttributePrefix=i.setPostfix=i.setAttributes=i.makeIdList=i.EnrichAttributes=i.Attribute=i.Prefix=void 0,i.Prefix="data-semantic-",(t=o=i.Attribute||(i.Attribute={})).ADDED="data-semantic-added",t.ALTERNATIVE="data-semantic-alternative",t.CHILDREN="data-semantic-children",t.COLLAPSED="data-semantic-collapsed",t.CONTENT="data-semantic-content",t.EMBELLISHED="data-semantic-embellished",t.FENCEPOINTER="data-semantic-fencepointer",t.FONT="data-semantic-font",t.ID="data-semantic-id",t.ANNOTATION="data-semantic-annotation",t.OPERATOR="data-semantic-operator",t.OWNS="data-semantic-owns",t.PARENT="data-semantic-parent",t.POSTFIX="data-semantic-postfix",t.PREFIX="data-semantic-prefix",t.ROLE="data-semantic-role",t.SPEECH="data-semantic-speech",t.STRUCTURE="data-semantic-structure",t.TYPE="data-semantic-type",i.EnrichAttributes=[o.ADDED,o.ALTERNATIVE,o.CHILDREN,o.COLLAPSED,o.CONTENT,o.EMBELLISHED,o.FENCEPOINTER,o.FONT,o.ID,o.ANNOTATION,o.OPERATOR,o.OWNS,o.PARENT,o.POSTFIX,o.PREFIX,o.ROLE,o.SPEECH,o.STRUCTURE,o.TYPE],i.makeIdList=s,i.setAttributes=function(n,e){n.setAttribute(o.TYPE,e.type);var r=e.allAttributes();for(let e,t=0;e=r[t];t++)n.setAttribute(i.Prefix+e[0].toLowerCase(),e[1]);e.childNodes.length&&n.setAttribute(o.CHILDREN,s(e.childNodes)),e.contentNodes.length&&n.setAttribute(o.CONTENT,s(e.contentNodes)),e.parent&&n.setAttribute(o.PARENT,e.parent.id.toString()),a(n,e)},i.setPostfix=a,i.removeAttributePrefix=function(e){return e.toString().replace(new RegExp(i.Prefix,"g"),"")},i.addPrefix=function(e){return i.Prefix+e}},9775:function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.factory=r.getCase=void 0,r.getCase=function(n){for(let e,t=0;e=r.factory[t];t++)if(e.test(n))return e.constr(n);return null},r.factory=[]},7813:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(4306),i=n(8871),o=n(928),s=n(9763),a=n(7978),l=n(4308),c=n(5326),u=n(6998),d=n(439),p=n(598);n(9775).factory.push({test:s.CaseLimit.test,constr:e=>new s.CaseLimit(e)},{test:o.CaseEmbellished.test,constr:e=>new o.CaseEmbellished(e)},{test:i.CaseDoubleScript.test,constr:e=>new i.CaseDoubleScript(e)},{test:d.CaseTensor.test,constr:e=>new d.CaseTensor(e)},{test:l.CaseMultiscripts.test,constr:e=>new l.CaseMultiscripts(e)},{test:a.CaseLine.test,constr:e=>new a.CaseLine(e)},{test:r.CaseBinomial.test,constr:e=>new r.CaseBinomial(e)},{test:c.CaseProof.test,constr:e=>new c.CaseProof(e)},{test:u.CaseTable.test,constr:e=>new u.CaseTable(e)},{test:p.CaseText.test,constr:e=>new p.CaseText(e)})},8672:function(F,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.printNodeList__=n.collapsePunctuated=n.formattedOutput_=n.formattedOutput=n.getInnerNode=n.setOperatorAttribute_=n.createInvisibleOperator_=n.rewriteMfenced=n.cloneContentNode=n.addCollapsedAttribute=n.parentNode_=n.isIgnorable_=n.unitChild_=n.descendNode_=n.ascendNewNode=n.validLca_=n.pathToRoot_=n.attachedElement_=n.prunePath_=n.mathmlLca_=n.lcaType=n.functionApplication_=n.isDescendant_=n.insertNewChild_=n.mergeChildren_=n.collectChildNodes_=n.collateChildNodes_=n.childrenSubset_=n.moveSemanticAttributes_=n.introduceLayerAboveLca=n.introduceNewLayer=n.walkTree=n.enrich=n.SETTINGS=void 0;const o=e(1984),l=e(6671),k=e(4886),U=e(4020),B=e(2721),s=e(7984),a=e(8901),c=e(8171),j=e(9775);function u(e){const t=(0,j.getCase)(e);let n;if(t)return M(n=t.getMathml());if(1===e.mathml.length)return o.Debugger.getInstance().output("Walktree Case 0"),n=e.mathml[0],c.setAttributes(n,e),e.childNodes.length&&(o.Debugger.getInstance().output("Walktree Case 0.1"),e.childNodes.forEach(function(e){"empty"===e.type&&n.appendChild(u(e))})),M(n);var r=e.contentNodes.map(I),i=(P(e,r),e.childNodes.map(u)),r=s.SemanticSkeleton.combineContentChildren(e,r,i);if(null===(n=e.mathmlTree))o.Debugger.getInstance().output("Walktree Case 1"),n=d(r,e);else{const e=A(r);o.Debugger.getInstance().output("Walktree Case 2"),n=e?(o.Debugger.getInstance().output("Walktree Case 2.1"),e.parentNode):(o.Debugger.getInstance().output("Walktree Case 2.2"),R(n))}return g(n=L(n),r,e),c.setAttributes(n,e),M(n)}function d(e,t){const n=N(e);let r=n.node;var i=n.type;if(i!==E.VALID||!a.hasEmptyTag(r))if(o.Debugger.getInstance().output("Walktree Case 1.1"),r=l.createElement("mrow"),i===E.PRUNED)o.Debugger.getInstance().output("Walktree Case 1.1.0"),r=p(r,n.node,e);else if(e[0]){o.Debugger.getInstance().output("Walktree Case 1.1.1");const t=A(e),n=h(t.parentNode,e);l.replaceNode(t,r),n.forEach(function(e){r.appendChild(e)})}return t.mathmlTree||(t.mathmlTree=r),r}function p(t,e,n){let r=O(e);if(a.hasMathTag(r)){o.Debugger.getInstance().output("Walktree Case 1.1.0.0"),i(r,t),l.toArray(r.childNodes).forEach(function(e){t.appendChild(e)});const e=t;t=r,r=e}e=n.indexOf(e);return n[e]=r,l.replaceNode(r,t),t.appendChild(r),n.forEach(function(e){t.appendChild(e)}),t}function i(e,t){for(const n of c.EnrichAttributes)e.hasAttribute(n)&&(t.setAttribute(n,e.getAttribute(n)),e.removeAttribute(n))}function h(e,t){const n=l.toArray(e.childNodes);let r=1/0,i=-1/0;return t.forEach(function(e){e=n.indexOf(e);-1!==e&&(r=Math.min(r,e),i=Math.max(i,e))}),n.slice(r,i+1)}function f(e,t,n){const r=[];let i=l.toArray(e.childNodes),o=!1;for(;i.length;){const e=i.shift();if(e.hasAttribute(c.Attribute.TYPE))r.push(e);else{const t=m(e);0!==t.length&&(1!==t.length?(o?e.setAttribute("AuxiliaryImplicit",!0):o=!0,i=t.concat(i)):r.push(e))}}const s=[],a=n.childNodes.map(function(e){return e.mathmlTree});for(;a.length;){const e=a.pop();if(e){if(-1!==r.indexOf(e))break;-1!==t.indexOf(e)&&s.unshift(e)}}return r.concat(s)}function m(e){const t=[];let n=l.toArray(e.childNodes);for(;n.length;){const e=n.shift();e.nodeType===l.NodeType.ELEMENT_NODE&&(e.hasAttribute(c.Attribute.TYPE)?t.push(e):n=l.toArray(e.childNodes).concat(n))}return t}function g(t,n,r){var i="implicit"===r.role&&B.flags.combine_juxtaposition?f(t,n,r):l.toArray(t.childNodes);if(i.length){let e=0;for(;n.length;){const r=n[0];i[e]===r||S(i[e],r)?(n.shift(),e++):i[e]&&-1===n.indexOf(i[e])?e++:(y(r,t)||b(t,i[e],r),n.shift())}}else n.forEach(function(e){t.appendChild(e)})}function b(n,r,i){if(r){let e=r,t=x(e);for(;t&&t.firstChild===e&&!e.hasAttribute("AuxiliaryImplicit")&&t!==n;)t=x(e=t);t&&(t.insertBefore(i,e),e.removeAttribute("AuxiliaryImplicit"))}else n.insertBefore(i,null)}function y(e,t){if(!e)return!1;do{if((e=e.parentNode)===t)return!0}while(e);return!1}function S(n,r){var e=U.functionApplication();if(n&&r&&n.textContent&&r.textContent&&n.textContent===e&&r.textContent===e&&"true"===r.getAttribute(c.Attribute.ADDED)){for(let e,t=0;e=n.attributes[t];t++)r.hasAttribute(e.nodeName)||r.setAttribute(e.nodeName,e.nodeValue);return l.replaceNode(n,r),!0}return!1}var E;function N(e){var t=A(e);if(!t)return{type:E.INVALID,node:null};var n=A(e.slice().reverse());if(t===n)return{type:E.VALID,node:t};const r=_(t),i=v(r,e),o=_(n,function(e){return-1!==i.indexOf(e)}),s=o[0],a=i.indexOf(s);return-1===a?{type:E.INVALID,node:null}:{type:i.length!==r.length?E.PRUNED:C(i[a+1],o[1])?E.VALID:E.INVALID,node:s}}function v(e,t){let n=0;for(;e[n]&&-1===t.indexOf(e[n]);)n++;return e.slice(0,n+1)}function A(e){let t=0,n=null;for(;!n&&t<e.length;)e[t].parentNode&&(n=e[t]),t++;return n}function _(e,t){const n=t||(e=>!1),r=[e];for(;!n(e)&&!a.hasMathTag(e)&&e.parentNode;)e=x(e),r.unshift(e);return r}function C(e,t){return!(!e||!t||e.previousSibling||t.nextSibling)}function M(e){for(;!a.hasMathTag(e)&&t(e);)e=x(e);return e}function O(e){const t=l.toArray(e.childNodes);if(!t)return e;const n=t.filter(function(e){return e.nodeType===l.NodeType.ELEMENT_NODE&&!a.hasIgnoreTag(e)});return 1===n.length&&a.hasEmptyTag(n[0])&&!n[0].hasAttribute(c.Attribute.TYPE)?O(n[0]):e}function t(t){var e=x(t);return!(!e||!a.hasEmptyTag(e))&&l.toArray(e.childNodes).every(function(e){return e===t||T(e)})}function T(e){if(e.nodeType!==l.NodeType.ELEMENT_NODE)return!0;if(!e||a.hasIgnoreTag(e))return!0;var t=l.toArray(e.childNodes);return!(!a.hasEmptyTag(e)&&t.length||a.hasDisplayTag(e)||e.hasAttribute(c.Attribute.TYPE)||a.isOrphanedGlyph(e))&&l.toArray(e.childNodes).every(T)}function x(e){return e.parentNode}function I(e){if(e.mathml.length)return u(e);var t=n.SETTINGS.implicit?r(e):l.createElement("mrow");return e.mathml=[t],t}function L(n){if("MFENCED"!==l.tagName(n))return n;const r=l.createElement("mrow");for(let e,t=0;e=n.attributes[t];t++)-1===["open","close","separators"].indexOf(e.name)&&r.setAttribute(e.name,e.value);return l.toArray(n.childNodes).forEach(function(e){r.appendChild(e)}),l.replaceNode(n,r),r}function r(e){const t=l.createElement("mo"),n=l.createTextNode(e.textContent);return t.appendChild(n),c.setAttributes(t,e),t.setAttribute(c.Attribute.ADDED,"true"),t}function P(e,t){const n=e.type+(e.textContent?","+e.textContent:"");t.forEach(function(e){R(e).setAttribute(c.Attribute.OPERATOR,n)})}function R(e){const n=l.toArray(e.childNodes);if(!n)return e;const r=n.filter(function(e){return!T(e)}),i=[];for(let e,t=0;e=r[t];t++)if(a.hasEmptyTag(e)){const n=R(e);n&&n!==e&&i.push(n)}else i.push(e);return 1===i.length?i[0]:e}function w(e,t,n,r){r=r||!1;D(e,"Original MathML",r),D(n,"Semantic Tree",r),D(t,"Semantically enriched MathML",r)}function D(e,t,n){e=l.formatXml(e.toString());n?console.info(t+":\n```html\n"+c.removeAttributePrefix(e)+"\n```\n"):console.info(e)}n.SETTINGS={collapsed:!0,implicit:!0},n.enrich=function(e,t){const n=l.cloneNode(e);return u(t.root),k.default.getInstance().structure&&e.setAttribute(c.Attribute.STRUCTURE,s.SemanticSkeleton.fromStructure(e,t).toString()),o.Debugger.getInstance().generateOutput(function(){return w(n,e,t,!0),[]}),e},n.walkTree=u,n.introduceNewLayer=d,n.introduceLayerAboveLca=p,n.moveSemanticAttributes_=i,n.childrenSubset_=h,n.collateChildNodes_=f,n.collectChildNodes_=m,n.mergeChildren_=g,n.insertNewChild_=b,n.isDescendant_=y,n.functionApplication_=S,(e=E=n.lcaType||(n.lcaType={})).VALID="valid",e.INVALID="invalid",e.PRUNED="pruned",n.mathmlLca_=N,n.prunePath_=v,n.attachedElement_=A,n.pathToRoot_=_,n.validLca_=C,n.ascendNewNode=M,n.descendNode_=O,n.unitChild_=t,n.isIgnorable_=T,n.parentNode_=x,n.addCollapsedAttribute=function(e,t){const n=new s.SemanticSkeleton(t);e.setAttribute(c.Attribute.COLLAPSED,n.toString())},n.cloneContentNode=I,n.rewriteMfenced=L,n.createInvisibleOperator_=r,n.setOperatorAttribute_=P,n.getInnerNode=R,n.formattedOutput=w,n.formattedOutput_=D,n.collapsePunctuated=function(n,e){const r=!!e,i=e||[],o=n.parent,s=n.contentNodes.map(function(e){return e.id}),a=(s.unshift("c"),[n.id,s]);for(let e,t=0;e=n.childNodes[t];t++){const n=u(e),s=(i.push(n),R(n));o&&!r&&s.setAttribute(c.Attribute.PARENT,o.id.toString()),a.push(e.id)}return a},n.printNodeList__=function(e,t){console.info(e),l.toArray(t).forEach(function(e){console.info(e.toString())}),console.info("<<<<<<<<<<<<<<<<<")}},7228:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractHighlighter=void 0;const r=n(5024),i=n(8171);class o{constructor(){this.color=null,this.mactionName="",this.currentHighlights=[]}highlight(e){this.currentHighlights.push(e.map(e=>{var t=this.highlightNode(e);return this.setHighlighted(e),t}))}highlightAll(e){var n=this.getMactionNodes(e);for(let e,t=0;e=n[t];t++)this.highlight([e])}unhighlight(){const e=this.currentHighlights.pop();e&&e.forEach(e=>{this.isHighlighted(e.node)&&(this.unhighlightNode(e),this.unsetHighlighted(e.node))})}unhighlightAll(){for(;0<this.currentHighlights.length;)this.unhighlight()}setColor(e){this.color=e}colorString(){return this.color.rgba()}addEvents(e,n){const r=this.getMactionNodes(e);for(let e,t=0;e=r[t];t++)for(const r in n)e.addEventListener(r,n[r])}getMactionNodes(e){return Array.from(e.getElementsByClassName(this.mactionName))}isMactionNode(e){const t=e.className||e.getAttribute("class");return!!t&&!!t.match(new RegExp(this.mactionName))}isHighlighted(e){return e.hasAttribute(o.ATTR)}setHighlighted(e){e.setAttribute(o.ATTR,"true")}unsetHighlighted(e){e.removeAttribute(o.ATTR)}colorizeAll(e){r.evalXPath(`.//*[@${i.Attribute.ID}]`,e).forEach(e=>this.colorize(e))}uncolorizeAll(e){r.evalXPath(`.//*[@${i.Attribute.ID}]`,e).forEach(e=>this.uncolorize(e))}colorize(e){var t=(0,i.addPrefix)("foreground");e.hasAttribute(t)&&(e.setAttribute(t+"-old",e.style.color),e.style.color=e.getAttribute(t))}uncolorize(e){var t=(0,i.addPrefix)("foreground")+"-old";e.hasAttribute(t)&&(e.style.color=e.getAttribute(t))}}(t.AbstractHighlighter=o).ATTR="sre-highlight"},7567:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ChtmlHighlighter=void 0;class r extends n(9400).CssHighlighter{constructor(){super()}isMactionNode(e){return e.tagName.toUpperCase()===this.mactionName.toUpperCase()}getMactionNodes(e){return Array.from(e.getElementsByTagName(this.mactionName))}}t.ChtmlHighlighter=r},1123:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ContrastPicker=t.ColorPicker=void 0;const r={red:{red:255,green:0,blue:0},green:{red:0,green:255,blue:0},blue:{red:0,green:0,blue:255},yellow:{red:255,green:255,blue:0},cyan:{red:0,green:255,blue:255},magenta:{red:255,green:0,blue:255},white:{red:255,green:255,blue:255},black:{red:0,green:0,blue:0}};function n(e,t){var e=e||{color:t};let n=Object.prototype.hasOwnProperty.call(e,"color")?r[e.color]:e;return(n=n||r[t]).alpha=Object.prototype.hasOwnProperty.call(e,"alpha")?e.alpha:1,t=n,e=e=>(e=Math.max(e,0),e=Math.min(255,e),Math.round(e)),t.red=e(t.red),t.green=e(t.green),t.blue=e(t.blue),t.alpha=Math.max(t.alpha,0),t.alpha=Math.min(1,t.alpha),t}class i{constructor(e,t){this.foreground=n(t,i.DEFAULT_FOREGROUND_),this.background=n(e,i.DEFAULT_BACKGROUND_)}static toHex(e){e=e.toString(16);return 1===e.length?"0"+e:e}rgba(){function e(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"}return{background:e(this.background),foreground:e(this.foreground)}}rgb(){function e(e){return"rgb("+e.red+","+e.green+","+e.blue+")"}return{background:e(this.background),alphaback:this.background.alpha.toString(),foreground:e(this.foreground),alphafore:this.foreground.alpha.toString()}}hex(){function e(e){return"#"+i.toHex(e.red)+i.toHex(e.green)+i.toHex(e.blue)}return{background:e(this.background),alphaback:this.background.alpha.toString(),foreground:e(this.foreground),alphafore:this.foreground.alpha.toString()}}}(t.ColorPicker=i).DEFAULT_BACKGROUND_="blue",i.DEFAULT_FOREGROUND_="black",t.ContrastPicker=class{constructor(){this.hue=10,this.sat=100,this.light=50,this.incr=50}generate(){return e=function(e,t,n){t=1<t?t/100:t,n=1<n?n/100:n;var t=(1-Math.abs(2*n-1))*t,r=t*(1-Math.abs(e/60%2-1)),n=n-t/2;let i=0,o=0,s=0;return 0<=e&&e<60?[i,o,s]=[t,r,0]:60<=e&&e<120?[i,o,s]=[r,t,0]:120<=e&&e<180?[i,o,s]=[0,t,r]:180<=e&&e<240?[i,o,s]=[0,r,t]:240<=e&&e<300?[i,o,s]=[r,0,t]:300<=e&&e<360&&([i,o,s]=[t,0,r]),{red:i+n,green:o+n,blue:s+n}}(this.hue,this.sat,this.light),"rgb("+(e={red:Math.round(255*e.red),green:Math.round(255*e.green),blue:Math.round(255*e.blue)}).red+","+e.green+","+e.blue+")";var e}increment(){this.hue=(this.hue+this.incr)%360}}},9400:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CssHighlighter=void 0;class r extends n(7228).AbstractHighlighter{constructor(){super(),this.mactionName="mjx-maction"}highlightNode(e){var t={node:e,background:e.style.backgroundColor,foreground:e.style.color},n=this.colorString();return e.style.backgroundColor=n.background,e.style.color=n.foreground,t}unhighlightNode(e){e.node.style.backgroundColor=e.background,e.node.style.color=e.foreground}}t.CssHighlighter=r},9009:function(e,s,t){Object.defineProperty(s,"__esModule",{value:!0}),s.highlighterMapping_=s.addEvents=s.highlighter=void 0;const n=t(7567),a=t(1123),r=t(9400),i=t(7872),o=t(3711),l=t(4662),c=t(3507),u=t(280);s.highlighter=function(e,t,n){const r=new a.ColorPicker(e,t),i="NativeMML"===n.renderer&&"Safari"===n.browser?"MML-CSS":"SVG"===n.renderer&&"v3"===n.browser?"SVG-V3":n.renderer,o=new(s.highlighterMapping_[i]||s.highlighterMapping_.NativeMML);return o.setColor(r),o},s.addEvents=function(e,t,n){const r=s.highlighterMapping_[n.renderer];r&&(new r).addEvents(e,t)},s.highlighterMapping_={SVG:c.SvgHighlighter,"SVG-V3":u.SvgV3Highlighter,NativeMML:l.MmlHighlighter,"HTML-CSS":i.HtmlHighlighter,"MML-CSS":o.MmlCssHighlighter,CommonHTML:r.CssHighlighter,CHTML:n.ChtmlHighlighter}},7872:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlHighlighter=void 0;const s=n(6671),r=n(7228);class i extends r.AbstractHighlighter{constructor(){super(),this.mactionName="maction"}highlightNode(e){const t={node:e,foreground:e.style.color,position:e.style.position},n=this.color.rgb();e.style.color=n.foreground,e.style.position="relative";var r=e.bbox;if(r&&r.w){const i=s.createElement("span"),o=parseFloat(e.style.paddingLeft||"0");i.style.backgroundColor=n.background,i.style.opacity=n.alphaback.toString(),i.style.display="inline-block",i.style.height=r.h+r.d+.1+"em",i.style.verticalAlign=-r.d+"em",i.style.marginTop=i.style.marginBottom="-0.05em",i.style.width=r.w+0+"em",i.style.marginLeft=+o+"em",i.style.marginRight=-r.w-o+"em",e.parentNode.insertBefore(i,e),t.box=i}return t}unhighlightNode(e){const t=e.node;t.style.color=e.foreground,t.style.position=e.position,e.box&&e.box.parentNode.removeChild(e.box)}}t.HtmlHighlighter=i},3711:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.MmlCssHighlighter=void 0;class r extends n(9400).CssHighlighter{constructor(){super(),this.mactionName="maction"}getMactionNodes(e){return Array.from(e.getElementsByTagName(this.mactionName))}isMactionNode(e){return e.tagName===this.mactionName}}t.MmlCssHighlighter=r},4662:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.MmlHighlighter=void 0;class r extends n(7228).AbstractHighlighter{constructor(){super(),this.mactionName="maction"}highlightNode(e){var t=e.getAttribute("style"),t=(t+=";background-color: "+this.colorString().background)+(";color: "+this.colorString().foreground);return e.setAttribute("style",t),{node:e}}unhighlightNode(e){let t=e.node.getAttribute("style");t=(t=t.replace(";background-color: "+this.colorString().background,"")).replace(";color: "+this.colorString().foreground,""),e.node.setAttribute("style",t)}colorString(){return this.color.rgba()}getMactionNodes(e){return Array.from(e.getElementsByTagName(this.mactionName))}isMactionNode(e){return e.tagName===this.mactionName}}t.MmlHighlighter=r},3507:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SvgHighlighter=void 0;const o=n(6671),s=n(7228);class r extends s.AbstractHighlighter{constructor(){super(),this.mactionName="mjx-svg-maction"}highlightNode(e){let t;if(this.isHighlighted(e))return t={node:e.previousSibling||e,background:e.style.backgroundColor,foreground:e.style.color};if("svg"===e.tagName){const t={node:e,background:e.style.backgroundColor,foreground:e.style.color};return e.style.backgroundColor=this.colorString().background,e.style.color=this.colorString().foreground,t}const n=o.createElementNS("http://www.w3.org/2000/svg","rect");let r;if("use"===e.nodeName){const t=o.createElementNS("http://www.w3.org/2000/svg","g");e.parentNode.insertBefore(t,e),t.appendChild(e),r=t.getBBox(),t.parentNode.replaceChild(e,t)}else r=e.getBBox();n.setAttribute("x",(r.x-40).toString()),n.setAttribute("y",(r.y-40).toString()),n.setAttribute("width",(r.width+80).toString()),n.setAttribute("height",(r.height+80).toString());var i=e.getAttribute("transform");return i&&n.setAttribute("transform",i),n.setAttribute("fill",this.colorString().background),n.setAttribute(s.AbstractHighlighter.ATTR,"true"),e.parentNode.insertBefore(n,e),t={node:n,foreground:e.getAttribute("fill")},e.setAttribute("fill",this.colorString().foreground),t}setHighlighted(e){"svg"===e.tagName&&super.setHighlighted(e)}unhighlightNode(e){if("background"in e)return e.node.style.backgroundColor=e.background,void(e.node.style.color=e.foreground);e.foreground?e.node.nextSibling.setAttribute("fill",e.foreground):e.node.nextSibling.removeAttribute("fill"),e.node.parentNode.removeChild(e.node)}isMactionNode(e){let t=e.className||e.getAttribute("class");return!!(t=void 0!==t.baseVal?t.baseVal:t)&&!!t.match(new RegExp(this.mactionName))}}t.SvgHighlighter=r},280:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SvgV3Highlighter=void 0;const i=n(6671),r=n(5024),o=n(7228),s=n(1123),a=n(3507);class l extends a.SvgHighlighter{constructor(){super(),this.mactionName="maction"}highlightNode(e){let t;if(this.isHighlighted(e))return t={node:e,background:this.colorString().background,foreground:this.colorString().foreground};if("svg"===e.tagName||"MJX-CONTAINER"===e.tagName)return t={node:e,background:e.style.backgroundColor,foreground:e.style.color},e.style.backgroundColor=this.colorString().background,e.style.color=this.colorString().foreground,t;const n=i.createElementNS("http://www.w3.org/2000/svg","rect");n.setAttribute("sre-highlighter-added","true");var r=e.getBBox(),r=(n.setAttribute("x",(r.x-40).toString()),n.setAttribute("y",(r.y-40).toString()),n.setAttribute("width",(r.width+80).toString()),n.setAttribute("height",(r.height+80).toString()),e.getAttribute("transform"));if(r&&n.setAttribute("transform",r),n.setAttribute("fill",this.colorString().background),e.setAttribute(o.AbstractHighlighter.ATTR,"true"),e.parentNode.insertBefore(n,e),t={node:e,foreground:e.getAttribute("fill")},"rect"===e.nodeName){const t=new s.ColorPicker({alpha:0,color:"black"});e.setAttribute("fill",t.rgba().foreground)}else e.setAttribute("fill",this.colorString().foreground);return t}unhighlightNode(e){const t=e.node.previousSibling;if(t&&t.hasAttribute("sre-highlighter-added"))return e.foreground?e.node.setAttribute("fill",e.foreground):e.node.removeAttribute("fill"),void e.node.parentNode.removeChild(t);e.node.style.backgroundColor=e.background,e.node.style.color=e.foreground}isMactionNode(e){return e.getAttribute("data-mml-node")===this.mactionName}getMactionNodes(e){return Array.from(r.evalXPath(`.//*[@data-mml-node="${this.mactionName}"]`,e))}}t.SvgV3Highlighter=l},1473:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.StaticTrieNode=t.AbstractTrieNode=void 0;const r=n(1984),i=n(9259);class o{constructor(e,t){this.constraint=e,this.test=t,this.children_={},this.kind=i.TrieNodeKind.ROOT}getConstraint(){return this.constraint}getKind(){return this.kind}applyTest(e){return this.test(e)}addChild(e){var t=e.getConstraint(),n=this.children_[t];return this.children_[t]=e,n}getChild(e){return this.children_[e]}getChildren(){const e=[];for(const t in this.children_)e.push(this.children_[t]);return e}findChildren(e){const t=[];for(const n in this.children_){const r=this.children_[n];r.applyTest(e)&&t.push(r)}return t}removeChild(e){delete this.children_[e]}toString(){return this.constraint}}t.AbstractTrieNode=o,t.StaticTrieNode=class extends o{constructor(e,t){super(e,t),this.rule_=null,this.kind=i.TrieNodeKind.STATIC}getRule(){return this.rule_}setRule(e){this.rule_&&r.Debugger.getInstance().output("Replacing rule "+this.rule_+" with "+e),this.rule_=e}toString(){return this.getRule()?this.constraint+"\n==> "+this.getRule().action:this.constraint}}},2803:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Trie=void 0;const s=n(9259),o=n(9146);class a{constructor(){this.root=(0,o.getNode)(s.TrieNodeKind.ROOT,"",null)}static collectRules_(e){const t=[];let n=[e];for(;n.length;){const e=n.shift();if(e.getKind()===s.TrieNodeKind.QUERY||e.getKind()===s.TrieNodeKind.BOOLEAN){const n=e.getRule();n&&t.unshift(n)}n=n.concat(e.getChildren())}return t}static printWithDepth_(e,n,r){r+=new Array(n+2).join(n.toString())+": "+e.toString()+"\n";var i=e.getChildren();for(let e,t=0;e=i[t];t++)r=a.printWithDepth_(e,n+1,r);return r}static order_(e){const t=e.getChildren();if(!t.length)return 0;e=Math.max.apply(null,t.map(a.order_));return Math.max(t.length,e)}addRule(e){let n=this.root;var r=e.context,i=e.dynamicCstr.getValues();for(let e=0,t=i.length;e<t;e++)n=this.addNode_(n,i[e],s.TrieNodeKind.DYNAMIC,r);n=this.addNode_(n,e.precondition.query,s.TrieNodeKind.QUERY,r);var o=e.precondition.constraints;for(let e=0,t=o.length;e<t;e++)n=this.addNode_(n,o[e],s.TrieNodeKind.BOOLEAN,r);n.setRule(e)}lookupRules(t,e){let n=[this.root];const r=[];for(;e.length;){const t=e.shift(),r=[];for(;n.length;)n.shift().getChildren().forEach(e=>{e.getKind()===s.TrieNodeKind.DYNAMIC&&-1===t.indexOf(e.getConstraint())||r.push(e)});n=r.slice()}for(;n.length;){const e=n.shift();if(e.getRule){const t=e.getRule();t&&r.push(t)}const s=e.findChildren(t);n=n.concat(s)}return r}hasSubtrie(n){let r=this.root;for(let e=0,t=n.length;e<t;e++){var i=n[e];if(!(r=r.getChild(i)))return!1}return!0}toString(){return a.printWithDepth_(this.root,0,"")}collectRules(){return a.collectRules_(this.root)}order(){return a.order_(this.root)}enumerate(e){return this.enumerate_(this.root,e)}byConstraint(e){let t=this.root;for(;e.length&&t;){var n=e.shift();t=t.getChild(n)}return t||null}enumerate_(e,n){n=n||{};var r=e.getChildren();for(let e,t=0;e=r[t];t++)e.kind===s.TrieNodeKind.DYNAMIC&&(n[e.getConstraint()]=this.enumerate_(e,n[e.getConstraint()]));return n}addNode_(e,t,n,r){let i=e.getChild(t);return i||(i=(0,o.getNode)(n,t,r),e.addChild(i)),i}}t.Trie=a},9259:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TrieNodeKind=void 0,(t=t.TrieNodeKind||(t.TrieNodeKind={})).ROOT="root",t.DYNAMIC="dynamic",t.QUERY="query",t.BOOLEAN="boolean",t.STATIC="static"},9146:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanTrieNode=t.QueryTrieNode=t.constraintTest_=t.DynamicTrieNode=t.RootTrieNode=t.getNode=void 0;const g=n(6671),b=n(5024),y=n(1058),S=n(4161),r=n(1473),i=n(1473),o=n(9259);t.getNode=function(e,t,n){switch(e){case o.TrieNodeKind.ROOT:return new s;case o.TrieNodeKind.DYNAMIC:return new a(t);case o.TrieNodeKind.QUERY:return new c(t,n);case o.TrieNodeKind.BOOLEAN:return new u(t,n);default:return null}};class s extends r.AbstractTrieNode{constructor(){super("",()=>!0),this.kind=o.TrieNodeKind.ROOT}}t.RootTrieNode=s;class a extends r.AbstractTrieNode{constructor(t){super(t,e=>e===t),this.kind=o.TrieNodeKind.DYNAMIC}}t.DynamicTrieNode=a;const E={"=":(e,t)=>e===t,"!=":(e,t)=>e!==t,"<":(e,t)=>e<t,">":(e,t)=>t<e,"<=":(e,t)=>e<=t,">=":(e,t)=>t<=e};function l(e){if(e.match(/^self::\*$/))return e=>!0;if(e.match(/^self::\w+$/)){const t=e.slice(6).toUpperCase();return e=>e.tagName&&g.tagName(e)===t}if(e.match(/^self::\w+:\w+$/)){const n=e.split(":"),r=b.resolveNameSpace(n[2]);if(!r)return null;const g=n[3].toUpperCase();return e=>e.localName&&e.localName.toUpperCase()===g&&e.namespaceURI===r}if(e.match(/^@\w+$/)){const i=e.slice(1);return e=>e.hasAttribute&&e.hasAttribute(i)}if(e.match(/^@\w+="[\w\d ]+"$/)){const o=e.split("="),s=o[0].slice(1),g=o[1].slice(1,-1);return e=>e.hasAttribute&&e.hasAttribute(s)&&e.getAttribute(s)===g}if(e.match(/^@\w+!="[\w\d ]+"$/)){const a=e.split("!="),l=a[0].slice(1),g=a[1].slice(1,-1);return e=>!e.hasAttribute||!e.hasAttribute(l)||e.getAttribute(l)!==g}if(e.match(/^contains\(\s*@grammar\s*,\s*"[\w\d ]+"\s*\)$/)){const c=e.split('"')[1];return e=>!!y.Grammar.getInstance().getParameter(c)}if(e.match(/^not\(\s*contains\(\s*@grammar\s*,\s*"[\w\d ]+"\s*\)\s*\)$/)){const u=e.split('"')[1];return e=>!y.Grammar.getInstance().getParameter(u)}if(e.match(/^name\(\.\.\/\.\.\)="\w+"$/)){const d=e.split('"')[1].toUpperCase();return e=>{var t;return(null==(t=null==(t=e.parentNode)?void 0:t.parentNode)?void 0:t.tagName)&&g.tagName(e.parentNode.parentNode)===d}}if(e.match(/^count\(preceding-sibling::\*\)=\d+$/)){const p=e.split("="),h=parseInt(p[1],10);return e=>{var t;return(null==(t=e.parentNode)?void 0:t.childNodes[h])===e}}if(e.match(/^.+\[@category!?=".+"\]$/)){let[,n,r,i]=e.match(/^(.+)\[@category(!?=)"(.+)"\]$/);const y=i.match(/^unit:(.+)$/);let o="";return y&&(i=y[1],o=":unit"),e=>{var t=b.evalXPath(n,e)[0];if(t){const e=S.lookupCategory(t.textContent+o);return"="===r?e===i:e!==i}return!1}}if(e.match(/^string-length\(.+\)\W+\d+/)){const[,f,m,g]=e.match(/^string-length\((.+)\)(\W+)(\d+)/),y=E[m]||E["="],S=parseInt(g,10);return e=>{e=b.evalXPath(f,e)[0];return!!e&&y(Array.from(e.textContent).length,S)}}return null}t.constraintTest_=l;class c extends i.StaticTrieNode{constructor(e,t){super(e,l(e)),this.context=t,this.kind=o.TrieNodeKind.QUERY}applyTest(e){return this.test?this.test(e):this.context.applyQuery(e,this.constraint)===e}}t.QueryTrieNode=c;class u extends i.StaticTrieNode{constructor(e,t){super(e,l(e)),this.context=t,this.kind=o.TrieNodeKind.BOOLEAN}applyTest(e){return this.test?this.test(e):this.context.applyConstraint(e,this.constraint)}}t.BooleanTrieNode=u},2371:function(e,o,t){Object.defineProperty(o,"__esModule",{value:!0}),o.completeLocale=o.getLocale=o.setLocale=o.locales=void 0;const s=t(4886),n=t(4513),a=t(1058),r=t(8597),i=t(9883),l=t(2523),c=t(3938),u=t(9139),d=t(1547),p=t(346),h=t(13),f=t(6238),m=t(2913),g=t(3305),b=t(9770),y=t(4524);function S(){var e=n.Variables.ensureLocale(s.default.getInstance().locale,s.default.getInstance().defaultLocale);return s.default.getInstance().locale=e,o.locales[e]()}o.locales={ca:r.ca,da:i.da,de:l.de,en:c.en,es:u.es,fr:d.fr,hi:p.hi,it:h.it,nb:f.nb,nn:g.nn,sv:b.sv,nemeth:m.nemeth},o.setLocale=function(){var e,t,n=S();if(e=n,t=s.default.getInstance().subiso,-1===e.SUBISO.all.indexOf(t)&&(s.default.getInstance().subiso=e.SUBISO.default),e.SUBISO.current=s.default.getInstance().subiso,n){for(const o of Object.getOwnPropertyNames(n))y.LOCALE[o]=n[o];for(var[r,i]of Object.entries(n.CORRECTIONS))a.Grammar.getInstance().setCorrection(r,i)}},o.getLocale=S,o.completeLocale=function(e){const t=o.locales[e.locale];if(t){var n=e.kind.toUpperCase(),r=e.messages;if(r){const i=t();for(const[e,o]of Object.entries(r))i[n][e]=o}}else console.error("Locale "+e.locale+" does not exist!")}},4524:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createLocale=t.LOCALE=void 0;const r=n(4277);function i(){return{FUNCTIONS:(0,r.FUNCTIONS)(),MESSAGES:(0,r.MESSAGES)(),ALPHABETS:(0,r.ALPHABETS)(),NUMBERS:(0,r.NUMBERS)(),COMBINERS:{},CORRECTIONS:{},SUBISO:(0,r.SUBISO)()}}t.LOCALE=i(),t.createLocale=i},3319:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.localeFontCombiner=t.extractString=t.localEnclose=t.localRole=t.localFont=t.combinePostfixIndex=t.nestingToString=void 0;const r=n(4524),i=n(9385);function o(e,t){return void 0===e?t:"string"==typeof e?e:e[0]}t.nestingToString=function(e){switch(e){case 1:return r.LOCALE.MESSAGES.MS.ONCE||"";case 2:return r.LOCALE.MESSAGES.MS.TWICE;default:return e.toString()}},t.combinePostfixIndex=function(e,t){return e===r.LOCALE.MESSAGES.MS.ROOTINDEX||e===r.LOCALE.MESSAGES.MS.INDEX?e:e+" "+t},t.localFont=function(e){return o(r.LOCALE.MESSAGES.font[e],e)},t.localRole=function(e){return o(r.LOCALE.MESSAGES.role[e],e)},t.localEnclose=function(e){return o(r.LOCALE.MESSAGES.enclose[e],e)},t.extractString=o,t.localeFontCombiner=function(e){return"string"==typeof e?{font:e,combiner:r.LOCALE.ALPHABETS.combiner}:{font:e[0],combiner:r.LOCALE.COMBINERS[e[1]]||i.Combiners[e[1]]||r.LOCALE.ALPHABETS.combiner}}},8597:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ca=void 0;function r(e,t,n){return e="sans serif "+(n?n+" "+e:e),t?e+" "+t:e}const i=n(4524),o=n(3319),s=n(165),a=n(9385);let l=null;t.ca=function(){return l=l||function(){const e=(0,i.createLocale)();return e.NUMBERS=s.default,e.COMBINERS.sansserif=r,e.FUNCTIONS.fracNestDepth=e=>!1,e.FUNCTIONS.combineRootIndex=o.combinePostfixIndex,e.FUNCTIONS.combineNestedRadical=(e,t,n)=>e+n,e.FUNCTIONS.fontRegexp=e=>RegExp("^"+e+" "),e.FUNCTIONS.plural=e=>/.*os$/.test(e)?e+"sos":/.*s$/.test(e)?e+"os":/.*ga$/.test(e)?e.slice(0,-2)+"gues":/.*\xe7a$/.test(e)?e.slice(0,-2)+"ces":/.*ca$/.test(e)?e.slice(0,-2)+"ques":/.*ja$/.test(e)?e.slice(0,-2)+"ges":/.*qua$/.test(e)?e.slice(0,-3)+"qües":/.*a$/.test(e)?e.slice(0,-1)+"es":/.*(e|i)$/.test(e)?e+"ns":/.*\xed$/.test(e)?e.slice(0,-1)+"ins":e+"s",e.FUNCTIONS.si=(e,t)=>(e=t.match(/^metre/)?e.replace(/a$/,"à").replace(/o$/,"ò").replace(/i$/,"í"):e)+t,e.ALPHABETS.combiner=a.Combiners.prefixCombiner,e}()}},9883:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.da=void 0;const r=n(4524),i=n(3319),o=n(5571),s=n(9385);let a=null;t.da=function(){return a=a||function(){const t=(0,r.createLocale)();return t.NUMBERS=o.default,t.FUNCTIONS.radicalNestDepth=i.nestingToString,t.FUNCTIONS.fontRegexp=e=>e===t.ALPHABETS.capPrefix.default?RegExp("^"+e+" "):RegExp(" "+e+"$"),t.ALPHABETS.combiner=s.Combiners.postfixCombiner,t.ALPHABETS.digitTrans.default=o.default.numberToWords,t}()}},2523:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.de=void 0;function r(e,t,n){return"s"===n&&(t=t.split(" ").map(function(e){return e.replace(/s$/,"")}).join(" "),n=""),e=n?n+" "+e:e,t?t+" "+e:e}function i(e,t,n){return e=n&&"s"!==n?n+" "+e:e,t?e+" "+t:e}const o=n(1058),s=n(3319),a=n(4524),l=n(757);let c=null;t.de=function(){return c=c||function(){const t=(0,a.createLocale)();return t.NUMBERS=l.default,t.COMBINERS.germanPostfix=i,t.ALPHABETS.combiner=r,t.FUNCTIONS.radicalNestDepth=e=>1<e?t.NUMBERS.numberToWords(e)+"fach":"",t.FUNCTIONS.combineRootIndex=(e,t)=>{return e.replace("Wurzel",t?t+"wurzel":"")},t.FUNCTIONS.combineNestedRadical=(e,t,n)=>{t=(t?t+" ":"")+(e=n.match(/exponent$/)?e+"r":e);return n.match(/ /)?n.replace(/ /," "+t+" "):t+" "+n},t.FUNCTIONS.fontRegexp=function(e){return e=e.split(" ").map(function(e){return e.replace(/s$/,"(|s)")}).join(" "),new RegExp("((^"+e+" )|( "+e+"$))")},t.CORRECTIONS.correctOne=e=>e.replace(/^eins$/,"ein"),t.CORRECTIONS.localFontNumber=e=>(0,s.localFont)(e).split(" ").map(function(e){return e.replace(/s$/,"")}).join(" "),t.CORRECTIONS.lowercase=e=>e.toLowerCase(),t.CORRECTIONS.article=e=>{var t=o.Grammar.getInstance().getParameter("case"),n=o.Grammar.getInstance().getParameter("plural");return"dative"===t?{der:"dem",die:n?"den":"der",das:"dem"}[e]:e},t.CORRECTIONS.masculine=e=>"dative"===o.Grammar.getInstance().getParameter("case")?e+"n":e,t}()}},3938:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.en=void 0;const r=n(1058),i=n(4524),o=n(3319),s=n(166),a=n(9385);let l=null;t.en=function(){return l=l||function(){const e=(0,i.createLocale)();return e.NUMBERS=s.default,e.FUNCTIONS.radicalNestDepth=o.nestingToString,e.FUNCTIONS.plural=e=>/.*s$/.test(e)?e:e+"s",e.ALPHABETS.combiner=a.Combiners.prefixCombiner,e.ALPHABETS.digitTrans.default=s.default.numberToWords,e.CORRECTIONS.article=e=>r.Grammar.getInstance().getParameter("noArticle")?"":e,e}()}},9139:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.es=void 0;function r(e,t,n){return e="sans serif "+(n?n+" "+e:e),t?e+" "+t:e}const i=n(4524),o=n(3319),s=n(6154),a=n(9385);let l=null;t.es=function(){return l=l||function(){const e=(0,i.createLocale)();return e.NUMBERS=s.default,e.COMBINERS.sansserif=r,e.FUNCTIONS.fracNestDepth=e=>!1,e.FUNCTIONS.combineRootIndex=o.combinePostfixIndex,e.FUNCTIONS.combineNestedRadical=(e,t,n)=>e+n,e.FUNCTIONS.fontRegexp=e=>RegExp("^"+e+" "),e.FUNCTIONS.plural=e=>/.*(a|e|i|o|u)$/.test(e)?e+"s":/.*z$/.test(e)?e.slice(0,-1)+"ces":/.*c$/.test(e)?e.slice(0,-1)+"ques":/.*g$/.test(e)?e+"ues":/.*\u00f3n$/.test(e)?e.slice(0,-2)+"ones":e+"es",e.FUNCTIONS.si=(e,t)=>(e=t.match(/^metro/)?e.replace(/a$/,"á").replace(/o$/,"ó").replace(/i$/,"í"):e)+t,e.ALPHABETS.combiner=a.Combiners.prefixCombiner,e}()}},1547:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.fr=void 0;const r=n(1058),i=n(4524),o=n(3319),s=n(4394),a=n(9385);let l=null;t.fr=function(){return l=l||function(){const e=(0,i.createLocale)();return e.NUMBERS=s.default,e.FUNCTIONS.radicalNestDepth=o.nestingToString,e.FUNCTIONS.combineRootIndex=o.combinePostfixIndex,e.FUNCTIONS.combineNestedFraction=(e,t,n)=>n.replace(/ $/g,"")+t+e,e.FUNCTIONS.combineNestedRadical=(e,t,n)=>n+" "+e,e.FUNCTIONS.fontRegexp=e=>RegExp(" (en |)"+e+"$"),e.FUNCTIONS.plural=e=>/.*s$/.test(e)?e:e+"s",e.CORRECTIONS.article=e=>r.Grammar.getInstance().getParameter("noArticle")?"":e,e.ALPHABETS.combiner=a.Combiners.romanceCombiner,e.SUBISO={default:"fr",current:"fr",all:["fr","be","ch"]},e}()}},346:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.hi=void 0;const r=n(4524),i=n(1779),o=n(9385),s=n(3319);let a=null;t.hi=function(){return a=a||function(){const e=(0,r.createLocale)();return e.NUMBERS=i.default,e.ALPHABETS.combiner=o.Combiners.prefixCombiner,e.FUNCTIONS.radicalNestDepth=s.nestingToString,e}()}},13:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.it=void 0;function r(e,t,n){return e.match(/^[a-zA-Z]$/)&&(t=t.replace("cerchiato","cerchiata")),e=n?e+" "+n:e,t?e+" "+t:e}const i=n(3319),o=n(4524),s=n(5952),a=n(9385);let l=null;t.it=function(){return l=l||function(){const e=(0,o.createLocale)();return e.NUMBERS=s.default,e.COMBINERS.italianPostfix=r,e.FUNCTIONS.radicalNestDepth=i.nestingToString,e.FUNCTIONS.combineRootIndex=i.combinePostfixIndex,e.FUNCTIONS.combineNestedFraction=(e,t,n)=>n.replace(/ $/g,"")+t+e,e.FUNCTIONS.combineNestedRadical=(e,t,n)=>n+" "+e,e.FUNCTIONS.fontRegexp=e=>RegExp(" (en |)"+e+"$"),e.ALPHABETS.combiner=a.Combiners.romanceCombiner,e}()}},6238:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.nb=void 0;const r=n(4524),i=n(3319),o=n(984),s=n(9385);let a=null;t.nb=function(){return a=a||function(){const e=(0,r.createLocale)();return e.NUMBERS=o.default,e.ALPHABETS.combiner=s.Combiners.prefixCombiner,e.ALPHABETS.digitTrans.default=o.default.numberToWords,e.FUNCTIONS.radicalNestDepth=i.nestingToString,e}()}},2913:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.nemeth=void 0;function r(e){return e.match(RegExp("^"+p.ALPHABETS.languagePrefix.english))?e.slice(1):e}function i(e,t,n){return e=r(e),t?e+t:e}function o(e,t,n){return t+r(e)}function s(e,t,n){return t+(n||"")+r(e)+"⠻"}function a(e,t,n){return t+(n||"")+r(e)+"⠻⠻"}function l(e,t,n){return t+r(e)+"⠾"}const c=n(4524),u=n(3669),d=n(9385);let p=null;t.nemeth=function(){return p=p||function(){const e=(0,c.createLocale)();return e.NUMBERS=u.default,e.COMBINERS={postfixCombiner:i,germanCombiner:o,embellishCombiner:s,doubleEmbellishCombiner:a,parensCombiner:l},e.FUNCTIONS.fracNestDepth=e=>!1,e.FUNCTIONS.fontRegexp=e=>RegExp("^"+e),e.FUNCTIONS.si=d.identityTransformer,e.ALPHABETS.combiner=(e,t,n)=>t?t+n+e:r(e),e.ALPHABETS.digitTrans={default:u.default.numberToWords},e}()}},3305:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.nn=void 0;const r=n(4524),i=n(3319),o=n(984),s=n(9385);let a=null;t.nn=function(){return a=a||function(){const e=(0,r.createLocale)();return e.NUMBERS=o.default,e.ALPHABETS.combiner=s.Combiners.prefixCombiner,e.ALPHABETS.digitTrans.default=o.default.numberToWords,e.FUNCTIONS.radicalNestDepth=i.nestingToString,e.SUBISO={default:"",current:"",all:["","alt"]},e}()}},9770:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.sv=void 0;const r=n(4524),i=n(3319),o=n(6416),s=n(9385);let a=null;t.sv=function(){return a=a||function(){const e=(0,r.createLocale)();return e.NUMBERS=o.default,e.FUNCTIONS.radicalNestDepth=i.nestingToString,e.FUNCTIONS.fontRegexp=function(e){return new RegExp("((^"+e+" )|( "+e+"$))")},e.ALPHABETS.combiner=s.Combiners.prefixCombiner,e.ALPHABETS.digitTrans.default=o.default.numberToWords,e.CORRECTIONS.correctOne=e=>e.replace(/^ett$/,"en"),e}()}},4277:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SUBISO=t.FUNCTIONS=t.ALPHABETS=t.NUMBERS=t.MESSAGES=void 0;const r=n(9385);t.MESSAGES=function(){return{MS:{},MSroots:{},font:{},embellish:{},role:{},enclose:{},navigate:{},regexp:{},unitTimes:""}},t.NUMBERS=function(){return{zero:"zero",ones:[],tens:[],large:[],special:{},wordOrdinal:r.identityTransformer,numericOrdinal:r.identityTransformer,numberToWords:r.identityTransformer,numberToOrdinal:r.pluralCase,vulgarSep:" ",numSep:" "}},t.ALPHABETS=function(){return{latinSmall:[],latinCap:[],greekSmall:[],greekCap:[],capPrefix:{default:""},smallPrefix:{default:""},digitPrefix:{default:""},languagePrefix:{},digitTrans:{default:r.identityTransformer,mathspeak:r.identityTransformer,clearspeak:r.identityTransformer},letterTrans:{default:r.identityTransformer},combiner:(e,t,n)=>e}},t.FUNCTIONS=function(){return{fracNestDepth:e=>r.vulgarFractionSmall(e,10,100),radicalNestDepth:e=>"",combineRootIndex:function(e,t){return e},combineNestedFraction:r.Combiners.identityCombiner,combineNestedRadical:r.Combiners.identityCombiner,fontRegexp:function(e){return new RegExp("^"+e.split(/ |-/).join("( |-)")+"( |-)")},si:r.siCombiner,plural:r.identityTransformer}},t.SUBISO=function(){return{default:"",current:"",all:[]}}},165:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(1058);function i(e){const r=e%1e3,t=Math.floor(r/100),n=t?1===t?"cent":a.ones[t]+"-cents":"",i=function(){var e=r%100%100;if(e<20)return a.ones[e];var t=Math.floor(e/10),n=a.tens[t],e=a.ones[e%10];return n&&e?n+(2===t?"-i-":"-")+e:n||e}();return n&&i?n+a.numSep+i:n||i}function o(e){if(0===e)return a.zero;if(e>=Math.pow(10,36))return e.toString();let t=0,n="";for(;0<e;){var r=e%(1<t?1e6:1e3);if(r){let e=a.large[t];if(t)if(1===t)n=(1==r?"":i(r)+a.numSep)+e+(n?a.numSep+n:"");else{const t=o(r);e=1==r?e:e.replace(/\u00f3$/,"ons"),n=t+a.numSep+e+(n?a.numSep+n:"")}else n=i(r)}e=Math.floor(e/(1<t?1e6:1e3)),t++}return n}function s(e){var t=r.Grammar.getInstance().getParameter("gender");return e.toString()+("f"===t?"a":"n")}const a=(0,n(4277).NUMBERS)();a.numericOrdinal=s,a.numberToWords=o,a.numberToOrdinal=function(e,t){if(1999<e)return s(e);if(e<=10)return a.special.onesOrdinals[e-1];const n=o(e);return n.match(/mil$/)?n.replace(/mil$/,"mil·lèsima"):n.match(/u$/)?n.replace(/u$/,"vena"):n.match(/a$/)?n.replace(/a$/,"ena"):n+(n.match(/e$/)?"na":"ena")},t.default=a},5571:function(e,t,n){function o(e,t=!1){return e===a.ones[1]?t?"et":"en":e}function s(e,t=!1){let n=e%1e3,r="",i=a.ones[Math.floor(n/100)];if(r+=i?o(i,!0)+" hundrede":"",n%=100)if(r+=r?" og ":"",i=(t?a.special.smallOrdinals:a.ones)[n])r+=i;else{const e=(t?a.special.tensOrdinals:a.tens)[Math.floor(n/10)];i=a.ones[n%10],r+=i?o(i)+"og"+e:e}return r}function r(e,t=!1){if(0===e)return a.zero;if(e>=Math.pow(10,36))return e.toString();let n=0,r="";for(;0<e;){var i=e%1e3;if(i){const e=s(i,t&&!n);if(n){const t=a.large[n],s=1<i?"er":"";r=o(e,n<=1)+" "+t+s+(r?" og ":"")+r}else r=o(e)+r}e=Math.floor(e/1e3),n++}return r}function i(e){if(e%100)return r(e,!0);const t=r(e);return t.match(/e$/)?t:t+"e"}Object.defineProperty(t,"__esModule",{value:!0});const a=(0,n(4277).NUMBERS)();a.wordOrdinal=i,a.numericOrdinal=function(e){return e.toString()+"."},a.numberToWords=r,a.numberToOrdinal=function(e,t){return 1===e?t?"hel":"hele":2===e?t?"halv":"halve":i(e)+(t?"dele":"del")},t.default=a},757:function(e,t,n){function o(e,t=!1){return e===a.ones[1]?t?"eine":"ein":e}function s(e){let t=e%1e3,n="",r=a.ones[Math.floor(t/100)];if(n+=r?o(r)+"hundert":"",t%=100)if(n+=n?a.numSep:"",r=a.ones[t])n+=r;else{const e=a.tens[Math.floor(t/10)];r=a.ones[t%10],n+=r?o(r)+"und"+e:e}return n}function r(e){if(0===e)return a.zero;if(e>=Math.pow(10,36))return e.toString();let t=0,n="";for(;0<e;){var r=e%1e3;if(r){var i=s(e%1e3);if(t){const e=a.large[t],s=1<t&&1<r?e.match(/e$/)?"n":"en":"";n=o(i,1<t)+e+s+n}else n=o(i,1<t)+n}e=Math.floor(e/1e3),t++}return n.replace(/ein$/,"eins")}function i(e){return 1===e?"erste":3===e?"dritte":7===e?"siebte":8===e?"achte":r(e)+(e<19?"te":"ste")}Object.defineProperty(t,"__esModule",{value:!0});const a=(0,n(4277).NUMBERS)();a.wordOrdinal=i,a.numericOrdinal=function(e){return e.toString()+"."},a.numberToWords=r,a.numberToOrdinal=function(e,t){return 1===e?"eintel":2===e?t?"halbe":"halb":i(e)+"l"},t.default=a},166:function(e,t,n){function r(e){if(0===e)return o.zero;if(e>=Math.pow(10,36))return e.toString();let t=0,n="";for(;0<e;)e%1e3&&(n=function(e){let t=e%1e3,n="";return n+=o.ones[Math.floor(t/100)]?o.ones[Math.floor(t/100)]+o.numSep+"hundred":"",n=(t%=100)?(n+=n?o.numSep:"")+(o.ones[t]||o.tens[Math.floor(t/10)]+(t%10?o.numSep+o.ones[t%10]:"")):n}(e%1e3)+(t?"-"+o.large[t]+"-":"")+n),e=Math.floor(e/1e3),t++;return n.replace(/-$/,"")}function i(e){let t=r(e);return t.match(/one$/)?t=t.slice(0,-3)+"first":t.match(/two$/)?t=t.slice(0,-3)+"second":t.match(/three$/)?t=t.slice(0,-5)+"third":t.match(/five$/)?t=t.slice(0,-4)+"fifth":t.match(/eight$/)?t=t.slice(0,-5)+"eighth":t.match(/nine$/)?t=t.slice(0,-4)+"ninth":t.match(/twelve$/)?t=t.slice(0,-6)+"twelfth":t.match(/ty$/)?t=t.slice(0,-2)+"tieth":t+="th",t}Object.defineProperty(t,"__esModule",{value:!0});const o=(0,n(4277).NUMBERS)();o.wordOrdinal=i,o.numericOrdinal=function(e){var t=e%100,n=e.toString();if(10<t&&t<20)return n+"th";switch(e%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd";default:return n+"th"}},o.numberToWords=r,o.numberToOrdinal=function(e,t){if(1===e)return t?"oneths":"oneth";if(2===e)return t?"halves":"half";e=i(e);return t?e+"s":e},t.default=o},6154:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(1058);function o(e){const n=e%1e3,t=Math.floor(n/100),r=s.special.hundreds[t],i=function(){var e=n%100%100;if(e<30)return s.ones[e];var t=s.tens[Math.floor(e/10)],e=s.ones[e%10];return t&&e?t+" y "+e:t||e}();return 1===t?i?r+"to "+i:r:r&&i?r+" "+i:r||i}const s=(0,n(4277).NUMBERS)();s.numericOrdinal=function(e){var t=r.Grammar.getInstance().getParameter("gender");return e.toString()+("f"===t?"a":"o")},s.numberToWords=function(e){if(0===e)return s.zero;if(e>=Math.pow(10,36))return e.toString();let t=0,n="";for(;0<e;){var r=e%1e3;if(r){let e=s.large[t];var i=o(r);n=t?1==r?(e=e.match("/^mil( |$)/")?e:"un "+e)+(n?" "+n:""):(e=e.replace(/\u00f3n$/,"ones"),o(r)+" "+e+(n?" "+n:"")):i}e=Math.floor(e/1e3),t++}return n},s.numberToOrdinal=function(e,t){if(1999<e)return e.toString()+"a";if(e<=12)return s.special.onesOrdinals[e-1];const n=[];if(1e3<=e&&(e-=1e3,n.push("milésima")),!e)return n.join(" ");let r=0;return 0<(r=Math.floor(e/100))&&(n.push(s.special.hundredsOrdinals[r-1]),e%=100),e<=12?n.push(s.special.onesOrdinals[e-1]):(0<(r=Math.floor(e/10))&&(n.push(s.special.tensOrdinals[r-1]),e%=10),0<e&&n.push(s.special.onesOrdinals[e-1])),n.join(" ")},t.default=s},4394:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const i=n(4886),r=n(1058),o=n(4277);function s(e){if(0===e)return c.zero;if(e>=Math.pow(10,36))return e.toString();c.special["tens-"+i.default.getInstance().subiso]&&(c.tens=c.special["tens-"+i.default.getInstance().subiso]);let t=0,n="";for(;0<e;){const i=e%1e3;if(i){let e=c.large[t];var r=function(e){let t=e%1e3,n="";if(n+=c.ones[Math.floor(t/100)]?c.ones[Math.floor(t/100)]+"-cent":"",t%=100){n+=n?"-":"";let e=c.ones[t];if(e)n+=e;else{const r=c.tens[Math.floor(t/10)];r.match(/-dix$/)?(e=c.ones[t%10+10],n+=r.replace(/-dix$/,"")+"-"+e):n+=r+(t%10?"-"+c.ones[t%10]:"")}}const r=n.match(/s-\w+$/);return r?n.replace(/s-\w+$/,r[0].slice(1)):n.replace(/-un$/,"-et-un")}(i);if(e&&e.match(/^mille /)){const i=e.replace(/^mille /,"");n=n.match(RegExp(i))?r+(t?"-mille-":"")+n:n.match(RegExp(i.replace(/s$/,"")))?r+(t?"-mille-":"")+n.replace(i.replace(/s$/,""),i):r+(t?"-"+e+"-":"")+n}else e=1==i&&e?e.replace(/s$/,""):e,n=r+(t?"-"+e+"-":"")+n}e=Math.floor(e/1e3),t++}return n.replace(/-$/,"")}const a={1:"unième",2:"demi",3:"tiers",4:"quart"};function l(e){if(1===e)return"première";let t=s(e);return t.match(/^neuf$/)?t=t.slice(0,-1)+"v":t.match(/cinq$/)?t+="u":t.match(/trois$/)?t+="":(t.match(/e$/)||t.match(/s$/))&&(t=t.slice(0,-1)),t+="ième"}const c=(0,o.NUMBERS)();c.wordOrdinal=l,c.numericOrdinal=function(e){var t=r.Grammar.getInstance().getParameter("gender");return 1===e?e.toString()+("m"===t?"er":"re"):e.toString()+"e"},c.numberToWords=s,c.numberToOrdinal=function(e,t){var n=a[e]||l(e);return 3!==e&&t?n+"s":n},t.default=c},1779:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(1058);function i(n){if(0===n)return s.zero;if(n>=Math.pow(10,32))return n.toString();let e=0,t="";const r=function(){let e=n%1e3%1e3,t="";return t+=s.ones[Math.floor(e/100)]?s.ones[Math.floor(e/100)]+s.numSep+s.special.hundred:"",t=(e%=100)?(t+=t?s.numSep:"")+s.ones[e]:t}();if(!(n=Math.floor(n/1e3)))return r;for(;0<n;){const r=n%100;r&&(t=s.ones[r]+s.numSep+s.large[e]+(t?s.numSep+t:"")),n=Math.floor(n/100),e++}return r?t+s.numSep+r:t}function o(e){var t=r.Grammar.getInstance().getParameter("gender");return e<=0?e.toString():e<10?("f"===t?s.special.ordinalsFeminine:s.special.ordinalsMasculine)[e]:i(e)+("f"===t?"वीं":"वाँ")}const s=(0,n(4277).NUMBERS)();s.wordOrdinal=o,s.numericOrdinal=function(e){var t=r.Grammar.getInstance().getParameter("gender");return 0<e&&e<10?("f"===t?s.special.simpleSmallOrdinalsFeminine:s.special.simpleSmallOrdinalsMasculine)[e]:e.toString().split("").map(function(e){e=parseInt(e,10);return isNaN(e)?"":s.special.simpleNumbers[e]}).join("")+("f"===t?"वीं":"वाँ")},s.numberToWords=i,s.numberToOrdinal=function(e,t){return e<=10?s.special.smallDenominators[e]:o(e)+" अंश"},t.default=s},5952:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(1058);function i(e){if(0===e)return s.zero;if(e>=Math.pow(10,36))return e.toString();if(1===e&&r.Grammar.getInstance().getParameter("fraction"))return"un";let t=0,n="";for(;0<e;)e%1e3&&(n=function(e){let t=e%1e3,n="";if(n+=s.ones[Math.floor(t/100)]?s.ones[Math.floor(t/100)]+s.numSep+"cento":"",t%=100){n+=n?s.numSep:"";const e=s.ones[t];if(e)n+=e;else{let e=s.tens[Math.floor(t/10)];var r=t%10;1!=r&&8!=r||(e=e.slice(0,-1)),n=(n+=e)+(r?s.numSep+s.ones[t%10]:"")}}return n}(e%1e3)+(t?"-"+s.large[t]+"-":"")+n),e=Math.floor(e/1e3),t++;return n.replace(/-$/,"")}function o(e){var t="m"===r.Grammar.getInstance().getParameter("gender")?"o":"a";let n=s.special.onesOrdinals[e];return n?n.slice(0,-1)+t:(n=i(e)).slice(0,-1)+"esim"+t}const s=(0,n(4277).NUMBERS)();s.wordOrdinal=o,s.numericOrdinal=function(e){var t=r.Grammar.getInstance().getParameter("gender");return e.toString()+("m"===t?"o":"a")},s.numberToWords=i,s.numberToOrdinal=function(e,t){if(2===e)return t?"mezzi":"mezzo";const n=o(e);if(!t)return n;e=n.match(/o$/)?"i":"e";return n.slice(0,-1)+e},t.default=s},3669:function(e,t,n){function r(e){return e.toString().split("").map(function(e){return i.ones[parseInt(e,10)]}).join("")}Object.defineProperty(t,"__esModule",{value:!0});const i=(0,n(4277).NUMBERS)();i.numberToWords=r,i.numberToOrdinal=r,t.default=i},984:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const r=n(4886);function s(e){var t=a.special.endOrdinal[0];return"a"===t&&e.match(/en$/)?e.slice(0,-2)+a.special.endOrdinal:e.match(/(d|n)$/)||e.match(/hundre$/)?e+"de":e.match(/i$/)?e+a.special.endOrdinal:"a"===t&&e.match(/e$/)?e.slice(0,-1)+a.special.endOrdinal:(e.match(/e$/),e+"nde")}function i(e){return o(e,!0)}const a=(0,n(4277).NUMBERS)();function l(e,t=!1){return e===a.ones[1]?"ein"===e?"eitt ":t?"et":"ett":e}function o(e,t=!1){return("alt"===r.default.getInstance().subiso?function(e,t=!1){if(0===e)return t?a.special.smallOrdinals[0]:a.zero;if(e>=Math.pow(10,36))return e.toString();let n=0,r="";for(;0<e;){var i,o=e%1e3;o&&(i=function(e,t=!1){let n=e%1e3,r="",i=a.ones[Math.floor(n/100)];if(r+=i?l(i)+"hundre":"",n%=100){if(r+=r?"og":"",t){const e=a.special.smallOrdinals[n];if(e)return r+e}if(i=a.ones[n])r+=i;else{const e=a.tens[Math.floor(n/10)];i=a.ones[n%10],r+=i?i+"og"+e:e}}return t?s(r):r}(e%1e3,!n&&t),!n&&t&&(t=!t),r=(1===n?l(i,!0):i)+(1<n?a.numSep:"")+(n?a.large[n]+(1<n&&1<o?"er":""):"")+(1<n&&r?a.numSep:"")+r),e=Math.floor(e/1e3),n++}return t?r+(r.match(/tusen$/)?"de":"te"):r}:function(e,t=!1){if(0===e)return t?a.special.smallOrdinals[0]:a.zero;if(e>=Math.pow(10,36))return e.toString();let n=0,r="";for(;0<e;){var i,o=e%1e3;o&&(i=function(e,t=!1){let n=e%1e3,r="";var e=Math.floor(n/100),i=a.ones[e];if(r+=i?(1===e?"":i)+"hundre":"",n%=100){if(r+=r?"og":"",t){const e=a.special.smallOrdinals[n];if(e)return r+e;if(n%10)return r+a.tens[Math.floor(n/10)]+a.special.smallOrdinals[n%10]}r+=a.ones[n]||a.tens[Math.floor(n/10)]+(n%10?a.ones[n%10]:"")}return t?s(r):r}(e%1e3,!n&&t),!n&&t&&(t=!t),r=i+(n?" "+a.large[n]+(1<n&&1<o?"er":"")+(r?" ":""):"")+r),e=Math.floor(e/1e3),n++}return t?r+(r.match(/tusen$/)?"de":"te"):r})(e,t)}a.wordOrdinal=i,a.numericOrdinal=function(e){return e.toString()+"."},a.numberToWords=o,a.numberToOrdinal=function(e,t){return i(e)},t.default=a},6416:function(e,t,n){function r(e,t=!1){if(0===e)return a.zero;if(e>=Math.pow(10,36))return e.toString();let n=0,r="";for(;0<e;){var i,o,s=e%1e3;s&&(i=a.large[n],o=1<s&&1<n&&!t?"er":"",r=(1===n&&1==s?"":(1<n&&1==s?"en":function(e){let t=e%1e3,n="";return e=Math.floor(t/100),n+=a.ones[e]?(1===e?"":a.ones[e]+a.numSep)+"hundra":"",n=(t%=100)?(n+=n?a.numSep:"")+(a.ones[t]||a.tens[Math.floor(t/10)]+(t%10?a.numSep+a.ones[t%10]:"")):n}(e%1e3))+(1<n?" ":""))+(n?i+o+(1<n?" ":""):"")+r),e=Math.floor(e/1e3),n++}return r.replace(/ $/,"")}function i(e){let t=r(e,!0);return t.match(/^noll$/)?t="nollte":t.match(/ett$/)?t=t.replace(/ett$/,"första"):t.match(/tv\xe5$/)?t=t.replace(/tv\xe5$/,"andra"):t.match(/tre$/)?t=t.replace(/tre$/,"tredje"):t.match(/fyra$/)?t=t.replace(/fyra$/,"fjärde"):t.match(/fem$/)?t=t.replace(/fem$/,"femte"):t.match(/sex$/)?t=t.replace(/sex$/,"sjätte"):t.match(/sju$/)?t=t.replace(/sju$/,"sjunde"):t.match(/\xe5tta$/)?t=t.replace(/\xe5tta$/,"åttonde"):t.match(/nio$/)?t=t.replace(/nio$/,"nionde"):t.match(/tio$/)?t=t.replace(/tio$/,"tionde"):t.match(/elva$/)?t=t.replace(/elva$/,"elfte"):t.match(/tolv$/)?t=t.replace(/tolv$/,"tolfte"):t.match(/tusen$/)?t=t.replace(/tusen$/,"tusonde"):t.match(/jard$/)||t.match(/jon$/)?t+="te":t+="de",t}Object.defineProperty(t,"__esModule",{value:!0});const a=(0,n(4277).NUMBERS)();a.wordOrdinal=i,a.numericOrdinal=function(e){const t=e.toString();return t.match(/11$|12$/)?t+":e":t+(t.match(/1$|2$/)?":a":":e")},a.numberToWords=r,a.numberToOrdinal=function(e,t){if(1===e)return"hel";if(2===e)return t?"halva":"halv";let n=i(e);return(n=n.match(/de$/)?n.replace(/de$/,""):n)+(t?"delar":"del")},t.default=a},9385:function(e,t){function i(e,t=""){if(!e.childNodes||!e.childNodes[0]||!e.childNodes[0].childNodes||e.childNodes[0].childNodes.length<2||"number"!==e.childNodes[0].childNodes[0].tagName||"integer"!==e.childNodes[0].childNodes[0].getAttribute("role")||"number"!==e.childNodes[0].childNodes[1].tagName||"integer"!==e.childNodes[0].childNodes[1].getAttribute("role"))return{convertible:!1,content:e.textContent};var n=e.childNodes[0].childNodes[1].textContent,e=e.childNodes[0].childNodes[0].textContent,r=Number(n),i=Number(e);return isNaN(r)||isNaN(i)?{convertible:!1,content:e+` ${t} `+n}:{convertible:!0,enumerator:i,denominator:r}}Object.defineProperty(t,"__esModule",{value:!0}),t.vulgarFractionSmall=t.convertVulgarFraction=t.Combiners=t.siCombiner=t.identityTransformer=t.pluralCase=void 0,t.pluralCase=function(e,t){return e.toString()},t.identityTransformer=function(e){return e.toString()},t.siCombiner=function(e,t){return e+t.toLowerCase()},t.Combiners={},t.Combiners.identityCombiner=function(e,t,n){return e+t+n},t.Combiners.prefixCombiner=function(e,t,n){return e=n?n+" "+e:e,t?t+" "+e:e},t.Combiners.postfixCombiner=function(e,t,n){return e=n?n+" "+e:e,t?e+" "+t:e},t.Combiners.romanceCombiner=function(e,t,n){return e=n?e+" "+n:e,t?e+" "+t:e},t.convertVulgarFraction=i,t.vulgarFractionSmall=function(e,t,n){var r=i(e);if(r.convertible){const e=r.enumerator,i=r.denominator;return 0<e&&e<t&&0<i&&i<n}return!1}},1970:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Condition=t.BaseRuleStore=void 0;const r=n(4148),i=n(8310),l=n(7039),o=n(443);class s{constructor(){this.context=new o.SpeechRuleContext,this.parseOrder=i.DynamicCstr.DEFAULT_ORDER,this.parser=new i.DynamicCstrParser(this.parseOrder),this.locale=i.DynamicCstr.DEFAULT_VALUES[i.Axis.LOCALE],this.modality=i.DynamicCstr.DEFAULT_VALUES[i.Axis.MODALITY],this.domain="",this.initialized=!1,this.inherits=null,this.kind="standard",this.customTranscriptions={},this.preconditions=new Map,this.speechRules_=[],this.rank=0,this.parseMethods={Rule:this.defineRule,Generator:this.generateRules,Action:this.defineAction,Precondition:this.definePrecondition,Ignore:this.ignoreRules}}static compareStaticConstraints_(n,r){if(n.length!==r.length)return!1;for(let e,t=0;e=n[t];t++)if(-1===r.indexOf(e))return!1;return!0}static comparePreconditions_(e,t){e=e.precondition,t=t.precondition;return e.query===t.query&&s.compareStaticConstraints_(e.constraints,t.constraints)}defineRule(e,t,n,r,...i){var o=this.parseAction(n),i=this.parsePrecondition(r,i),s=this.parseCstr(t);if(!(o&&i&&s))return console.error(`Rule Error: ${r}, (${t}): `+n),null;const a=new l.SpeechRule(e,s,i,o);return a.precondition.rank=this.rank++,this.addRule(a),a}addRule(e){e.context=this.context,this.speechRules_.unshift(e)}deleteRule(e){e=this.speechRules_.indexOf(e);-1!==e&&this.speechRules_.splice(e,1)}findRule(n){for(let e,t=0;e=this.speechRules_[t];t++)if(n(e))return e;return null}findAllRules(e){return this.speechRules_.filter(e)}evaluateDefault(e){const t=e.textContent.slice(0);return t.match(/^\s+$/)?this.evaluateWhitespace(t):this.evaluateString(t)}evaluateWhitespace(e){return[]}evaluateCustom(e){e=this.customTranscriptions[e];return void 0!==e?r.AuditoryDescription.create({text:e},{adjust:!0,translate:!1}):null}evaluateCharacter(e){return this.evaluateCustom(e)||r.AuditoryDescription.create({text:e},{adjust:!0,translate:!0})}removeDuplicates(n){for(let e,t=this.speechRules_.length-1;e=this.speechRules_[t];t--)e!==n&&n.dynamicCstr.equal(e.dynamicCstr)&&s.comparePreconditions_(e,n)&&this.speechRules_.splice(t,1)}getSpeechRules(){return this.speechRules_}setSpeechRules(e){this.speechRules_=e}getPreconditions(){return this.preconditions}parseCstr(t){try{return this.parser.parse(this.locale+"."+this.modality+(this.domain?"."+this.domain:"")+"."+t)}catch(e){if("RuleError"===e.name)return console.error("Rule Error ",`Illegal Dynamic Constraint: ${t}.`,e.message),null;throw e}}parsePrecondition(t,n){try{const r=this.parsePrecondition_(t);t=r[0];let e=r.slice(1);for(const t of n)e=e.concat(this.parsePrecondition_(t));return new l.Precondition(t,...e)}catch(e){if("RuleError"===e.name)return console.error("Rule Error ",`Illegal preconditions: ${t}, ${n}.`,e.message),null;throw e}}parseAction(t){try{return l.Action.fromString(t)}catch(e){if("RuleError"===e.name)return console.error("Rule Error ",`Illegal action: ${t}.`,e.message),null;throw e}}parse(e){this.modality=e.modality||this.modality,this.locale=e.locale||this.locale,this.domain=e.domain||this.domain,this.context.parse(e.functions||[]),"actions"!==e.kind&&(this.kind=e.kind||this.kind,this.inheritRules()),this.parseRules(e.rules||[])}parseRules(n){for(let e,t=0;e=n[t];t++){const n=e[0],r=this.parseMethods[n];n&&r&&r.apply(this,e.slice(1))}}generateRules(e){const t=this.context.customGenerators.lookup(e);t&&t(this)}defineAction(n,e){let r;try{r=l.Action.fromString(e)}catch(n){if("RuleError"===n.name)return void console.error("Action Error ",e,n.message);throw n}const t=this.getFullPreconditions(n);if(t){this.ignoreRules(n);const i=new RegExp("^\\w+\\.\\w+\\."+(this.domain?"\\w+\\.":""));t.conditions.forEach(([e,t])=>{e=this.parseCstr(e.toString().replace(i,""));this.addRule(new l.SpeechRule(n,e,t,r))})}else console.error("Action Error: No precondition for action "+n)}getFullPreconditions(e){var t=this.preconditions.get(e);return t||!this.inherits?t:this.inherits.getFullPreconditions(e)}definePrecondition(e,t,n,...r){const i=this.parsePrecondition(n,r),o=this.parseCstr(t);i&&o?(i.rank=this.rank++,this.preconditions.set(e,new a(o,i))):console.error(`Precondition Error: ${n}, (${t})`)}inheritRules(){if(this.inherits&&this.inherits.getSpeechRules().length){const n=new RegExp("^\\w+\\.\\w+\\."+(this.domain?"\\w+\\.":""));this.inherits.getSpeechRules().forEach(e=>{var t=this.parseCstr(e.dynamicCstr.toString().replace(n,""));this.addRule(new l.SpeechRule(e.name,t,e.precondition,e.action))})}}ignoreRules(t,...n){let r=this.findAllRules(e=>e.name===t);if(n.length){let e=[];for(const t of n){const n=this.parseCstr(t);for(const t of r)n.equal(t.dynamicCstr)?this.deleteRule(t):e.push(t);r=e,e=[]}}else r.forEach(this.deleteRule.bind(this))}parsePrecondition_(e){const t=this.context.customGenerators.lookup(e);return t?t():[e]}}t.BaseRuleStore=s;class a{constructor(e,t){this.base=e,this._conditions=[],this.constraints=[],this.allCstr={},this.constraints.push(e),this.addCondition(e,t)}get conditions(){return this._conditions}addConstraint(t){if(!this.constraints.filter(e=>e.equal(t)).length){this.constraints.push(t);const r=[];for(var[e,n]of this.conditions)this.base.equal(e)&&r.push([t,n]);this._conditions=this._conditions.concat(r)}}addBaseCondition(e){this.addCondition(this.base,e)}addFullCondition(t){this.constraints.forEach(e=>this.addCondition(e,t))}addCondition(e,t){var n=e.toString()+" "+t.toString();this.allCstr.condStr||(this.allCstr[n]=!0,this._conditions.push([e,t]))}}t.Condition=a},1462:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.BrailleStore=void 0;const r=n(4036),i=n(7478);class o extends i.MathStore{constructor(){super(...arguments),this.modality="braille",this.customTranscriptions={"⋊":"⠈⠡⠳"}}evaluateString(e){const t=[],n=Array.from(e);for(let e=0;e<n.length;e++)t.push(this.evaluateCharacter(n[e]));return t}annotations(){for(let e,t=0;e=this.annotators[t];t++)(0,r.activate)(this.locale,e)}}t.BrailleStore=o},8310:function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultComparator=t.DynamicCstrParser=t.DynamicCstr=t.DynamicProperties=t.Axis=void 0,(r=n=t.Axis||(t.Axis={})).DOMAIN="domain",r.STYLE="style",r.LOCALE="locale",r.TOPIC="topic",r.MODALITY="modality";class s{constructor(e,t=Object.keys(e)){this.properties=e,this.order=t}static createProp(...r){const i=a.DEFAULT_ORDER,o={};for(let e=0,t=r.length,n=i.length;e<t&&e<n;e++)o[i[e]]=r[e];return new s(o)}getProperties(){return this.properties}getOrder(){return this.order}getAxes(){return this.order}getProperty(e){return this.properties[e]}updateProperties(e){this.properties=e}allProperties(){const t=[];return this.order.forEach(e=>t.push(this.getProperty(e).slice())),t}toString(){const t=[];return this.order.forEach(e=>t.push(e+": "+this.getProperty(e).toString())),t.join("\n")}}class a extends(t.DynamicProperties=s){constructor(e,t){const n={};for(const[t,r]of Object.entries(e))n[t]=[r];super(n,t),this.components=e}static createCstr(...r){const i=a.DEFAULT_ORDER,o={};for(let e=0,t=r.length,n=i.length;e<t&&e<n;e++)o[i[e]]=r[e];return new a(o)}static defaultCstr(){return a.createCstr.apply(null,a.DEFAULT_ORDER.map(function(e){return a.DEFAULT_VALUES[e]}))}static validOrder(e){const t=a.DEFAULT_ORDER.slice();return e.every(e=>{e=t.indexOf(e);return-1!==e&&t.splice(e,1)})}getComponents(){return this.components}getValue(e){return this.components[e]}getValues(){return this.order.map(e=>this.getValue(e))}allProperties(){const r=super.allProperties();for(let e,t,n=0;e=r[n],t=this.order[n];n++){const r=this.getValue(t);-1===e.indexOf(r)&&e.unshift(r)}return r}toString(){return this.getValues().join(".")}equal(n){const r=n.getAxes();if(this.order.length!==r.length)return!1;for(let e,t=0;e=r[t];t++){const r=this.getValue(e);if(!r||n.getValue(e)!==r)return!1}return!0}}(t.DynamicCstr=a).DEFAULT_ORDER=[n.LOCALE,n.MODALITY,n.DOMAIN,n.STYLE,n.TOPIC],a.BASE_LOCALE="base",a.DEFAULT_VALUE="default",a.DEFAULT_VALUES={[n.LOCALE]:"en",[n.DOMAIN]:a.DEFAULT_VALUE,[n.STYLE]:a.DEFAULT_VALUE,[n.TOPIC]:a.DEFAULT_VALUE,[n.MODALITY]:"speech"},t.DynamicCstrParser=class{constructor(e){this.order=e}parse(e){const n=e.split("."),r={};if(n.length>this.order.length)throw new Error("Invalid dynamic constraint: "+r);let i=0;for(let e,t=0;e=this.order[t],n.length;t++,i++){const i=n.shift();r[e]=i}return new a(r,this.order.slice(0,i))}},t.DefaultComparator=class{constructor(e,t=new s(e.getProperties(),e.getOrder())){this.reference=e,this.fallback=t,this.order=this.reference.getOrder()}getReference(){return this.reference}setReference(e,t){this.reference=e,this.fallback=t||new s(e.getProperties(),e.getOrder()),this.order=this.reference.getOrder()}match(n){const e=n.getAxes();return e.length===this.reference.getAxes().length&&e.every(e=>{var t=n.getValue(e);return t===this.reference.getValue(e)||-1!==this.fallback.getProperty(e).indexOf(t)})}compare(n,r){let i=!1;for(let e,t=0;e=this.order[t];t++){var o=n.getValue(e),s=r.getValue(e);if(!i){const n=this.reference.getValue(e);if(n===o&&n!==s)return-1;if(n===s&&n!==o)return 1;if(n===o&&n===s)continue;n!==o&&n!==s&&(i=!0)}const a=this.fallback.getProperty(e),l=a.indexOf(o),c=a.indexOf(s);if(l<c)return-1;if(c<l)return 1}return 0}toString(){return this.reference.toString()+"\n"+this.fallback.toString()}}},1058:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.numbersToAlpha=n.Grammar=n.ATTRIBUTE=void 0;const r=t(6671),a=t(4886),i=t(3319),l=t(4524);n.ATTRIBUTE="grammar";class c{constructor(){this.currentFlags={},this.parameters_={},this.corrections_={},this.preprocessors_={},this.stateStack_=[]}static getInstance(){return c.instance=c.instance||new c,c.instance}static parseInput(e){const n={},r=e.split(":");for(let e=0,t=r.length;e<t;e++){const i=r[e].split("="),o=i[0].trim();i[1]?n[o]=i[1].trim():o.match(/^!/)?n[o.slice(1)]=!1:n[o]=!0}return n}static parseState(e){const n={},r=e.split(" ");for(let e=0,t=r.length;e<t;e++){var i=r[e].split(":"),o=i[0],i=i[1];n[o]=i||!0}return n}static translateString_(e){if(e.match(/:unit$/))return c.translateUnit_(e);const t=a.default.getInstance();let n=t.evaluator(e,t.dynamicCstr);return n=null===n?e:n,n=c.getInstance().getParameter("plural")?l.LOCALE.FUNCTIONS.plural(n):n}static translateUnit_(e){e=c.prepareUnit_(e);const t=a.default.getInstance(),n=c.getInstance().getParameter("plural"),r=t.strict,i=`${t.locale}.${t.modality}.default`;let o,s;return t.strict=!0,n&&(o=t.defaultParser.parse(i+".plural"),s=t.evaluator(e,o)),s?(t.strict=r,s):(o=t.defaultParser.parse(i+".default"),s=t.evaluator(e,o),t.strict=r,s?s=n?l.LOCALE.FUNCTIONS.plural(s):s:c.cleanUnit_(e))}static prepareUnit_(e){var t=e.match(/:unit$/);return t?e.slice(0,t.index).replace(/\s+/g," ")+e.slice(t.index):e}static cleanUnit_(e){return e.match(/:unit$/)?e.replace(/:unit$/,""):e}clear(){this.parameters_={},this.stateStack_=[]}setParameter(e,t){var n=this.parameters_[e];return t?this.parameters_[e]=t:delete this.parameters_[e],n}getParameter(e){return this.parameters_[e]}setCorrection(e,t){this.corrections_[e]=t}setPreprocessor(e,t){this.preprocessors_[e]=t}getCorrection(e){return this.corrections_[e]}getState(){const e=[];for(const n in this.parameters_){var t=this.parameters_[n];e.push("string"==typeof t?n+":"+t:n)}return e.join(" ")}pushState(e){for(const t in e)e[t]=this.setParameter(t,e[t]);this.stateStack_.push(e)}popState(){var e=this.stateStack_.pop();for(const t in e)this.setParameter(t,e[t])}setAttribute(e){var t;e&&e.nodeType===r.NodeType.ELEMENT_NODE&&(t=this.getState())&&e.setAttribute(n.ATTRIBUTE,t)}preprocess(e){return this.runProcessors_(e,this.preprocessors_)}correct(e){return this.runProcessors_(e,this.corrections_)}apply(e,t){return this.currentFlags=t||{},e=this.currentFlags.adjust||this.currentFlags.preprocess?c.getInstance().preprocess(e):e,(this.parameters_.translate||this.currentFlags.translate)&&(e=c.translateString_(e)),e=this.currentFlags.adjust||this.currentFlags.correct?c.getInstance().correct(e):e,this.currentFlags={},e}runProcessors_(e,t){for(const r in this.parameters_){const i=t[r];var n;i&&(e=!0===(n=this.parameters_[r])?i(e):i(e,n))}return e}}function o(e,t){if(!t||!e)return e;t=l.LOCALE.FUNCTIONS.fontRegexp(i.localFont(t));return e.replace(t,"")}function s(e){return e.match(/\d+/)?l.LOCALE.NUMBERS.numberToWords(parseInt(e,10)):e}n.Grammar=c,n.numbersToAlpha=s,c.getInstance().setCorrection("localFont",i.localFont),c.getInstance().setCorrection("localRole",i.localRole),c.getInstance().setCorrection("localEnclose",i.localEnclose),c.getInstance().setCorrection("ignoreFont",o),c.getInstance().setPreprocessor("annotation",function(e,t){return e+":"+t}),c.getInstance().setPreprocessor("noTranslateText",function(e){return e.match(new RegExp("^["+l.LOCALE.MESSAGES.regexp.TEXT+"]+$"))&&(c.getInstance().currentFlags.translate=!1),e}),c.getInstance().setCorrection("ignoreCaps",function(e){let t=l.LOCALE.ALPHABETS.capPrefix[a.default.getInstance().domain];return o(e,t=void 0===t?l.LOCALE.ALPHABETS.capPrefix.default:t)}),c.getInstance().setPreprocessor("numbers2alpha",s)},4161:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.enumerate=t.lookupString=t.lookupCategory=t.lookupRule=t.addSiUnitRules=t.addUnitRules=t.addFunctionRules=t.addSymbolRules=t.defineRule=t.defineRules=t.setSiPrefixes=void 0;const r=n(1984),i=n(4886),s=n(2371),o=n(4974),a=n(8310);let l=a.DynamicCstr.DEFAULT_VALUES[a.Axis.LOCALE],c=a.DynamicCstr.DEFAULT_VALUES[a.Axis.MODALITY],u={};t.setSiPrefixes=function(e){u=e};const d={};function p(e,t,n,r){const i=S(t);E(i,n),i.defineRulesFromMappings(e,l,c,t,r)}function h(e){if(!y(e)){var n=e.names,r=e.mappings,i=e.category;for(let e,t=0;e=n[t];t++)p(e,e,i,r)}}function f(e){for(const n of Object.keys(u)){const r=Object.assign({},e);r.mappings={};var t=u[n];r.key=n+r.key,r.names=r.names.map(function(e){return n+e});for(const i of Object.keys(e.mappings)){r.mappings[i]={};for(const o of Object.keys(e.mappings[i]))r.mappings[i][o]=s.locales[l]().FUNCTIONS.si(t,e.mappings[i][o])}b(r)}b(e)}function m(e,t){const n=d[e];return n?n.lookupRule(null,t):null}function g(e,t){e=m(e,t);return e?e.action:null}function b(e){const t=e.names;t&&(e.names=t.map(function(e){return e+":unit"})),h(e)}function y(e){return(e.locale||e.modality)&&(l=e.locale||l,c=e.modality||c,1)}function S(e){let t=d[e];return t?r.Debugger.getInstance().output("Store exists! "+e):(t=new o.MathSimpleStore,d[e]=t),t}function E(e,t){t&&(e.category=t)}t.defineRules=p,t.defineRule=function(e,t,n,r,i,o){const s=S(i);E(s,r),s.defineRuleFromStrings(e,l,c,t,n,i,o)},t.addSymbolRules=function(e){var t;y(e)||(t=o.MathSimpleStore.parseUnicode(e.key),p(e.key,t,e.category,e.mappings))},t.addFunctionRules=h,t.addUnitRules=function(e){y(e)||(e.si?f:b)(e)},t.addSiUnitRules=f,t.lookupRule=m,t.lookupCategory=function(e){e=d[e];return e?e.category:""},t.lookupString=g,i.default.getInstance().evaluator=g,t.enumerate=function(e={}){for(const r of Object.values(d))for(var[,t]of r.rules.entries())for(var{cstr:n}of t)e=function e(t,n){return n=n||{},t.length&&(n[t[0]]=e(t.slice(1),n[t[0]])),n}(n.getValues(),e);return e}},4974:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.MathSimpleStore=void 0;const f=n(4886),r=n(8310);class i{constructor(){this.category="",this.rules=new Map}static parseUnicode(e){e=parseInt(e,16);return String.fromCodePoint(e)}static testDynamicConstraints_(e,t){return f.default.getInstance().strict?t.cstr.equal(e):f.default.getInstance().comparator.match(t.cstr)}defineRulesFromMappings(e,t,n,r,i){for(const s in i)for(const a in i[s]){var o=i[s][a];this.defineRuleFromStrings(e,t,n,s,a,r,o)}}getRules(e){let t=this.rules.get(e);return t||(t=[],this.rules.set(e,t)),t}defineRuleFromStrings(e,t,n,r,i,o,s){let a=this.getRules(t);const l=f.default.getInstance().parsers[r]||f.default.getInstance().defaultParser,c=f.default.getInstance().comparators[r],u=t+`.${n}.${r}.`+i,d=l.parse(u),p=c?c():f.default.getInstance().comparator,h=p.getReference();p.setReference(d);n={cstr:d,action:s};(a=a.filter(e=>!d.equal(e.cstr))).push(n),this.rules.set(t,a),p.setReference(h)}lookupRule(e,t){let n=this.getRules(t.getValue(r.Axis.LOCALE));return 1===(n=n.filter(function(e){return i.testDynamicConstraints_(t,e)})).length?n[0]:n.length?n.sort((e,t)=>f.default.getInstance().comparator.compare(e.cstr,t.cstr))[0]:null}}t.MathSimpleStore=i},7478:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.MathStore=void 0;const s=n(1426),a=n(4524),r=n(4036),i=n(1970),l=n(7039);class o extends i.BaseRuleStore{constructor(){super(),this.annotators=[],this.parseMethods.Alias=this.defineAlias,this.parseMethods.SpecializedRule=this.defineSpecializedRule,this.parseMethods.Specialized=this.defineSpecialized}initialize(){this.initialized||(this.annotations(),this.initialized=!0)}annotations(){for(let e,t=0;e=this.annotators[t];t++)(0,r.activate)(this.domain,e)}defineAlias(e,t,...n){var r=this.parsePrecondition(t,n);if(r){const i=this.preconditions.get(e);i?i.addFullCondition(r):console.error("Alias Error: No precondition by the name of "+e)}else console.error(`Precondition Error: ${t} `+n)}defineRulesAlias(t,n,...r){const e=this.findAllRules(function(e){return e.name===t});if(0===e.length)throw new l.OutputError("Rule with name "+t+" does not exist.");const i=[];e.forEach(e=>{(e=>{var n=e.dynamicCstr.toString(),r=e.action.toString();for(let e,t=0;e=i[t];t++)if(e.action===r&&e.cstr===n)return!1;return i.push({cstr:n,action:r}),!0})(e)&&this.addAlias_(e,n,r)})}defineSpecializedRule(t,e,n,r){const i=this.parseCstr(e),o=this.findRule(e=>e.name===t&&i.equal(e.dynamicCstr)),s=this.parseCstr(n);if(!o&&r)throw new l.OutputError("Rule named "+t+" with style "+e+" does not exist.");n=r?l.Action.fromString(r):o.action,e=new l.SpeechRule(o.name,s,o.precondition,n);this.addRule(e)}defineSpecialized(e,t,n){var r=this.parseCstr(n);if(r){const i=this.preconditions.get(e);i?i.addConstraint(r):console.error("Alias Error: No precondition by the name of "+e)}else console.error("Dynamic Constraint Error: "+n)}evaluateString(n){const r=[];if(n.match(/^\s+$/))return r;let i=this.matchNumber_(n);if(i&&i.length===n.length)return r.push(this.evaluateCharacter(i.number)),r;var o=s.removeEmpty(n.replace(/\s/g," ").split(" "));for(let t,e=0;t=o[e];e++)if(1===t.length)r.push(this.evaluateCharacter(t));else if(t.match(new RegExp("^["+a.LOCALE.MESSAGES.regexp.TEXT+"]+$")))r.push(this.evaluateCharacter(t));else{let e=t;for(;e;){i=this.matchNumber_(e);const n=e.match(new RegExp("^["+a.LOCALE.MESSAGES.regexp.TEXT+"]+"));if(i)r.push(this.evaluateCharacter(i.number)),e=e.substring(i.length);else if(n)r.push(this.evaluateCharacter(n[0])),e=e.substring(n[0].length);else{const n=Array.from(e),i=n[0];r.push(this.evaluateCharacter(i)),e=n.slice(1).join("")}}}return r}parse(e){super.parse(e),this.annotators=e.annotators||[]}addAlias_(e,t,n){const r=this.parsePrecondition(t,n),i=new l.SpeechRule(e.name,e.dynamicCstr,r,e.action);i.name=e.name,this.addRule(i)}matchNumber_(e){const t=e.match(new RegExp("^"+a.LOCALE.MESSAGES.regexp.NUMBER)),n=e.match(new RegExp("^"+o.regexp.NUMBER));if(!t&&!n)return null;var r=n&&n[0]===e;return t&&t[0]===e||!r?t?{number:t[0],length:t[0].length}:null:{number:n[0].replace(new RegExp(o.regexp.DIGIT_GROUP,"g"),"X").replace(new RegExp(o.regexp.DECIMAL_MARK,"g"),a.LOCALE.MESSAGES.regexp.DECIMAL_MARK).replace(/X/g,a.LOCALE.MESSAGES.regexp.DIGIT_GROUP.replace(/\\/g,"")),length:n[0].length}}}(t.MathStore=o).regexp={NUMBER:"((\\d{1,3})(?=(,| ))((,| )\\d{3})*(\\.\\d+)?)|^\\d*\\.\\d+|^\\d+",DECIMAL_MARK:"\\.",DIGIT_GROUP:","}},7039:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.OutputError=t.Precondition=t.Action=t.Component=t.ActionType=t.SpeechRule=void 0;const r=n(4886),a=n(1058);var i;t.SpeechRule=class{constructor(e,t,n,r){this.name=e,this.dynamicCstr=t,this.precondition=n,this.action=r,this.context=null}toString(){return this.name+" | "+this.dynamicCstr.toString()+" | "+this.precondition.toString()+" ==> "+this.action.toString()}},(n=i=t.ActionType||(t.ActionType={})).NODE="NODE",n.MULTI="MULTI",n.TEXT="TEXT",n.PERSONALITY="PERSONALITY";class l{constructor({type:e,content:t,attributes:n,grammar:r}){this.type=e,this.content=t,this.attributes=n,this.grammar=r}static grammarFromString(e){return a.Grammar.parseInput(e)}static fromString(e){const t={type:function(e){switch(e){case"[n]":return i.NODE;case"[m]":return i.MULTI;case"[t]":return i.TEXT;case"[p]":return i.PERSONALITY;default:throw"Parse error: "+e}}(e.substring(0,3))};let n=e.slice(3).trim();if(!n)throw new c("Missing content.");switch(t.type){case i.TEXT:if('"'===n[0]){const e=u(n,"\\(")[0].trim();if('"'!==e.slice(-1))throw new c("Invalid string syntax.");t.content=e,-1===(n=n.slice(e.length).trim()).indexOf("(")&&(n="");break}case i.NODE:case i.MULTI:{const e=n.indexOf(" (");if(-1===e){t.content=n.trim(),n="";break}t.content=n.substring(0,e).trim(),n=n.slice(e).trim()}}if(n){const e=l.attributesFromString(n);e.grammar&&(t.grammar=e.grammar,delete e.grammar),Object.keys(e).length&&(t.attributes=e)}return new l(t)}static attributesFromString(n){if("("!==n[0]||")"!==n.slice(-1))throw new c("Invalid attribute expression: "+n);const r={},i=u(n.slice(1,-1),",");for(let e=0,t=i.length;e<t;e++){const o=i[e],s=o.indexOf(":");if(-1===s)r[o.trim()]="true";else{const n=o.substring(0,s).trim(),i=o.slice(s+1).trim();r[n]=n===a.ATTRIBUTE?l.grammarFromString(i):i}}return r}toString(){var e="",t=(e=(e+=function(e){switch(e){case i.NODE:return"[n]";case i.MULTI:return"[m]";case i.TEXT:return"[t]";case i.PERSONALITY:return"[p]";default:throw"Unknown type error: "+e}}(this.type))+(this.content?" "+this.content:""),this.attributesToString());return e+=t?" "+t:""}grammarToString(){return this.getGrammar().join(":")}getGrammar(){const e=[];for(const t in this.grammar)!0===this.grammar[t]?e.push(t):!1===this.grammar[t]?e.push("!"+t):e.push(t+"="+this.grammar[t]);return e}attributesToString(){const e=this.getAttributes(),t=this.grammarToString();return t&&e.push("grammar:"+t),0<e.length?"("+e.join(", ")+")":""}getAttributes(){const e=[];for(const n in this.attributes){var t=this.attributes[n];"true"===t?e.push(n):e.push(n+":"+t)}return e}}t.Component=l;t.Action=class s{constructor(e){this.components=e}static fromString(e){const n=u(e,";").filter(function(e){return e.match(/\S/)}).map(function(e){return e.trim()}),r=[];for(let e=0,t=n.length;e<t;e++){var i=l.fromString(n[e]);i&&r.push(i)}return new s(r)}toString(){return this.components.map(function(e){return e.toString()}).join("; ")}};class o{constructor(e,...t){this.query=e,this.constraints=t;var[e,t]=this.presetPriority();this.priority=e?t:this.calculatePriority()}static constraintValue(n,r){for(let e,t=0;e=r[t];t++)if(n.match(e))return++t;return 0}toString(){var e=this.constraints.join(", ");return`${this.query}, ${e} (${this.priority}, ${this.rank})`}calculatePriority(){var e=o.constraintValue(this.query,o.queryPriorities);if(!e)return 0;var t=this.query.match(/^self::.+\[(.+)\]/)[1];return 100*e+10*o.constraintValue(t,o.attributePriorities)}presetPriority(){if(!this.constraints.length)return[!1,0];var e=this.constraints[this.constraints.length-1].match(/^priority=(.*$)/);if(!e)return[!1,0];this.constraints.pop();e=parseFloat(e[1]);return[!0,isNaN(e)?0:e]}}(t.Precondition=o).queryPriorities=[/^self::\*\[.+\]$/,/^self::[\w-]+\[.+\]$/],o.attributePriorities=[/^@[\w-]+$/,/^@[\w-]+!=".+"$/,/^not\(contains\(@[\w-]+,\s*".+"\)\)$/,/^contains\(@[\w-]+,".+"\)$/,/^@[\w-]+=".+"$/];class c extends r.SREError{constructor(e){super(e),this.name="RuleError"}}function u(e,t){const n=[];let r="";for(;""!==e;){var i=e.search(t);if(-1===i){if((e.match(/"/g)||[]).length%2!=0)throw new c("Invalid string in expression: "+e);n.push(r+e),e=r=""}else if((e.substring(0,i).match(/"/g)||[]).length%2==0)n.push(r+e.substring(0,i)),r="",e=e.substring(i+1);else{const t=e.substring(i).search('"');if(-1===t)throw new c("Invalid string in expression: "+e);r+=e.substring(0,i+t+1),e=e.substring(i+t+1)}}return r&&n.push(r),n}t.OutputError=c},443:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechRuleContext=void 0;const r=n(5024),i=n(3686);t.SpeechRuleContext=class{constructor(){this.customQueries=new i.CustomQueries,this.customStrings=new i.CustomStrings,this.contextFunctions=new i.ContextFunctions,this.customGenerators=new i.CustomGenerators}applyCustomQuery(e,t){const n=this.customQueries.lookup(t);return n?n(e):null}applySelector(e,t){return this.applyCustomQuery(e,t)||r.evalXPath(t,e)}applyQuery(e,t){e=this.applySelector(e,t);return 0<e.length?e[0]:null}applyConstraint(e,t){return!!this.applyQuery(e,t)||r.evaluateBoolean(t,e)}constructString(e,t){if(!t)return"";if('"'===t.charAt(0))return t.slice(1,-1);const n=this.customStrings.lookup(t);return n?n(e):r.evaluateString(t,e)}parse(e){var n=Array.isArray(e)?e:Object.entries(e);for(let e,t=0;e=n[t];t++)switch(e[0].slice(0,3)){case"CQF":this.customQueries.add(e[0],e[1]);break;case"CSF":this.customStrings.add(e[0],e[1]);break;case"CTF":this.contextFunctions.add(e[0],e[1]);break;case"CGF":this.customGenerators.add(e[0],e[1]);break;default:console.error("FunctionError: Invalid function name "+e[0])}}}},6060:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.storeFactory=t.SpeechRuleEngine=void 0;const h=n(4148),c=n(1984),r=n(6671),u=n(4886),d=n(4998),p=n(5024),i=n(7278),o=n(9805),s=n(1462),l=n(8310),f=n(1058),a=n(7478),m=n(7039),g=n(2803);class b{constructor(){this.trie=null,this.evaluators_={},this.trie=new g.Trie}static getInstance(){return b.instance=b.instance||new b,b.instance}static debugSpeechRule(t,n){const e=t.precondition,r=t.context.applyQuery(n,e.query);c.Debugger.getInstance().output(e.query,r&&r.toString()),e.constraints.forEach(e=>c.Debugger.getInstance().output(e,t.context.applyConstraint(n,e)))}static debugNamedSpeechRule(n,r){var i=b.getInstance().trie.collectRules().filter(e=>e.name==n);for(let e,t=0;e=i[t];t++)c.Debugger.getInstance().output("Rule",n,"DynamicCstr:",e.dynamicCstr.toString(),"number",t),b.debugSpeechRule(e,r)}evaluateNode(e){(0,p.updateEvaluator)(e);var t=(new Date).getTime();let n=[];try{n=this.evaluateNode_(e)}catch(e){console.error("Something went wrong computing speech."),c.Debugger.getInstance().output(e)}var r=(new Date).getTime();return c.Debugger.getInstance().output("Time:",r-t),n}toString(){return this.trie.collectRules().map(e=>e.toString()).join("\n")}runInSetting(e,t){const n=u.default.getInstance(),r={};for(const t in e)r[t]=n[t],n[t]=e[t];n.setDynamicCstr();t=t();for(const e in r)n[e]=r[e];return n.setDynamicCstr(),t}addStore(e){const t=S(e);"abstract"!==t.kind&&t.getSpeechRules().forEach(e=>this.trie.addRule(e)),this.addEvaluator(t)}processGrammar(e,t,n){const r={};for(const o in n){var i=n[o];r[o]="string"==typeof i?e.constructString(t,i):i}f.Grammar.getInstance().pushState(r)}addEvaluator(e){const t=e.evaluateDefault.bind(e),n=this.evaluators_[e.locale];if(n)n[e.modality]=t;else{const r={};r[e.modality]=t,this.evaluators_[e.locale]=r}}getEvaluator(e,t){e=this.evaluators_[e]||this.evaluators_[l.DynamicCstr.DEFAULT_VALUES[l.Axis.LOCALE]];return e[t]||e[l.DynamicCstr.DEFAULT_VALUES[l.Axis.MODALITY]]}enumerate(e){return this.trie.enumerate(e)}evaluateNode_(e){return e?(this.updateConstraint_(),this.evaluateTree_(e)):[]}evaluateTree_(i){const o=u.default.getInstance();let s;c.Debugger.getInstance().output(o.mode!==d.Mode.HTTP?i.toString():i),f.Grammar.getInstance().setAttribute(i);const a=this.lookupRule(i,o.dynamicCstr);if(!a)return o.strict?[]:(s=this.getEvaluator(o.locale,o.modality)(i),i.attributes&&this.addPersonality_(s,{},!1,i),s);c.Debugger.getInstance().generateOutput(()=>["Apply Rule:",a.name,a.dynamicCstr.toString(),(o.mode,d.Mode.HTTP,i.toString())]);const l=a.context,t=a.action.components;s=[];for(let r,e=0;r=t[e];e++){let e=[];const a=r.content||"",d=r.attributes||{};let t=!1,n=(r.grammar&&this.processGrammar(l,i,r.grammar),null);if(d.engine){n=u.default.getInstance().dynamicCstr.getComponents();const i=f.Grammar.parseInput(d.engine);u.default.getInstance().setDynamicCstr(i)}switch(r.type){case m.ActionType.NODE:{const o=l.applyQuery(i,a);o&&(e=this.evaluateTree_(o))}break;case m.ActionType.MULTI:{t=!0;const o=l.applySelector(i,a);0<o.length&&(e=this.evaluateNodeList_(l,o,d.sepFunc,l.constructString(i,d.separator),d.ctxtFunc,l.constructString(i,d.context)))}break;case m.ActionType.TEXT:{const o=d.span,s={};if(o){const h=(0,p.evalXPath)(o,i);h.length&&(s.extid=h[0].getAttribute("extid"))}const u=l.constructString(i,a);!u&&""!==u||(e=Array.isArray(u)?u.map(function(e){return h.AuditoryDescription.create({text:e.speech,attributes:e.attributes},{adjust:!0})}):[h.AuditoryDescription.create({text:u,attributes:s},{adjust:!0})])}break;default:m.ActionType.PERSONALITY;e=[h.AuditoryDescription.create({text:a})]}e[0]&&!t&&(d.context&&(e[0].context=l.constructString(i,d.context)+(e[0].context||"")),d.annotation&&(e[0].annotation=d.annotation)),this.addLayout(e,d,t),r.grammar&&f.Grammar.getInstance().popState(),s=s.concat(this.addPersonality_(e,d,t,i)),n&&u.default.getInstance().setDynamicCstr(n)}return s}evaluateNodeList_(n,r,e,t,i,o){if(!r.length)return[];const s=t||"",a=o||"",l=n.contextFunctions.lookup(i),c=l?l(r,a):function(){return a},u=n.contextFunctions.lookup(e),d=u?u(r,s):function(){return[h.AuditoryDescription.create({text:s},{translate:!0})]};let p=[];for(let e,t=0;e=r[t];t++){const h=this.evaluateTree_(e);if(0<h.length&&(h[0].context=c()+(h[0].context||""),p=p.concat(h),t<r.length-1)){const n=d();p=p.concat(n)}}return p}addLayout(e,t,n){const r=t.layout;r&&(r.match(/^begin/)?e.unshift(new h.AuditoryDescription({text:"",layout:r})):r.match(/^end/)?e.push(new h.AuditoryDescription({text:"",layout:r})):(e.unshift(new h.AuditoryDescription({text:"",layout:"begin"+r})),e.push(new h.AuditoryDescription({text:"",layout:"end"+r}))))}addPersonality_(n,e,t,r){const i={};let o=null;for(const n of d.personalityPropList){const t=e[n];if(void 0!==t){const h=parseFloat(t),r=isNaN(h)?'"'===t.charAt(0)?t.slice(1,-1):t:h;n===d.personalityProps.PAUSE?o=r:i[n]=r}}for(let e,t=0;e=n[t];t++)this.addRelativePersonality_(e,i),this.addExternalAttributes_(e,r);if(t&&n.length&&delete n[n.length-1].personality[d.personalityProps.JOIN],o&&n.length){const e=n[n.length-1];e.text||Object.keys(e.personality).length?n.push(h.AuditoryDescription.create({text:"",personality:{pause:o}})):e.personality[d.personalityProps.PAUSE]=o}return n}addExternalAttributes_(t,e){if(e.hasAttributes()){var n=e.attributes;for(let e=n.length-1;0<=e;e--){const r=n[e].name;!t.attributes[r]&&r.match(/^ext/)&&(t.attributes[r]=n[e].value)}}}addRelativePersonality_(e,t){if(!e.personality)return e.personality=t,e;const n=e.personality;for(const e in t)n[e]&&"number"==typeof n[e]&&"number"==typeof t[e]?n[e]=n[e]+t[e]:n[e]||(n[e]=t[e]);return e}updateConstraint_(){const n=u.default.getInstance().dynamicCstr,r=u.default.getInstance().strict,e=this.trie,i={};let o=n.getValue(l.Axis.LOCALE),s=n.getValue(l.Axis.MODALITY),t=n.getValue(l.Axis.DOMAIN);e.hasSubtrie([o,s,t])||(t=l.DynamicCstr.DEFAULT_VALUES[l.Axis.DOMAIN],e.hasSubtrie([o,s,t])||(s=l.DynamicCstr.DEFAULT_VALUES[l.Axis.MODALITY],e.hasSubtrie([o,s,t])||(o=l.DynamicCstr.DEFAULT_VALUES[l.Axis.LOCALE]))),i[l.Axis.LOCALE]=[o],i[l.Axis.MODALITY]=["summary"!==s?s:l.DynamicCstr.DEFAULT_VALUES[l.Axis.MODALITY]],i[l.Axis.DOMAIN]=["speech"!==s?l.DynamicCstr.DEFAULT_VALUES[l.Axis.DOMAIN]:t];var a=n.getOrder();for(let e,t=0;e=a[t];t++)if(!i[e]){const o=n.getValue(e),s=this.makeSet_(o,n.preference),u=l.DynamicCstr.DEFAULT_VALUES[e];r||o===u||s.push(u),i[e]=s}n.updateProperties(i)}makeSet_(e,t){return t&&Object.keys(t).length?e.split(":"):[e]}lookupRule(e,t){if(!e||e.nodeType!==r.NodeType.ELEMENT_NODE&&e.nodeType!==r.NodeType.TEXT_NODE)return null;e=this.lookupRules(e,t);return 0<e.length?this.pickMostConstraint_(t,e):null}lookupRules(e,t){return this.trie.lookupRules(e,t.allProperties())}pickMostConstraint_(e,t){const n=u.default.getInstance().comparator;return t.sort(function(e,t){return n.compare(e.dynamicCstr,t.dynamicCstr)||t.precondition.priority-e.precondition.priority||t.precondition.constraints.length-e.precondition.constraints.length||t.precondition.rank-e.precondition.rank}),c.Debugger.getInstance().generateOutput((()=>t.map(e=>e.name+"("+e.dynamicCstr.toString()+")")).bind(this)),t[0]}}t.SpeechRuleEngine=b;const y=new Map;function S(e){var t=`${e.locale}.${e.modality}.`+e.domain;if("actions"===e.kind){const n=y.get(t);return n.parse(e),n}o.init(),e&&!e.functions&&(e.functions=i.getStore(e.locale,e.modality,e.domain));const n=new("braille"===e.modality?s.BrailleStore:a.MathStore);return y.set(t,n),e.inherits&&(n.inherits=y.get(`${e.inherits}.${e.modality}.`+e.domain)),n.parse(e),n.initialize(),n}t.storeFactory=S,u.default.nodeEvaluator=b.getInstance().evaluateNode.bind(b.getInstance())},3686:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CustomGenerators=t.ContextFunctions=t.CustomStrings=t.CustomQueries=void 0;class n{constructor(e,t){this.prefix=e,this.store=t}add(e,t){this.checkCustomFunctionSyntax_(e)&&(this.store[e]=t)}addStore(n){var r=Object.keys(n.store);for(let e,t=0;e=r[t];t++)this.add(e,n.store[e])}lookup(e){return this.store[e]}checkCustomFunctionSyntax_(e){var t=new RegExp("^"+this.prefix);return!!e.match(t)||(console.error("FunctionError: Invalid function name. Expected prefix "+this.prefix),!1)}}t.CustomQueries=class extends n{constructor(){super("CQF",{})}},t.CustomStrings=class extends n{constructor(){super("CSF",{})}},t.ContextFunctions=class extends n{constructor(){super("CTF",{})}},t.CustomGenerators=class extends n{constructor(){super("CGF",{})}}},931:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.contentIterator=t.pauseSeparator=t.nodeCounter=void 0;const o=n(4148),s=n(5024),a=n(4886);t.nodeCounter=function(e,t){const n=e.length;let r=0,i=t?t:"";return function(){return r<n&&(r+=1),i+" "+r}},t.pauseSeparator=function(e,t){const n=parseFloat(t),r=isNaN(n)?t:n;return function(){return[o.AuditoryDescription.create({text:"",personality:{pause:r}})]}},t.contentIterator=function(e,r){let i;return i=0<e.length?s.evalXPath("../../content/*",e[0]):[],function(){const e=i.shift(),t=r?[o.AuditoryDescription.create({text:r},{translate:!0})]:[];if(!e)return t;var n=a.default.evaluateNode(e);return t.concat(n)}}},1939:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getTreeFromString=t.getTree=t.xmlTree=void 0;const r=n(6671),i=n(1784);function o(e){return new i.SemanticTree(e)}t.xmlTree=function(e){return o(e).xml()},t.getTree=o,t.getTreeFromString=function(e){return o(r.parseInput(e))}},4036:function(e,i,t){Object.defineProperty(i,"__esModule",{value:!0}),i.annotate=i.activate=i.register=i.visitors=i.annotators=void 0;const n=t(241);i.annotators=new Map,i.visitors=new Map,i.register=function(e){var t=e.domain+":"+e.name;(e instanceof n.SemanticAnnotator?i.annotators:i.visitors).set(t,e)},i.activate=function(e,t){const n=e+":"+t,r=i.annotators.get(n)||i.visitors.get(n);r&&(r.active=!0)},i.annotate=function(e){for(const t of i.annotators.values())t.active&&t.annotate(e);for(const n of i.visitors.values())n.active&&n.visit(e,Object.assign({},n.def))}},241:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticVisitor=t.SemanticAnnotator=void 0,t.SemanticAnnotator=class{constructor(e,t,n){this.domain=e,this.name=t,this.func=n,this.active=!1}annotate(e){e.childNodes.forEach(this.annotate.bind(this)),e.addAnnotation(this.domain,this.func(e))}},t.SemanticVisitor=class{constructor(e,t,n,r={}){this.domain=e,this.name=t,this.func=n,this.def=r,this.active=!1}visit(n,e){let r=this.func(n,e);n.addAnnotation(this.domain,r[0]);for(let e,t=0;e=n.childNodes[t];t++)r=this.visit(e,r[1]);return r}}},4020:function(F,e){Object.defineProperty(e,"__esModule",{value:!0}),e.lookupSecondary=e.isEmbellishedType=e.isMatchingFence=e.functionApplication=e.invisibleComma=e.invisiblePlus=e.invisibleTimes=e.lookupMeaning=e.lookupRole=e.lookupType=e.equal=e.allLettersRegExp=void 0;const t=String.fromCodePoint(8291),k=["，","﹐",",",t],n=["¯","‒","–","—","―","﹘","-","⁻","₋","−","➖","﹣","－","‐","‑","‾","_"],r=["~","̃","∼","˜","∽","˷","̴","̰"],i={"(":")","[":"]","{":"}","⁅":"⁆","〈":"〉","❨":"❩","❪":"❫","❬":"❭","❮":"❯","❰":"❱","❲":"❳","❴":"❵","⟅":"⟆","⟦":"⟧","⟨":"⟩","⟪":"⟫","⟬":"⟭","⟮":"⟯","⦃":"⦄","⦅":"⦆","⦇":"⦈","⦉":"⦊","⦋":"⦌","⦍":"⦎","⦏":"⦐","⦑":"⦒","⦓":"⦔","⦕":"⦖","⦗":"⦘","⧘":"⧙","⧚":"⧛","⧼":"⧽","⸢":"⸣","⸤":"⸥","⸦":"⸧","⸨":"⸩","〈":"〉","《":"》","「":"」","『":"』","【":"】","〔":"〕","〖":"〗","〘":"〙","〚":"〛","〝":"〞","﴾":"﴿","︗":"︘","﹙":"﹚","﹛":"﹜","﹝":"﹞","（":"）","［":"］","｛":"｝","｟":"｠","｢":"｣","⌈":"⌉","⌊":"⌋","⌌":"⌍","⌎":"⌏","⌜":"⌝","⌞":"⌟","⎛":"⎞","⎜":"⎟","⎝":"⎠","⎡":"⎤","⎢":"⎥","⎣":"⎦","⎧":"⎫","⎨":"⎬","⎩":"⎭","⎰":"⎱","⎸":"⎹"},o={"⎴":"⎵","⏜":"⏝","⏞":"⏟","⏠":"⏡","︵":"︶","︷":"︸","︹":"︺","︻":"︼","︽":"︾","︿":"﹀","﹁":"﹂","﹃":"﹄","﹇":"﹈"},U=Object.keys(i),s=Object.values(i),B=(s.push("〟"),Object.keys(o)),j=Object.values(o),a=["|","¦","∣","⏐","⎸","⎹","❘","｜","￤","︱","︲"],l=["‖","∥","⦀","⫴"],c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],u=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","ı","ȷ"],d=["Ａ","Ｂ","Ｃ","Ｄ","Ｅ","Ｆ","Ｇ","Ｈ","Ｉ","Ｊ","Ｋ","Ｌ","Ｍ","Ｎ","Ｏ","Ｐ","Ｑ","Ｒ","Ｓ","Ｔ","Ｕ","Ｖ","Ｗ","Ｘ","Ｙ","Ｚ"],p=["ａ","ｂ","ｃ","ｄ","ｅ","ｆ","ｇ","ｈ","ｉ","ｊ","ｋ","ｌ","ｍ","ｎ","ｏ","ｐ","ｑ","ｒ","ｓ","ｔ","ｕ","ｖ","ｗ","ｘ","ｙ","ｚ"],h=["𝐀","𝐁","𝐂","𝐃","𝐄","𝐅","𝐆","𝐇","𝐈","𝐉","𝐊","𝐋","𝐌","𝐍","𝐎","𝐏","𝐐","𝐑","𝐒","𝐓","𝐔","𝐕","𝐖","𝐗","𝐘","𝐙"],f=["𝐚","𝐛","𝐜","𝐝","𝐞","𝐟","𝐠","𝐡","𝐢","𝐣","𝐤","𝐥","𝐦","𝐧","𝐨","𝐩","𝐪","𝐫","𝐬","𝐭","𝐮","𝐯","𝐰","𝐱","𝐲","𝐳"],m=["𝐴","𝐵","𝐶","𝐷","𝐸","𝐹","𝐺","𝐻","𝐼","𝐽","𝐾","𝐿","𝑀","𝑁","𝑂","𝑃","𝑄","𝑅","𝑆","𝑇","𝑈","𝑉","𝑊","𝑋","𝑌","𝑍"],g=["𝑎","𝑏","𝑐","𝑑","𝑒","𝑓","𝑔","ℎ","𝑖","𝑗","𝑘","𝑙","𝑚","𝑛","𝑜","𝑝","𝑞","𝑟","𝑠","𝑡","𝑢","𝑣","𝑤","𝑥","𝑦","𝑧","𝚤","𝚥"],b=["𝑨","𝑩","𝑪","𝑫","𝑬","𝑭","𝑮","𝑯","𝑰","𝑱","𝑲","𝑳","𝑴","𝑵","𝑶","𝑷","𝑸","𝑹","𝑺","𝑻","𝑼","𝑽","𝑾","𝑿","𝒀","𝒁"],y=["𝒂","𝒃","𝒄","𝒅","𝒆","𝒇","𝒈","𝒉","𝒊","𝒋","𝒌","𝒍","𝒎","𝒏","𝒐","𝒑","𝒒","𝒓","𝒔","𝒕","𝒖","𝒗","𝒘","𝒙","𝒚","𝒛"],S=["𝒜","ℬ","𝒞","𝒟","ℰ","ℱ","𝒢","ℋ","ℐ","𝒥","𝒦","ℒ","ℳ","𝒩","𝒪","𝒫","𝒬","ℛ","𝒮","𝒯","𝒰","𝒱","𝒲","𝒳","𝒴","𝒵","℘"],E=["𝒶","𝒷","𝒸","𝒹","ℯ","𝒻","ℊ","𝒽","𝒾","𝒿","𝓀","𝓁","𝓂","𝓃","ℴ","𝓅","𝓆","𝓇","𝓈","𝓉","𝓊","𝓋","𝓌","𝓍","𝓎","𝓏","ℓ"],N=["𝓐","𝓑","𝓒","𝓓","𝓔","𝓕","𝓖","𝓗","𝓘","𝓙","𝓚","𝓛","𝓜","𝓝","𝓞","𝓟","𝓠","𝓡","𝓢","𝓣","𝓤","𝓥","𝓦","𝓧","𝓨","𝓩"],v=["𝓪","𝓫","𝓬","𝓭","𝓮","𝓯","𝓰","𝓱","𝓲","𝓳","𝓴","𝓵","𝓶","𝓷","𝓸","𝓹","𝓺","𝓻","𝓼","𝓽","𝓾","𝓿","𝔀","𝔁","𝔂","𝔃"],A=["𝔄","𝔅","ℭ","𝔇","𝔈","𝔉","𝔊","ℌ","ℑ","𝔍","𝔎","𝔏","𝔐","𝔑","𝔒","𝔓","𝔔","ℜ","𝔖","𝔗","𝔘","𝔙","𝔚","𝔛","𝔜","ℨ"],_=["𝔞","𝔟","𝔠","𝔡","𝔢","𝔣","𝔤","𝔥","𝔦","𝔧","𝔨","𝔩","𝔪","𝔫","𝔬","𝔭","𝔮","𝔯","𝔰","𝔱","𝔲","𝔳","𝔴","𝔵","𝔶","𝔷"],C=["𝔸","𝔹","ℂ","𝔻","𝔼","𝔽","𝔾","ℍ","𝕀","𝕁","𝕂","𝕃","𝕄","ℕ","𝕆","ℙ","ℚ","ℝ","𝕊","𝕋","𝕌","𝕍","𝕎","𝕏","𝕐","ℤ"],M=["𝕒","𝕓","𝕔","𝕕","𝕖","𝕗","𝕘","𝕙","𝕚","𝕛","𝕜","𝕝","𝕞","𝕟","𝕠","𝕡","𝕢","𝕣","𝕤","𝕥","𝕦","𝕧","𝕨","𝕩","𝕪","𝕫"],O=["𝕬","𝕭","𝕮","𝕯","𝕰","𝕱","𝕲","𝕳","𝕴","𝕵","𝕶","𝕷","𝕸","𝕹","𝕺","𝕻","𝕼","𝕽","𝕾","𝕿","𝖀","𝖁","𝖂","𝖃","𝖄","𝖅"],T=["𝖆","𝖇","𝖈","𝖉","𝖊","𝖋","𝖌","𝖍","𝖎","𝖏","𝖐","𝖑","𝖒","𝖓","𝖔","𝖕","𝖖","𝖗","𝖘","𝖙","𝖚","𝖛","𝖜","𝖝","𝖞","𝖟"],x=["𝖠","𝖡","𝖢","𝖣","𝖤","𝖥","𝖦","𝖧","𝖨","𝖩","𝖪","𝖫","𝖬","𝖭","𝖮","𝖯","𝖰","𝖱","𝖲","𝖳","𝖴","𝖵","𝖶","𝖷","𝖸","𝖹"],I=["𝖺","𝖻","𝖼","𝖽","𝖾","𝖿","𝗀","𝗁","𝗂","𝗃","𝗄","𝗅","𝗆","𝗇","𝗈","𝗉","𝗊","𝗋","𝗌","𝗍","𝗎","𝗏","𝗐","𝗑","𝗒","𝗓"],L=["𝗔","𝗕","𝗖","𝗗","𝗘","𝗙","𝗚","𝗛","𝗜","𝗝","𝗞","𝗟","𝗠","𝗡","𝗢","𝗣","𝗤","𝗥","𝗦","𝗧","𝗨","𝗩","𝗪","𝗫","𝗬","𝗭"],P=["𝗮","𝗯","𝗰","𝗱","𝗲","𝗳","𝗴","𝗵","𝗶","𝗷","𝗸","𝗹","𝗺","𝗻","𝗼","𝗽","𝗾","𝗿","𝘀","𝘁","𝘂","𝘃","𝘄","𝘅","𝘆","𝘇"],R=["𝘈","𝘉","𝘊","𝘋","𝘌","𝘍","𝘎","𝘏","𝘐","𝘑","𝘒","𝘓","𝘔","𝘕","𝘖","𝘗","𝘘","𝘙","𝘚","𝘛","𝘜","𝘝","𝘞","𝘟","𝘠","𝘡"],V=["𝘢","𝘣","𝘤","𝘥","𝘦","𝘧","𝘨","𝘩","𝘪","𝘫","𝘬","𝘭","𝘮","𝘯","𝘰","𝘱","𝘲","𝘳","𝘴","𝘵","𝘶","𝘷","𝘸","𝘹","𝘺","𝘻"],H=["𝘼","𝘽","𝘾","𝘿","𝙀","𝙁","𝙂","𝙃","𝙄","𝙅","𝙆","𝙇","𝙈","𝙉","𝙊","𝙋","𝙌","𝙍","𝙎","𝙏","𝙐","𝙑","𝙒","𝙓","𝙔","𝙕"],G=["𝙖","𝙗","𝙘","𝙙","𝙚","𝙛","𝙜","𝙝","𝙞","𝙟","𝙠","𝙡","𝙢","𝙣","𝙤","𝙥","𝙦","𝙧","𝙨","𝙩","𝙪","𝙫","𝙬","𝙭","𝙮","𝙯"],$=["𝙰","𝙱","𝙲","𝙳","𝙴","𝙵","𝙶","𝙷","𝙸","𝙹","𝙺","𝙻","𝙼","𝙽","𝙾","𝙿","𝚀","𝚁","𝚂","𝚃","𝚄","𝚅","𝚆","𝚇","𝚈","𝚉"],J=["𝚊","𝚋","𝚌","𝚍","𝚎","𝚏","𝚐","𝚑","𝚒","𝚓","𝚔","𝚕","𝚖","𝚗","𝚘","𝚙","𝚚","𝚛","𝚜","𝚝","𝚞","𝚟","𝚠","𝚡","𝚢","𝚣"],X=["ⅅ","ⅆ","ⅇ","ⅈ","ⅉ"],W=["Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω"],K=["α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","ς","σ","τ","υ","φ","χ","ψ","ω"],q=["𝚨","𝚩","𝚪","𝚫","𝚬","𝚭","𝚮","𝚯","𝚰","𝚱","𝚲","𝚳","𝚴","𝚵","𝚶","𝚷","𝚸","𝚺","𝚻","𝚼","𝚽","𝚾","𝚿","𝛀"],Y=["𝛂","𝛃","𝛄","𝛅","𝛆","𝛇","𝛈","𝛉","𝛊","𝛋","𝛌","𝛍","𝛎","𝛏","𝛐","𝛑","𝛒","𝛓","𝛔","𝛕","𝛖","𝛗","𝛘","𝛙","𝛚"],z=["𝛢","𝛣","𝛤","𝛥","𝛦","𝛧","𝛨","𝛩","𝛪","𝛫","𝛬","𝛭","𝛮","𝛯","𝛰","𝛱","𝛲","𝛴","𝛵","𝛶","𝛷","𝛸","𝛹","𝛺"],Q=["𝛼","𝛽","𝛾","𝛿","𝜀","𝜁","𝜂","𝜃","𝜄","𝜅","𝜆","𝜇","𝜈","𝜉","𝜊","𝜋","𝜌","𝜍","𝜎","𝜏","𝜐","𝜑","𝜒","𝜓","𝜔"],Z=["𝜜","𝜝","𝜞","𝜟","𝜠","𝜡","𝜢","𝜣","𝜤","𝜥","𝜦","𝜧","𝜨","𝜩","𝜪","𝜫","𝜬","𝜮","𝜯","𝜰","𝜱","𝜲","𝜳","𝜴"],ee=["𝜶","𝜷","𝜸","𝜹","𝜺","𝜻","𝜼","𝜽","𝜾","𝜿","𝝀","𝝁","𝝂","𝝃","𝝄","𝝅","𝝆","𝝇","𝝈","𝝉","𝝊","𝝋","𝝌","𝝍","𝝎"],te=["𝝖","𝝗","𝝘","𝝙","𝝚","𝝛","𝝜","𝝝","𝝞","𝝟","𝝠","𝝡","𝝢","𝝣","𝝤","𝝥","𝝦","𝝨","𝝩","𝝪","𝝫","𝝬","𝝭","𝝮"],ne=["𝝰","𝝱","𝝲","𝝳","𝝴","𝝵","𝝶","𝝷","𝝸","𝝹","𝝺","𝝻","𝝼","𝝽","𝝾","𝝿","𝞀","𝞁","𝞂","𝞃","𝞄","𝞅","𝞆","𝞇","𝞈"],re=["𝞐","𝞑","𝞒","𝞓","𝞔","𝞕","𝞖","𝞗","𝞘","𝞙","𝞚","𝞛","𝞜","𝞝","𝞞","𝞟","𝞠","𝞢","𝞣","𝞤","𝞥","𝞦","𝞧","𝞨"],ie=["𝞪","𝞫","𝞬","𝞭","𝞮","𝞯","𝞰","𝞱","𝞲","𝞳","𝞴","𝞵","𝞶","𝞷","𝞸","𝞹","𝞺","𝞻","𝞼","𝞽","𝞾","𝞿","𝟀","𝟁","𝟂"],oe=["ℼ","ℽ","ℾ","ℿ"],se=["ϐ","ϑ","ϕ","ϖ","ϗ","ϰ","ϱ","ϵ","϶","ϴ"],ae=["𝛜","𝛝","𝛞","𝛟","𝛠","𝛡"],le=["𝜖","𝜗","𝜘","𝜙","𝜚","𝜛"],ce=["𝞊","𝞋","𝞌","𝞍","𝞎","𝞏"],ue=["ℵ","ℶ","ℷ","ℸ"],de=c.concat(u,d,p,h,f,m,b,y,g,S,E,N,v,A,_,C,M,O,T,x,I,L,P,R,V,H,G,$,J,X,W,K,q,Y,z,Q,Z,ee,te,ne,oe,se,re,ie,ae,le,ce,ue),pe=(e.allLettersRegExp=new RegExp(de.join("|")),["+","±","∓","∔","∧","∨","∩","∪","⊌","⊍","⊎","⊓","⊔","⊝","⊞","⊤","⊥","⊺","⊻","⊼","⋄","⋎","⋏","⋒","⋓","⩞","⊕","⋔"]),he=String.fromCodePoint(8292),fe=(pe.push(he),["†","‡","∐","∗","∘","∙","≀","⊚","⊛","⊠","⊡","⋅","⋆","⋇","⋈","⋉","⋊","⋋","⋌","○","·","*","⊗","⊙"]),me=String.fromCodePoint(8290),ge=(fe.push(me),String.fromCodePoint(8289)),be=["²","³","¹","⁰","⁴","⁵","⁶","⁷","⁸","⁹"].concat(["₀","₁","₂","₃","₄","₅","₆","₇","₈","₉"],["①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","⑰","⑱","⑲","⑳","⓪","⓫","⓬","⓭","⓮","⓯","⓰","⓱","⓲","⓳","⓴","⓵","⓶","⓷","⓸","⓹","⓺","⓻","⓼","⓽","⓾","⓿","❶","❷","❸","❹","❺","❻","❼","❽","❾","❿","➀","➁","➂","➃","➄","➅","➆","➇","➈","➉","➊","➋","➌","➍","➎","➏","➐","➑","➒","➓","㉈","㉉","㉊","㉋","㉌","㉍","㉎","㉏","㉑","㉒","㉓","㉔","㉕","㉖","㉗","㉘","㉙","㉚","㉛","㉜","㉝","㉞","㉟","㊱","㊲","㊳","㊴","㊵","㊶","㊷","㊸","㊹","㊺","㊻","㊼","㊽","㊾","㊿"],["⑴","⑵","⑶","⑷","⑸","⑹","⑺","⑻","⑼","⑽","⑾","⑿","⒀","⒁","⒂","⒃","⒄","⒅","⒆","⒇"],["⒈","⒉","⒊","⒋","⒌","⒍","⒎","⒏","⒐","⒑","⒒","⒓","⒔","⒕","⒖","⒗","⒘","⒙","⒚","⒛","🄀","🄁","🄂","🄃","🄄","🄅","🄆","🄇","🄈","🄉","🄊"]),ye=["cos","cot","csc","sec","sin","tan","arccos","arccot","arccsc","arcsec","arcsin","arctan","arc cos","arc cot","arc csc","arc sec","arc sin","arc tan"].concat(["cosh","coth","csch","sech","sinh","tanh","arcosh","arcoth","arcsch","arsech","arsinh","artanh","arccosh","arccoth","arccsch","arcsech","arcsinh","arctanh"],["deg","det","dim","hom","ker","Tr","tr"],["log","ln","lg","exp","expt","gcd","gcd","arg","im","re","Pr"]),Se=[{set:["!",'"',"#","%","&",";","?","@","\\","¡","§","¶","¿","‗","†","‡","•","‣","․","‥","‧","‰","‱","‸","※","‼","‽","‾","⁁","⁂","⁃","⁇","⁈","⁉","⁋","⁌","⁍","⁎","⁏","⁐","⁑","⁓","⁕","⁖","⁘","⁙","⁚","⁛","⁜","⁝","⁞","︐","︔","︕","︖","︰","﹅","﹆","﹉","﹊","﹋","﹌","﹔","﹖","﹗","﹟","﹠","﹡","﹨","﹪","﹫","！","＂","＃","％","＆","＇","＊","／","；","？","＠","＼"],type:"punctuation",role:"unknown"},{set:["︓",":","：","﹕"],type:"punctuation",role:"colon"},{set:k,type:"punctuation",role:"comma"},{set:["…","⋮","⋯","⋰","⋱","︙"],type:"punctuation",role:"ellipsis"},{set:[".","﹒","．"],type:"punctuation",role:"fullstop"},{set:n,type:"operator",role:"dash"},{set:r,type:"operator",role:"tilde"},{set:["'","′","″","‴","‵","‶","‷","⁗","ʹ","ʺ"],type:"punctuation",role:"prime"},{set:["°"],type:"punctuation",role:"degree"},{set:U,type:"fence",role:"open"},{set:s,type:"fence",role:"close"},{set:B,type:"fence",role:"top"},{set:j,type:"fence",role:"bottom"},{set:a,type:"fence",role:"neutral"},{set:l,type:"fence",role:"metric"},{set:u,type:"identifier",role:"latinletter",font:"normal"},{set:c,type:"identifier",role:"latinletter",font:"normal"},{set:p,type:"identifier",role:"latinletter",font:"normal"},{set:d,type:"identifier",role:"latinletter",font:"normal"},{set:f,type:"identifier",role:"latinletter",font:"bold"},{set:h,type:"identifier",role:"latinletter",font:"bold"},{set:g,type:"identifier",role:"latinletter",font:"italic"},{set:m,type:"identifier",role:"latinletter",font:"italic"},{set:y,type:"identifier",role:"latinletter",font:"bold-italic"},{set:b,type:"identifier",role:"latinletter",font:"bold-italic"},{set:E,type:"identifier",role:"latinletter",font:"script"},{set:S,type:"identifier",role:"latinletter",font:"script"},{set:v,type:"identifier",role:"latinletter",font:"bold-script"},{set:N,type:"identifier",role:"latinletter",font:"bold-script"},{set:_,type:"identifier",role:"latinletter",font:"fraktur"},{set:A,type:"identifier",role:"latinletter",font:"fraktur"},{set:M,type:"identifier",role:"latinletter",font:"double-struck"},{set:C,type:"identifier",role:"latinletter",font:"double-struck"},{set:T,type:"identifier",role:"latinletter",font:"bold-fraktur"},{set:O,type:"identifier",role:"latinletter",font:"bold-fraktur"},{set:I,type:"identifier",role:"latinletter",font:"sans-serif"},{set:x,type:"identifier",role:"latinletter",font:"sans-serif"},{set:P,type:"identifier",role:"latinletter",font:"sans-serif-bold"},{set:L,type:"identifier",role:"latinletter",font:"sans-serif-bold"},{set:V,type:"identifier",role:"latinletter",font:"sans-serif-italic"},{set:R,type:"identifier",role:"latinletter",font:"sans-serif-italic"},{set:G,type:"identifier",role:"latinletter",font:"sans-serif-bold-italic"},{set:H,type:"identifier",role:"latinletter",font:"sans-serif-bold-italic"},{set:J,type:"identifier",role:"latinletter",font:"monospace"},{set:$,type:"identifier",role:"latinletter",font:"monospace"},{set:X,type:"identifier",role:"latinletter",font:"double-struck-italic"},{set:K,type:"identifier",role:"greekletter",font:"normal"},{set:W,type:"identifier",role:"greekletter",font:"normal"},{set:Y,type:"identifier",role:"greekletter",font:"bold"},{set:q,type:"identifier",role:"greekletter",font:"bold"},{set:Q,type:"identifier",role:"greekletter",font:"italic"},{set:z,type:"identifier",role:"greekletter",font:"italic"},{set:ee,type:"identifier",role:"greekletter",font:"bold-italic"},{set:Z,type:"identifier",role:"greekletter",font:"bold-italic"},{set:ne,type:"identifier",role:"greekletter",font:"sans-serif-bold"},{set:te,type:"identifier",role:"greekletter",font:"sans-serif-bold"},{set:re,type:"identifier",role:"greekletter",font:"sans-serif-bold-italic"},{set:ie,type:"identifier",role:"greekletter",font:"sans-serif-bold-italic"},{set:oe,type:"identifier",role:"greekletter",font:"double-struck"},{set:se,type:"identifier",role:"greekletter",font:"normal"},{set:ae,type:"identifier",role:"greekletter",font:"bold"},{set:le,type:"identifier",role:"greekletter",font:"italic"},{set:ce,type:"identifier",role:"greekletter",font:"sans-serif-bold"},{set:ue,type:"identifier",role:"otherletter",font:"normal"},{set:["0","1","2","3","4","5","6","7","8","9"],type:"number",role:"integer",font:"normal"},{set:["０","１","２","３","４","５","６","７","８","９"],type:"number",role:"integer",font:"normal"},{set:["𝟎","𝟏","𝟐","𝟑","𝟒","𝟓","𝟔","𝟕","𝟖","𝟗"],type:"number",role:"integer",font:"bold"},{set:["𝟘","𝟙","𝟚","𝟛","𝟜","𝟝","𝟞","𝟟","𝟠","𝟡"],type:"number",role:"integer",font:"double-struck"},{set:["𝟢","𝟣","𝟤","𝟥","𝟦","𝟧","𝟨","𝟩","𝟪","𝟫"],type:"number",role:"integer",font:"sans-serif"},{set:["𝟬","𝟭","𝟮","𝟯","𝟰","𝟱","𝟲","𝟳","𝟴","𝟵"],type:"number",role:"integer",font:"sans-serif-bold"},{set:["𝟶","𝟷","𝟸","𝟹","𝟺","𝟻","𝟼","𝟽","𝟾","𝟿"],type:"number",role:"integer",font:"monospace"},{set:["¼","½","¾","⅐","⅑","⅒","⅓","⅔","⅕","⅖","⅗","⅘","⅙","⅚","⅛","⅜","⅝","⅞","⅟","↉"],type:"number",role:"float"},{set:be,type:"number",role:"othernumber"},{set:pe,type:"operator",role:"addition"},{set:fe,type:"operator",role:"multiplication"},{set:["¯","-","⁒","⁻","₋","−","∖","∸","≂","⊖","⊟","➖","⨩","⨪","⨫","⨬","⨺","⩁","﹣","－","‐","‑"],type:"operator",role:"subtraction"},{set:["/","÷","⁄","∕","⊘","⟌","⦼","⨸"],type:"operator",role:"division"},{set:["∀","∃","∆","∇","∂","∁","∄"],type:"operator",role:"prefix operator"},{set:["𝛁","𝛛","𝟊","𝟋"],type:"operator",role:"prefix operator",font:"bold"},{set:["𝛻","𝜕"],type:"operator",role:"prefix operator",font:"italic"},{set:["𝝯","𝞉"],type:"operator",role:"prefix operator",font:"sans-serif-bold"},{set:["=","~","⁼","₌","∼","∽","≃","≅","≈","≊","≋","≌","≍","≎","≑","≒","≓","≔","≕","≖","≗","≘","≙","≚","≛","≜","≝","≞","≟","≡","≣","⧤","⩦","⩮","⩯","⩰","⩱","⩲","⩳","⩴","⩵","⩶","⩷","⩸","⋕","⩭","⩪","⩫","⩬","﹦","＝","⩬","⊜","∷"],type:"relation",role:"equality"},{set:["<",">","≁","≂","≄","≆","≇","≉","≏","≐","≠","≢","≤","≥","≦","≧","≨","≩","≪","≫","≬","≭","≮","≯","≰","≱","≲","≳","≴","≵","≶","≷","≸","≹","≺","≻","≼","≽","≾","≿","⊀","⊁","⋖","⋗","⋘","⋙","⋚","⋛","⋜","⋝","⋞","⋟","⋠","⋡","⋦","⋧","⋨","⋩","⩹","⩺","⩻","⩼","⩽","⩾","⩿","⪀","⪁","⪂","⪃","⪄","⪅","⪆","⪇","⪈","⪉","⪊","⪋","⪌","⪍","⪎","⪏","⪐","⪑","⪒","⪓","⪔","⪕","⪖","⪗","⪘","⪙","⪚","⪛","⪜","⪝","⪞","⪟","⪠","⪡","⪢","⪣","⪤","⪥","⪦","⪧","⪨","⪩","⪪","⪫","⪬","⪭","⪮","⪯","⪰","⪱","⪲","⪳","⪴","⪵","⪶","⪷","⪸","⪹","⪺","⪻","⪼","⫷","⫸","⫹","⫺","⧀","⧁","﹤","﹥","＜","＞"],type:"relation",role:"inequality"},{set:["⋢","⋣","⋤","⋥","⊂","⊃","⊄","⊅","⊆","⊇","⊈","⊉","⊊","⊋","⊏","⊐","⊑","⊒","⪽","⪾","⪿","⫀","⫁","⫂","⫃","⫄","⫅","⫆","⫇","⫈","⫉","⫊","⫋","⫌","⫍","⫎","⫏","⫐","⫑","⫒","⫓","⫔","⫕","⫖","⫗","⫘","⋐","⋑","⋪","⋫","⋬","⋭","⊲","⊳","⊴","⊵"],type:"relation",role:"set"},{set:["⊢","⊣","⊦","⊧","⊨","⊩","⊪","⊫","⊬","⊭","⊮","⊯","⫞","⫟","⫠","⫡","⫢","⫣","⫤","⫥","⫦","⫧","⫨","⫩","⫪","⫫","⫬","⫭"],type:"relation",role:"unknown"},{set:["←","↑","→","↓","↔","↕","↖","↗","↘","↙","↚","↛","↜","↝","↞","↟","↠","↡","↢","↣","↤","↥","↦","↧","↨","↩","↪","↫","↬","↭","↮","↯","↰","↱","↲","↳","↴","↵","↶","↷","↸","↹","↺","↻","⇄","⇅","⇆","⇇","⇈","⇉","⇊","⇍","⇎","⇏","⇐","⇑","⇒","⇓","⇔","⇕","⇖","⇗","⇘","⇙","⇚","⇛","⇜","⇝","⇞","⇟","⇠","⇡","⇢","⇣","⇤","⇥","⇦","⇧","⇨","⇩","⇪","⇫","⇬","⇭","⇮","⇯","⇰","⇱","⇲","⇳","⇴","⇵","⇶","⇷","⇸","⇹","⇺","⇻","⇼","⇽","⇾","⇿","⌁","⌃","⌄","⌤","⎋","➔","➘","➙","➚","➛","➜","➝","➞","➟","➠","➡","➢","➣","➤","➥","➦","➧","➨","➩","➪","➫","➬","➭","➮","➯","➱","➲","➳","➴","➵","➶","➷","➸","➹","➺","➻","➼","➽","➾","⟰","⟱","⟲","⟳","⟴","⟵","⟶","⟷","⟸","⟹","⟺","⟻","⟼","⟽","⟾","⟿","⤀","⤁","⤂","⤃","⤄","⤅","⤆","⤇","⤈","⤉","⤊","⤋","⤌","⤍","⤎","⤏","⤐","⤑","⤒","⤓","⤔","⤕","⤖","⤗","⤘","⤙","⤚","⤛","⤜","⤝","⤞","⤟","⤠","⤡","⤢","⤣","⤤","⤥","⤦","⤧","⤨","⤩","⤪","⤭","⤮","⤯","⤰","⤱","⤲","⤳","⤴","⤵","⤶","⤷","⤸","⤹","⤺","⤻","⤼","⤽","⤾","⤿","⥀","⥁","⥂","⥃","⥄","⥅","⥆","⥇","⥈","⥉","⥰","⥱","⥲","⥳","⥴","⥵","⥶","⥷","⥸","⥹","⥺","⥻","⦳","⦴","⦽","⧪","⧬","⧭","⨗","⬀","⬁","⬂","⬃","⬄","⬅","⬆","⬇","⬈","⬉","⬊","⬋","⬌","⬍","⬎","⬏","⬐","⬑","⬰","⬱","⬲","⬳","⬴","⬵","⬶","⬷","⬸","⬹","⬺","⬻","⬼","⬽","⬾","⬿","⭀","⭁","⭂","⭃","⭄","⭅","⭆","⭇","⭈","⭉","⭊","⭋","⭌","￩","￪","￫","￬","↼","↽","↾","↿","⇀","⇁","⇂","⇃","⇋","⇌","⥊","⥋","⥌","⥍","⥎","⥏","⥐","⥑","⥒","⥓","⥔","⥕","⥖","⥗","⥘","⥙","⥚","⥛","⥜","⥝","⥞","⥟","⥠","⥡","⥢","⥣","⥤","⥥","⥦","⥧","⥨","⥩","⥪","⥫","⥬","⥭","⥮","⥯","⥼","⥽","⥾","⥿"],type:"relation",role:"arrow"},{set:["∈","∊","⋲","⋳","⋴","⋵","⋶","⋷","⋸","⋹","⋿"],type:"operator",role:"element"},{set:["∉"],type:"operator",role:"nonelement"},{set:["∋","∍","⋺","⋻","⋼","⋽","⋾"],type:"operator",role:"reelement"},{set:["∌"],type:"operator",role:"renonelement"},{set:["⅀","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨃","⨄","⨅","⨆","⨇","⨈","⨉","⨊","⨋","⫼","⫿"],type:"largeop",role:"sum"},{set:["∫","∬","∭","∮","∯","∰","∱","∲","∳","⨌","⨍","⨎","⨏","⨐","⨑","⨒","⨓","⨔","⨕","⨖","⨗","⨘","⨙","⨚","⨛","⨜"],type:"largeop",role:"integral"},{set:["∟","∠","∡","∢","⊾","⊿","△","▷","▽","◁"],type:"operator",role:"geometry"},{set:["inf","lim","liminf","limsup","max","min","sup","injlim","projlim","inj lim","proj lim"],type:"function",role:"limit function"},{set:ye,type:"function",role:"prefix function"},{set:["mod","rem"],type:"operator",role:"prefix function"}],w=function(){const n={};for(let t,e=0;t=Se[e];e++)t.set.forEach(function(e){n[e]={role:t.role||"unknown",type:t.type||"unknown",font:t.font||"unknown"}});return n}(),Ee=(e.equal=function(e,t){return e.type===t.type&&e.role===t.role&&e.font===t.font},e.lookupType=function(e){return(null==(e=w[e])?void 0:e.type)||"unknown"},e.lookupRole=function(e){return(null==(e=w[e])?void 0:e.role)||"unknown"},e.lookupMeaning=function(e){return w[e]||{role:"unknown",type:"unknown",font:"unknown"}},e.invisibleTimes=function(){return me},e.invisiblePlus=function(){return he},e.invisibleComma=function(){return t},e.functionApplication=function(){return ge},e.isMatchingFence=function(e,t){return-1!==a.indexOf(e)||-1!==l.indexOf(e)?e===t:i[e]===t||o[e]===t},e.isEmbellishedType=function(e){return"operator"===e||"relation"===e||"fence"===e||"punctuation"===e},new Map);function D(e,t,n=""){for(const r of t)Ee.set(e+" "+r,n||e)}D("d",["d","ⅆ","ｄ","𝐝","𝑑","𝒹","𝓭","𝔡","𝕕","𝖉","𝖽","𝗱","𝘥","𝚍"]),D("bar",n),D("tilde",r),e.lookupSecondary=function(e,t){return Ee.get(e+" "+t)}},7405:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticMeaningCollator=t.SemanticNodeCollator=t.SemanticDefault=void 0;const r=n(4020),i=n(178);class o{constructor(){this.map={}}static key(e,t){return t?e+":"+t:e}add(e,t){this.map[o.key(e,t.font)]=t}addNode(e){this.add(e.textContent,e.meaning())}retrieve(e,t){return this.map[o.key(e,t)]}retrieveNode(e){return this.retrieve(e.textContent,e.font)}size(){return Object.keys(this.map).length}}t.SemanticDefault=o;class s{constructor(){this.map={}}add(e,t){const n=this.map[e];n?n.push(t):this.map[e]=[t]}retrieve(e,t){return this.map[o.key(e,t)]}retrieveNode(e){return this.retrieve(e.textContent,e.font)}copy(){const e=this.copyCollator();for(const t in this.map)e.map[t]=this.map[t];return e}minimize(){for(const e in this.map)1===this.map[e].length&&delete this.map[e]}minimalCollator(){const e=this.copy();for(const t in e.map)1===e.map[t].length&&delete e.map[t];return e}isMultiValued(){for(const e in this.map)if(1<this.map[e].length)return!0;return!1}isEmpty(){return!Object.keys(this.map).length}}class a extends s{copyCollator(){return new a}add(e,t){e=o.key(e,t.font);super.add(e,t)}addNode(e){this.add(e.textContent,e)}toString(){const e=[];for(const t in this.map){const n=Array(t.length+3).join(" "),r=this.map[t],i=[];for(let e,t=0;e=r[t];t++)i.push(e.toString());e.push(t+": "+i.join("\n"+n))}return e.join("\n")}collateMeaning(){const e=new l;for(const t in this.map)e.map[t]=this.map[t].map(function(e){return e.meaning()});return e}}t.SemanticNodeCollator=a;class l extends s{copyCollator(){return new l}add(e,t){const n=this.retrieve(e,t.font);if(!n||!n.find(function(e){return r.equal(e,t)})){const n=o.key(e,t.font);super.add(n,t)}}addNode(e){this.add(e.textContent,e.meaning())}toString(){const e=[];for(const t in this.map){const n=Array(t.length+3).join(" "),r=this.map[t],i=[];for(let e,t=0;e=r[t];t++)i.push("{type: "+e.type+", role: "+e.role+", font: "+e.font+"}");e.push(t+": "+i.join("\n"+n))}return e.join("\n")}reduce(){for(const e in this.map)1!==this.map[e].length&&(this.map[e]=(0,i.reduce)(this.map[e]))}default(){const e=new o;for(const t in this.map)1===this.map[t].length&&(e.map[t]=this.map[t][0]);return e}newDefault(){const e=this.default(),t=(this.reduce(),this.default());return e.size()!==t.size()?t:null}}t.SemanticMeaningCollator=l},5958:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticMultiHeuristic=t.SemanticTreeHeuristic=t.SemanticAbstractHeuristic=void 0;class n{constructor(e,t,n=e=>!1){this.name=e,this.apply=t,this.applicable=n}}t.SemanticAbstractHeuristic=n,t.SemanticTreeHeuristic=class extends n{},t.SemanticMultiHeuristic=class extends n{}},2721:function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.lookup=i.run=i.add=i.blacklist=i.flags=i.updateFactory=i.factory=void 0,i.factory=null,i.updateFactory=function(e){i.factory=e};const n=new Map;function o(e){return n.get(e)}i.flags={combine_juxtaposition:!0,convert_juxtaposition:!0,multioperator:!0},i.blacklist={},i.add=function(e){var t=e.name;n.set(t,e),i.flags[t]||(i.flags[t]=!1)},i.run=function(e,t,n){const r=o(e);return r&&!i.blacklist[e]&&(i.flags[e]||r.applicable(t))?r.apply(t):n?n(t):t},i.lookup=o},7103:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const c=n(1984),r=n(4886),o=n(4020),u=n(2721),i=n(5958),d=n(6161),l=n(7793),s=n(8901);function a(e,t,n){let r=null;if(!e.length)return r;const i=n[n.length-1],o=i&&i.length,s=t&&t.length,a=l.default.getInstance();if(o&&s){if("infixop"===t[0].type&&"implicit"===t[0].role)return r=e.pop(),i.push(a.postfixNode_(i.pop(),e)),r;r=e.shift();const n=a.prefixNode_(t.shift(),e);return t.unshift(n),r}return o?i.push(a.postfixNode_(i.pop(),e)):s&&t.unshift(a.prefixNode_(t.shift(),e)),r}u.add(new i.SemanticTreeHeuristic("combine_juxtaposition",function(n){for(let e,t=n.childNodes.length-1;e=n.childNodes[t];t--)d.isImplicitOp(e)&&!e.nobreaking&&(n.childNodes.splice(t,1,...e.childNodes),n.contentNodes.splice(t,0,...e.contentNodes),e.childNodes.concat(e.contentNodes).forEach(function(e){e.parent=n}),n.addMathmlNodes(e.mathml));return n})),u.add(new i.SemanticTreeHeuristic("propagateSimpleFunction",e=>("infixop"!==e.type&&"fraction"!==e.type||!e.childNodes.every(d.isSimpleFunction)||(e.role="composed function"),e),e=>"clearspeak"===r.default.getInstance().domain)),u.add(new i.SemanticTreeHeuristic("simpleNamedFunction",e=>("unit"!==e.role&&-1!==["f","g","h","F","G","H"].indexOf(e.textContent)&&(e.role="simple function"),e),e=>"clearspeak"===r.default.getInstance().domain)),u.add(new i.SemanticTreeHeuristic("propagateComposedFunction",e=>("fenced"===e.type&&"composed function"===e.childNodes[0].role&&(e.role="composed function"),e),e=>"clearspeak"===r.default.getInstance().domain)),u.add(new i.SemanticTreeHeuristic("multioperator",e=>{var t;"unknown"!==e.role||e.textContent.length<=1||(t=[...e.textContent].map(o.lookupMeaning).reduce(function(e,t){return e&&t.role&&"unknown"!==t.role&&t.role!==e?"unknown"===e?t.role:null:e},"unknown"))&&(e.role=t)})),u.add(new i.SemanticMultiHeuristic("convert_juxtaposition",r=>{let i=s.partitionNodes(r,function(e){return e.textContent===o.invisibleTimes()&&"operator"===e.type});r=(i=i.rel.length?function(e){const t=[],n=[];let r=e.comp.shift(),i=null,o=[];for(;e.comp.length;)if(o=[],r.length)i&&t.push(i),n.push(r),i=e.rel.shift(),r=e.comp.shift();else{for(i&&o.push(i);!r.length&&e.comp.length;)r=e.comp.shift(),o.push(e.rel.shift());i=a(o,r,n)}return o.length||r.length?(t.push(i),n.push(r)):(o.push(i),a(o,r,n)),{rel:t,comp:n}}(i):i).comp[0];for(let e,t,n=1;e=i.comp[n],t=i.rel[n-1];n++)r.push(t),r=r.concat(e);return(i=s.partitionNodes(r,function(e){return e.textContent===o.invisibleTimes()&&("operator"===e.type||"infixop"===e.type)})).rel.length?function e(t,n,r){if(!n.length)return t;const i=t.pop(),o=n.shift(),s=r.shift();if(d.isImplicitOp(o)){c.Debugger.getInstance().output("Juxta Heuristic Case 2");const u=(i?[i,o]:[o]).concat(s);return e(t.concat(u),n,r)}if(!i)return c.Debugger.getInstance().output("Juxta Heuristic Case 3"),e([o].concat(s),n,r);const a=s.shift();if(!a){c.Debugger.getInstance().output("Juxta Heuristic Case 9");const s=u.factory.makeBranchNode("infixop",[i,n.shift()],[o],o.textContent);return s.role="implicit",u.run("combine_juxtaposition",s),n.unshift(s),e(t,n,r)}if(d.isOperator(i)||d.isOperator(a))return c.Debugger.getInstance().output("Juxta Heuristic Case 4"),e(t.concat([i,o,a]).concat(s),n,r);let l=null;return d.isImplicitOp(i)&&d.isImplicitOp(a)?(c.Debugger.getInstance().output("Juxta Heuristic Case 5"),i.contentNodes.push(o),i.contentNodes=i.contentNodes.concat(a.contentNodes),i.childNodes.push(a),i.childNodes=i.childNodes.concat(a.childNodes),a.childNodes.forEach(e=>e.parent=i),(o.parent=i).addMathmlNodes(o.mathml),i.addMathmlNodes(a.mathml),l=i):d.isImplicitOp(i)?(c.Debugger.getInstance().output("Juxta Heuristic Case 6"),i.contentNodes.push(o),i.childNodes.push(a),a.parent=i,(o.parent=i).addMathmlNodes(o.mathml),i.addMathmlNodes(a.mathml),l=i):d.isImplicitOp(a)?(c.Debugger.getInstance().output("Juxta Heuristic Case 7"),a.contentNodes.unshift(o),a.childNodes.unshift(i),i.parent=a,(o.parent=a).addMathmlNodes(o.mathml),a.addMathmlNodes(i.mathml),l=a):(c.Debugger.getInstance().output("Juxta Heuristic Case 8"),(l=u.factory.makeBranchNode("infixop",[i,a],[o],o.textContent)).role="implicit"),t.push(l),e(t.concat(s),n,r)}(i.comp.shift(),i.rel,i.comp):r})),u.add(new i.SemanticTreeHeuristic("simple2prefix",e=>(1<e.textContent.length&&!e.textContent[0].match(/[A-Z]/)&&(e.role="prefix function"),e),e=>"braille"===r.default.getInstance().modality&&"identifier"===e.type)),u.add(new i.SemanticTreeHeuristic("detect_cycle",e=>{e.type="matrix",e.role="cycle";const t=e.childNodes[0];return t.type="row",t.role="cycle",t.textContent="",t.contentNodes=[],e},e=>"fenced"===e.type&&"infixop"===e.childNodes[0].type&&"implicit"===e.childNodes[0].role&&e.childNodes[0].childNodes.every(function(e){return"number"===e.type})&&e.childNodes[0].contentNodes.every(function(e){return"space"===e.role})))},8122:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticMathml=void 0;const c=n(6671),r=n(6098),i=n(6161),u=n(7793),d=n(8901);class o extends r.SemanticAbstractParser{constructor(){super("MathML"),this.parseMap_={SEMANTICS:this.semantics_.bind(this),MATH:this.rows_.bind(this),MROW:this.rows_.bind(this),MPADDED:this.rows_.bind(this),MSTYLE:this.rows_.bind(this),MFRAC:this.fraction_.bind(this),MSUB:this.limits_.bind(this),MSUP:this.limits_.bind(this),MSUBSUP:this.limits_.bind(this),MOVER:this.limits_.bind(this),MUNDER:this.limits_.bind(this),MUNDEROVER:this.limits_.bind(this),MROOT:this.root_.bind(this),MSQRT:this.sqrt_.bind(this),MTABLE:this.table_.bind(this),MLABELEDTR:this.tableLabeledRow_.bind(this),MTR:this.tableRow_.bind(this),MTD:this.tableCell_.bind(this),MS:this.text_.bind(this),MTEXT:this.text_.bind(this),MSPACE:this.space_.bind(this),"ANNOTATION-XML":this.text_.bind(this),MI:this.identifier_.bind(this),MN:this.number_.bind(this),MO:this.operator_.bind(this),MFENCED:this.fenced_.bind(this),MENCLOSE:this.enclosed_.bind(this),MMULTISCRIPTS:this.multiscripts_.bind(this),ANNOTATION:this.empty_.bind(this),NONE:this.empty_.bind(this),MACTION:this.action_.bind(this)};const t={type:"identifier",role:"numbersetletter",font:"double-struck"};["C","H","N","P","Q","R","Z","ℂ","ℍ","ℕ","ℙ","ℚ","ℝ","ℤ"].forEach((e=>this.getFactory().defaultMap.add(e,t)).bind(this))}static getAttribute_(e,t,n){if(!e.hasAttribute(t))return n;const r=e.getAttribute(t);return r.match(/^\s*$/)?null:r}parse(e){u.default.getInstance().setNodeFactory(this.getFactory());const t=c.toArray(e.childNodes),n=c.tagName(e),r=this.parseMap_[n],i=(r||this.dummy_.bind(this))(e,t);return d.addAttributes(i,e),-1===["MATH","MROW","MPADDED","MSTYLE","SEMANTICS"].indexOf(n)&&(i.mathml.unshift(e),i.mathmlTree=e),i}semantics_(e,t){return t.length?this.parse(t[0]):this.getFactory().makeEmptyNode()}rows_(e,t){const n=e.getAttribute("semantics");if(n&&n.match("bspr_"))return u.default.proof(e,n,this.parseList.bind(this));let r;return 1===(t=d.purgeNodes(t)).length?"empty"!==(r=this.parse(t[0])).type||r.mathmlTree||(r.mathmlTree=e):r=u.default.getInstance().row(this.parseList(t)),r.mathml.unshift(e),r}fraction_(e,t){if(!t.length)return this.getFactory().makeEmptyNode();var n=this.parse(t[0]),t=t[1]?this.parse(t[1]):this.getFactory().makeEmptyNode();return u.default.getInstance().fractionLikeNode(n,t,e.getAttribute("linethickness"),"true"===e.getAttribute("bevelled"))}limits_(e,t){return u.default.getInstance().limitNode(c.tagName(e),this.parseList(t))}root_(e,t){return t[1]?this.getFactory().makeBranchNode("root",[this.parse(t[1]),this.parse(t[0])],[]):this.sqrt_(e,t)}sqrt_(e,t){t=this.parseList(d.purgeNodes(t));return this.getFactory().makeBranchNode("sqrt",[u.default.getInstance().row(t)],[])}table_(e,t){const n=e.getAttribute("semantics");if(n&&n.match("bspr_"))return u.default.proof(e,n,this.parseList.bind(this));const r=this.getFactory().makeBranchNode("table",this.parseList(t),[]);return r.mathmlTree=e,u.default.tableToMultiline(r),r}tableRow_(e,t){const n=this.getFactory().makeBranchNode("row",this.parseList(t),[]);return n.role="table",n}tableLabeledRow_(e,t){if(!t.length)return this.tableRow_(e,t);const n=this.parse(t[0]),r=(n.role="label",this.getFactory().makeBranchNode("row",this.parseList(t.slice(1)),[n]));return r.role="table",r}tableCell_(e,t){t=this.parseList(d.purgeNodes(t)),t=t.length?1===t.length&&i.isType(t[0],"empty")?t:[u.default.getInstance().row(t)]:[];const n=this.getFactory().makeBranchNode("cell",t,[]);return n.role="table",n}space_(e,t){const n=e.getAttribute("width"),r=n&&n.match(/[a-z]*$/);if(!r)return this.empty_(e,t);var i=r[0],o=parseFloat(n.slice(0,r.index)),i={cm:.4,pc:.5,em:.5,ex:1,in:.15,pt:5,mm:5}[i];if(!i||isNaN(o)||o<i)return this.empty_(e,t);o=this.getFactory().makeUnprocessed(e);return u.default.getInstance().text(o,c.tagName(e))}text_(e,t){const n=this.leaf_(e,t);return e.textContent?(n.updateContent(e.textContent,!0),u.default.getInstance().text(n,c.tagName(e))):n}identifier_(e,t){t=this.leaf_(e,t);return u.default.getInstance().identifierNode(t,u.default.getInstance().font(e.getAttribute("mathvariant")),e.getAttribute("class"))}number_(e,t){e=this.leaf_(e,t);return u.default.number(e),e}operator_(e,t){e=this.leaf_(e,t);return u.default.getInstance().operatorNode(e),e}fenced_(e,t){var t=this.parseList(d.purgeNodes(t)),n=o.getAttribute_(e,"separators",","),r=o.getAttribute_(e,"open","("),e=o.getAttribute_(e,"close",")"),r=u.default.getInstance().mfenced(r,e,n,t);return u.default.getInstance().tablesInRow([r])[0]}enclosed_(e,t){const n=this.parseList(d.purgeNodes(t)),r=this.getFactory().makeBranchNode("enclose",[u.default.getInstance().row(n)],[]);return r.role=e.getAttribute("notation")||"unknown",r}multiscripts_(e,n){if(!n.length)return this.getFactory().makeEmptyNode();var t=this.parse(n.shift());if(!n.length)return t;const r=[],i=[],o=[],s=[];let a=!1,l=0;for(let e,t=0;e=n[t];t++)"MPRESCRIPTS"!==c.tagName(e)?((a?1&l?r:i:1&l?o:s).push(e),l++):(a=!0,l=0);return d.purgeNodes(r).length||d.purgeNodes(i).length?u.default.getInstance().tensor(t,this.parseList(i),this.parseList(r),this.parseList(s),this.parseList(o)):u.default.getInstance().pseudoTensor(t,this.parseList(s),this.parseList(o))}empty_(e,t){return this.getFactory().makeEmptyNode()}action_(e,t){return 1<t.length?this.parse(t[1]):this.getFactory().makeUnprocessed(e)}dummy_(e,t){const n=this.getFactory().makeUnprocessed(e);return n.role=e.tagName,n.textContent=e.textContent,n}leaf_(e,t){if(1!==t.length||t[0].nodeType===c.NodeType.TEXT_NODE)return this.getFactory().makeLeafNode(e.textContent,u.default.getInstance().font(e.getAttribute("mathvariant")));{const n=this.getFactory().makeUnprocessed(e);return n.role=t[0].tagName,d.addAttributes(n,t[0]),n}}}t.SemanticMathml=o},9444:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticNode=void 0;const r=n(6671),i=n(4020),o=n(8901);class s{constructor(e){this.id=e,this.mathml=[],this.parent=null,this.type="unknown",this.role="unknown",this.font="unknown",this.embellished=null,this.fencePointer="",this.childNodes=[],this.textContent="",this.mathmlTree=null,this.contentNodes=[],this.annotation={},this.attributes={},this.nobreaking=!1}static fromXml(e){const t=parseInt(e.getAttribute("id"),10),n=new s(t);return n.type=e.tagName,s.setAttribute(n,e,"role"),s.setAttribute(n,e,"font"),s.setAttribute(n,e,"embellished"),s.setAttribute(n,e,"fencepointer","fencePointer"),e.getAttribute("annotation")&&n.parseAnnotation(e.getAttribute("annotation")),o.addAttributes(n,e),s.processChildren(n,e),n}static setAttribute(e,t,n,r){r=r||n;t=t.getAttribute(n);t&&(e[r]=t)}static processChildren(t,e){for(const n of r.toArray(e.childNodes))if(n.nodeType===r.NodeType.TEXT_NODE)t.textContent=n.textContent;else{const e=r.toArray(n.childNodes).map(s.fromXml);e.forEach(e=>e.parent=t),"CONTENT"===r.tagName(n)?t.contentNodes=e:t.childNodes=e}}querySelectorAll(n){let r=[];for(let e,t=0;e=this.childNodes[t];t++)r=r.concat(e.querySelectorAll(n));for(let e,t=0;e=this.contentNodes[t];t++)r=r.concat(e.querySelectorAll(n));return n(this)&&r.unshift(this),r}xml(i,o){function e(e,t){const n=t.map(function(e){return e.xml(i,o)}),r=i.createElementNS("",e);for(let e,t=0;e=n[t];t++)r.appendChild(e);return r}const t=i.createElementNS("",this.type);return o||this.xmlAttributes(t),t.textContent=this.textContent,0<this.contentNodes.length&&t.appendChild(e("content",this.contentNodes)),0<this.childNodes.length&&t.appendChild(e("children",this.childNodes)),t}toString(e=!1){var t=r.parseInput("<snode/>");return r.serializeXml(this.xml(t,e))}allAttributes(){const e=[];return e.push(["role",this.role]),"unknown"!==this.font&&e.push(["font",this.font]),Object.keys(this.annotation).length&&e.push(["annotation",this.xmlAnnotation()]),this.embellished&&e.push(["embellished",this.embellished]),this.fencePointer&&e.push(["fencepointer",this.fencePointer]),e.push(["id",this.id.toString()]),e}xmlAnnotation(){const t=[];for(const n in this.annotation)this.annotation[n].forEach(function(e){t.push(n+":"+e)});return t.join(";")}toJson(){const n={};n.type=this.type;var r=this.allAttributes();for(let e,t=0;e=r[t];t++)n[e[0]]=e[1].toString();return this.textContent&&(n.$t=this.textContent),this.childNodes.length&&(n.children=this.childNodes.map(function(e){return e.toJson()})),this.contentNodes.length&&(n.content=this.contentNodes.map(function(e){return e.toJson()})),n}updateContent(e,t){var t=t?e.replace(/^[ \f\n\r\t\v\u200b]*/,"").replace(/[ \f\n\r\t\v\u200b]*$/,""):e.trim();this.textContent!==(e=e&&!t?e:t)&&(t=(0,i.lookupMeaning)(e),this.textContent=e,this.role=t.role,this.type=t.type,this.font=t.font)}addMathmlNodes(n){for(let e,t=0;e=n[t];t++)-1===this.mathml.indexOf(e)&&this.mathml.push(e)}appendChild(e){this.childNodes.push(e),this.addMathmlNodes(e.mathml),e.parent=this}replaceChild(t,n){var e,r=this.childNodes.indexOf(t);-1!==r&&(t.parent=null,(n.parent=this).childNodes[r]=n,r=t.mathml.filter(function(e){return-1===n.mathml.indexOf(e)}),e=n.mathml.filter(function(e){return-1===t.mathml.indexOf(e)}),this.removeMathmlNodes(r),this.addMathmlNodes(e))}appendContentNode(e){e&&(this.contentNodes.push(e),this.addMathmlNodes(e.mathml),e.parent=this)}removeContentNode(e){e&&-1!==(e=this.contentNodes.indexOf(e))&&this.contentNodes.slice(e,1)}equals(r){if(!r)return!1;if(this.type!==r.type||this.role!==r.role||this.textContent!==r.textContent||this.childNodes.length!==r.childNodes.length||this.contentNodes.length!==r.contentNodes.length)return!1;for(let e,t,n=0;e=this.childNodes[n],t=r.childNodes[n];n++)if(!e.equals(t))return!1;for(let e,t,n=0;e=this.contentNodes[n],t=r.contentNodes[n];n++)if(!e.equals(t))return!1;return!0}displayTree(){console.info(this.displayTree_(0))}addAnnotation(e,t){t&&this.addAnnotation_(e,t)}getAnnotation(e){return this.annotation[e]||[]}hasAnnotation(e,t){const n=this.annotation[e];return!!n&&-1!==n.indexOf(t)}parseAnnotation(e){const n=e.split(";");for(let e=0,t=n.length;e<t;e++){var r=n[e].split(":");this.addAnnotation(r[0],r[1])}}meaning(){return{type:this.type,role:this.role,font:this.font}}xmlAttributes(n){var r=this.allAttributes();for(let e,t=0;e=r[t];t++)n.setAttribute(e[0],e[1]);this.addExternalAttributes(n)}addExternalAttributes(e){for(const t in this.attributes)e.setAttribute(t,this.attributes[t])}removeMathmlNodes(n){const r=this.mathml;for(let e,t=0;e=n[t];t++){const n=r.indexOf(e);-1!==n&&r.splice(n,1)}this.mathml=r}displayTree_(t){t++;var n=Array(t).join("  ");let r="";r=(r=r+("\n"+n+this.toString())+"\n"+n+"MathmlTree:")+"\n"+n+this.mathmlTreeString()+"\n"+n+"MathML:";for(let e,t=0;e=this.mathml[t];t++)r+="\n"+n+e.toString();return r+="\n"+n+"Begin Content",this.contentNodes.forEach(function(e){r+=e.displayTree_(t)}),r=r+("\n"+n+"End Content")+("\n"+n+"Begin Children"),this.childNodes.forEach(function(e){r+=e.displayTree_(t)}),r+="\n"+n+"End Children"}mathmlTreeString(){return this.mathmlTree?this.mathmlTree.toString():"EMPTY"}addAnnotation_(e,t){const n=this.annotation[e];n?n.push(t):this.annotation[e]=[t]}}t.SemanticNode=s},4790:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticNodeFactory=void 0;const r=n(7405),i=n(7405),o=n(9444);t.SemanticNodeFactory=class{constructor(){this.leafMap=new i.SemanticNodeCollator,this.defaultMap=new r.SemanticDefault,this.idCounter_=-1}makeNode(e){return this.createNode_(e)}makeUnprocessed(e){const t=this.createNode_();return t.mathml=[e],t.mathmlTree=e,t}makeEmptyNode(){const e=this.createNode_();return e.type="empty",e}makeContentNode(e){const t=this.createNode_();return t.updateContent(e),t}makeMultipleContentNodes(t,n){const r=[];for(let e=0;e<t;e++)r.push(this.makeContentNode(n));return r}makeLeafNode(e,t){if(!e)return this.makeEmptyNode();const n=this.makeContentNode(e);n.font=t||n.font;e=this.defaultMap.retrieveNode(n);return e&&(n.type=e.type,n.role=e.role,n.font=e.font),this.leafMap.addNode(n),n}makeBranchNode(e,t,n,r){const i=this.createNode_();return r&&i.updateContent(r),i.type=e,i.childNodes=t,i.contentNodes=n,t.concat(n).forEach(function(e){(e.parent=i).addMathmlNodes(e.mathml)}),i}createNode_(e){return void 0!==e?this.idCounter_=Math.max(this.idCounter_,e):e=++this.idCounter_,new o.SemanticNode(e)}}},178:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticComparator=t.reduce=t.sort=t.apply=t.add=void 0;const i=[];function n(e){i.push(e)}function o(n,r){for(let e,t=0;e=i[t];t++){const i=e.compare(n,r);if(0!==i)return i}return 0}function s(e){e.sort(o)}t.add=n,t.apply=o,t.sort=s,t.reduce=function(e){if(e.length<=1)return e;const t=e.slice(),n=(s(t),[]);for(var r;r=t.pop(),n.push(r),r&&t.length&&0===o(t[t.length-1],r););return n};class r{constructor(e,t=null){this.comparator=e,this.type=t,n(this)}compare(e,t){return this.type&&this.type===e.type&&this.type===t.type?this.comparator(e,t):0}}new(t.SemanticComparator=r)(function(e,t){return"simple function"===e.role?1:"simple function"===t.role?-1:0},"identifier")},6098:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticAbstractParser=void 0;const r=n(4790);t.SemanticAbstractParser=class{constructor(e){this.type=e,this.factory_=new r.SemanticNodeFactory}getFactory(){return this.factory_}setFactory(e){this.factory_=e}getType(){return this.type}parseList(n){const r=[];for(let e,t=0;e=n[t];t++)r.push(this.parse(e));return r}}},6161:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.isMembership=r.elligibleRightNeutral=r.elligibleLeftNeutral=r.compareNeutralFences=r.isNeutralFence=r.isImplicitOp=r.isImplicit=r.isPureUnit=r.isUnitCounter=r.isNumber=r.isSingletonSetContent=r.scriptedElement_=r.illegalSingleton_=r.isSetNode=r.isRightBrace=r.isLeftBrace=r.isSimpleFunction=r.singlePunctAtPosition=r.isSimpleFunctionHead=r.isLimitBase=r.isBinomial=r.lineIsLabelled=r.tableIsMultiline=r.tableIsCases=r.isFencedElement=r.tableIsMatrixOrVector=r.isTableOrMultiline=r.isElligibleEmbellishedFence=r.isFence=r.isPunctuation=r.isRelation=r.isOperator=r.isEmbellished=r.isGeneralFunctionBoundary=r.isIntegralDxBoundarySingle=r.isIntegralDxBoundary=r.isBigOpBoundary=r.isPrefixFunctionBoundary=r.isSimpleFunctionScope=r.isAccent=r.isRole=r.embellishedType=r.isType=void 0;const n=t(4020),i=t(8901);function o(e,t){return e.type===t}function s(e,t){return e.embellished===t}function a(e,t){return e.role===t}function l(e){return u(e)||d(e)}function c(e){return o(e,"operator")||s(e,"operator")}function u(e){return o(e,"relation")||s(e,"relation")}function d(e){return o(e,"punctuation")||s(e,"punctuation")}function p(e){return o(e,"fence")||s(e,"fence")}function h(e){return!!e&&(o(e,"table")||o(e,"multiline"))}function f(e){return!!e&&o(e,"fenced")&&(a(e,"leftright")||y(e))&&1===e.childNodes.length}function m(e){return!!e&&-1!==["{","﹛","｛"].indexOf(e.textContent)}function g(e){return!!e&&-1!==["}","﹜","｝"].indexOf(e.textContent)}function b(e){return"number"===e.type&&("integer"===e.role||"float"===e.role)}function y(e){return"neutral"===e.role||"metric"===e.role}r.isType=o,r.embellishedType=s,r.isRole=a,r.isAccent=function(e){var t=new RegExp("∞|᪲");return o(e,"fence")||o(e,"punctuation")||o(e,"operator")&&!e.textContent.match(t)||o(e,"relation")||o(e,"identifier")&&a(e,"unknown")&&!e.textContent.match(n.allLettersRegExp)&&!e.textContent.match(t)},r.isSimpleFunctionScope=function(e){e=e.childNodes;if(0===e.length)return!0;if(1<e.length)return!1;const t=e[0];if("infixop"===t.type){if("implicit"!==t.role)return!1;if(t.childNodes.some(e=>o(e,"infixop")))return!1}return!0},r.isPrefixFunctionBoundary=function(e){return c(e)&&!a(e,"division")||o(e,"appl")||l(e)},r.isBigOpBoundary=function(e){return c(e)||l(e)},r.isIntegralDxBoundary=function(e,t){return!!t&&o(t,"identifier")&&n.lookupSecondary("d",e.textContent)},r.isIntegralDxBoundarySingle=function(e){var t;return!!o(e,"identifier")&&((t=e.textContent[0])&&e.textContent[1]&&n.lookupSecondary("d",t))},r.isGeneralFunctionBoundary=l,r.isEmbellished=function(e){return e.embellished||(n.isEmbellishedType(e.type)?e.type:null)},r.isOperator=c,r.isRelation=u,r.isPunctuation=d,r.isFence=p,r.isElligibleEmbellishedFence=function(e){return!(!e||!p(e))&&(!e.embellished||function e(t){return!t.embellished||!(o(t,"tensor")&&(!o(t.childNodes[1],"empty")||!o(t.childNodes[2],"empty"))&&(!o(t.childNodes[3],"empty")||!o(t.childNodes[4],"empty")))&&(!a(t,"close")||!o(t,"tensor"))&&(!a(t,"open")||!o(t,"subscript")&&!o(t,"superscript"))&&e(t.childNodes[0])}(e))},r.isTableOrMultiline=h,r.tableIsMatrixOrVector=function(e){return!!e&&f(e)&&h(e.childNodes[0])},r.isFencedElement=f,r.tableIsCases=function(e,t){return 0<t.length&&a(t[t.length-1],"openfence")},r.tableIsMultiline=function(e){return e.childNodes.every(function(e){return e.childNodes.length<=1})},r.lineIsLabelled=function(e){return o(e,"line")&&e.contentNodes.length&&a(e.contentNodes[0],"label")},r.isBinomial=function(e){return 2===e.childNodes.length},r.isLimitBase=function e(t){return o(t,"largeop")||o(t,"limboth")||o(t,"limlower")||o(t,"limupper")||o(t,"function")&&a(t,"limit function")||(o(t,"overscore")||o(t,"underscore"))&&e(t.childNodes[0])},r.isSimpleFunctionHead=function(e){return"identifier"===e.type||"latinletter"===e.role||"greekletter"===e.role||"otherletter"===e.role},r.singlePunctAtPosition=function(e,t,n){return 1===t.length&&("punctuation"===e[n].type||"punctuation"===e[n].embellished)&&e[n]===t[0]},r.isSimpleFunction=function(e){return o(e,"identifier")&&a(e,"simple function")},r.isLeftBrace=m,r.isRightBrace=g,r.isSetNode=function(e){return m(e.contentNodes[0])&&g(e.contentNodes[1])},r.illegalSingleton_=["punctuation","punctuated","relseq","multirel","table","multiline","cases","inference"],r.scriptedElement_=["limupper","limlower","limboth","subscript","superscript","underscore","overscore","tensor"],r.isSingletonSetContent=function e(t){var n=t.type;return-1===r.illegalSingleton_.indexOf(n)&&("infixop"!==n||"implicit"===t.role)&&("fenced"===n?"leftright"!==t.role||e(t.childNodes[0]):-1===r.scriptedElement_.indexOf(n)||e(t.childNodes[0]))},r.isNumber=b,r.isUnitCounter=function(e){return b(e)||"vulgar"===e.role||"mixed"===e.role},r.isPureUnit=function(e){var t=e.childNodes;return"unit"===e.role&&(!t.length||"unit"===t[0].role)},r.isImplicit=function(e){return"implicit"===e.role||"unit"===e.role&&!!e.contentNodes.length&&e.contentNodes[0].textContent===n.invisibleTimes()},r.isImplicitOp=function(e){return"infixop"===e.type&&"implicit"===e.role},r.isNeutralFence=y,r.compareNeutralFences=function(e,t){return y(e)&&y(t)&&(0,i.getEmbellishedInner)(e).textContent===(0,i.getEmbellishedInner)(t).textContent},r.elligibleLeftNeutral=function(e){return!!y(e)&&(!e.embellished||"superscript"!==e.type&&"subscript"!==e.type&&("tensor"!==e.type||"empty"===e.childNodes[3].type&&"empty"===e.childNodes[4].type))},r.elligibleRightNeutral=function(e){return!!y(e)&&(!e.embellished||"tensor"!==e.type||"empty"===e.childNodes[1].type&&"empty"===e.childNodes[2].type)},r.isMembership=function(e){return["element","nonelement","reelement","renonelement"].includes(e.role)}},7793:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});const m=n(6671),a=n(4020),i=n(2721),r=n(4790),c=n(6161),u=n(8901);class g{constructor(){this.funcAppls={},this.factory_=new r.SemanticNodeFactory,i.updateFactory(this.factory_)}static getInstance(){return g.instance=g.instance||new g,g.instance}static tableToMultiline(n){if(c.tableIsMultiline(n)){n.type="multiline";for(let e,t=0;e=n.childNodes[t];t++)g.rowToLine_(e,"multiline");1===n.childNodes.length&&!c.lineIsLabelled(n.childNodes[0])&&c.isFencedElement(n.childNodes[0].childNodes[0])&&g.tableToMatrixOrVector_(g.rewriteFencedLine_(n)),g.binomialForm_(n),g.classifyMultiline(n)}else g.classifyTable(n)}static number(e){"unknown"!==e.type&&"identifier"!==e.type||(e.type="number"),g.numberRole_(e),g.exprFont_(e)}static classifyMultiline(e){let t=0;var n=e.childNodes.length;let r;for(;t<n&&(!(r=e.childNodes[t])||!r.childNodes.length);)t++;if(!(t>=n)){const i=r.childNodes[0].role;"unknown"!==i&&e.childNodes.every(function(e){e=e.childNodes[0];return!e||e.role===i&&(c.isType(e,"relation")||c.isType(e,"relseq"))})&&(e.role=i)}}static classifyTable(e){var t=g.computeColumns_(e);g.classifyByColumns_(e,t,"equality")||g.classifyByColumns_(e,t,"inequality",["equality"])||g.classifyByColumns_(e,t,"arrow")||g.detectCaleyTable(e)}static detectCaleyTable(e){if(!e.mathmlTree)return!1;const t=e.mathmlTree,n=t.getAttribute("columnlines"),r=t.getAttribute("rowlines");return!(!n||!r||!g.cayleySpacing(n)||!g.cayleySpacing(r)||(e.role="cayley",0))}static cayleySpacing(e){const t=e.split(" ");return("solid"===t[0]||"dashed"===t[0])&&t.slice(1).every(e=>"none"===e)}static proof(e,t,n){t=g.separateSemantics(t);return g.getInstance().proof(e,t,n)}static findSemantics(e,t,n){n=null==n?null:n,e=g.getSemantics(e);return!(!e||!e[t]||null!=n&&e[t]!==n)}static getSemantics(e){e=e.getAttribute("semantics");return e?g.separateSemantics(e):null}static removePrefix(e){const[,...t]=e.split("_");return t.join("_")}static separateSemantics(e){const n={};return e.split(";").forEach(function(e){var[e,t]=e.split(":");n[g.removePrefix(e)]=t}),n}static matchSpaces_(n,r){for(let e,t=0;e=r[t];t++){const r=n[t].mathmlTree,o=n[t+1].mathmlTree;var i;r&&o&&((i=r.nextSibling)&&i!==o&&(i=g.getSpacer_(i))&&(e.mathml.push(i),e.mathmlTree=i,e.role="space"))}}static getSpacer_(e){if("MSPACE"===m.tagName(e))return e;for(;u.hasEmptyTag(e)&&1===e.childNodes.length;)if(e=e.childNodes[0],"MSPACE"===m.tagName(e))return e;return null}static fenceToPunct_(e){var t=g.FENCE_TO_PUNCT_[e.role];if(t){for(;e.embellished;)e.embellished="punctuation",c.isRole(e,"subsup")||c.isRole(e,"underover")||(e.role=t),e=e.childNodes[0];e.type="punctuation",e.role=t}}static classifyFunction_(t,n){if("appl"===t.type||"bigop"===t.type||"integral"===t.type)return"";if(n[0]&&n[0].textContent===a.functionApplication()){g.getInstance().funcAppls[t.id]=n.shift();let e="simple function";return i.run("simple2prefix",t),"prefix function"!==t.role&&"limit function"!==t.role||(e=t.role),g.propagateFunctionRole_(t,e),"prefix"}return g.CLASSIFY_FUNCTION_[t.role]||(c.isSimpleFunctionHead(t)?"simple":"")}static propagateFunctionRole_(e,t){e&&"infixop"!==e.type&&(c.isRole(e,"subsup")||c.isRole(e,"underover")||(e.role=t),g.propagateFunctionRole_(e.childNodes[0],t))}static getFunctionOp_(n,r){if(r(n))return n;for(let e,t=0;e=n.childNodes[t];t++){const n=g.getFunctionOp_(e,r);if(n)return n}return null}static tableToMatrixOrVector_(e){const n=e.childNodes[0];c.isType(n,"multiline")?g.tableToVector_(e):g.tableToMatrix_(e),e.contentNodes.forEach(n.appendContentNode.bind(n));for(let e,t=0;e=n.childNodes[t];t++)g.assignRoleToRow_(e,g.getComponentRoles_(n));return n.parent=null,n}static tableToVector_(e){const t=e.childNodes[0];t.type="vector",1!==t.childNodes.length?g.binomialForm_(t):g.tableToSquare_(e)}static binomialForm_(e){c.isBinomial(e)&&(e.role="binomial",e.childNodes[0].role="binomial",e.childNodes[1].role="binomial")}static tableToMatrix_(e){const t=e.childNodes[0];t.type="matrix",t.childNodes&&0<t.childNodes.length&&t.childNodes[0].childNodes&&t.childNodes.length===t.childNodes[0].childNodes.length?g.tableToSquare_(e):t.childNodes&&1===t.childNodes.length&&(t.role="rowvector")}static tableToSquare_(e){const t=e.childNodes[0];c.isNeutralFence(e)?t.role="determinant":t.role="squarematrix"}static getComponentRoles_(e){var t=e.role;return t&&"unknown"!==t?t:e.type.toLowerCase()||"unknown"}static tableToCases_(n,e){for(let e,t=0;e=n.childNodes[t];t++)g.assignRoleToRow_(e,"cases");return n.type="cases",n.appendContentNode(e),c.tableIsMultiline(n)&&g.binomialForm_(n),n}static rewriteFencedLine_(e){const t=e.childNodes[0],n=e.childNodes[0].childNodes[0],r=e.childNodes[0].childNodes[0].childNodes[0];return n.parent=e.parent,e.parent=n,r.parent=t,n.childNodes=[e],t.childNodes=[r],n}static rowToLine_(t,e){e=e||"unknown";c.isType(t,"row")&&(t.type="line",t.role=e,1===t.childNodes.length&&c.isType(t.childNodes[0],"cell")&&(t.childNodes=t.childNodes[0].childNodes,t.childNodes.forEach(function(e){e.parent=t})))}static assignRoleToRow_(e,t){c.isType(e,"line")?e.role=t:c.isType(e,"row")&&(e.role=t,e.childNodes.forEach(function(e){c.isType(e,"cell")&&(e.role=t)}))}static nextSeparatorFunction_(e){let t;if(e){if(e.match(/^\s+$/))return null;t=e.replace(/\s/g,"").split("").filter(function(e){return e})}else t=[","];return function(){return 1<t.length?t.shift():t[0]}}static numberRole_(e){if("unknown"===e.role){const t=[...e.textContent].filter(e=>e.match(/[^\s]/)),n=t.map(a.lookupMeaning);if(n.every(function(e){return"number"===e.type&&"integer"===e.role||"punctuation"===e.type&&"comma"===e.role}))return e.role="integer",void("0"===t[0]&&e.addAnnotation("general","basenumber"));n.every(function(e){return"number"===e.type&&"integer"===e.role||"punctuation"===e.type})?e.role="float":e.role="othernumber"}}static exprFont_(e){var t;"unknown"===e.font&&(t=[...e.textContent].map(a.lookupMeaning).reduce(function(e,t){return e&&t.font&&"unknown"!==t.font&&t.font!==e?"unknown"===e?t.font:null:e},"unknown"))&&(e.font=t)}static purgeFences_(t){const n=t.rel,r=t.comp,i=[],o=[];for(;0<n.length;){const t=n.shift();let e=r.shift();c.isElligibleEmbellishedFence(t)?(i.push(t),o.push(e)):(g.fenceToPunct_(t),e.push(t),e=e.concat(r.shift()),r.unshift(e))}return o.push(r.shift()),{rel:i,comp:o}}static rewriteFencedNode_(e){var t=e.contentNodes[0],n=e.contentNodes[1];let r=g.rewriteFence_(e,t);return e.contentNodes[0]=r.fence,r=g.rewriteFence_(r.node,n),e.contentNodes[1]=r.fence,(e.contentNodes[0].parent=e).contentNodes[1].parent=e,r.node.parent=null,r.node}static rewriteFence_(e,t){if(!t.embellished)return{node:e,fence:t};const n=t.childNodes[0],r=g.rewriteFence_(e,n);return c.isType(t,"superscript")||c.isType(t,"subscript")||c.isType(t,"tensor")?(c.isRole(t,"subsup")||(t.role=e.role),n!==r.node&&(t.replaceChild(n,r.node),n.parent=e),g.propagateFencePointer_(t,n),{node:t,fence:r.fence}):(t.replaceChild(n,r.fence),t.mathmlTree&&-1===t.mathml.indexOf(t.mathmlTree)&&t.mathml.push(t.mathmlTree),{node:r.node,fence:t})}static propagateFencePointer_(e,t){e.fencePointer=t.fencePointer||t.id.toString(),e.embellished=null}static classifyByColumns_(e,t,n,r){return!!(3===t.length&&g.testColumns_(t,1,e=>g.isPureRelation_(e,n))||2===t.length&&(g.testColumns_(t,1,e=>g.isEndRelation_(e,n)||g.isPureRelation_(e,n))||g.testColumns_(t,0,e=>g.isEndRelation_(e,n,!0)||g.isPureRelation_(e,n))))&&(e.role=n,!0)}static isEndRelation_(e,t,n){n=n?e.childNodes.length-1:0;return c.isType(e,"relseq")&&c.isRole(e,t)&&c.isType(e.childNodes[n],"empty")}static isPureRelation_(e,t){return c.isType(e,"relation")&&c.isRole(e,t)}static computeColumns_(t){const r=[];for(let n,e=0;n=t.childNodes[e];e++)for(let e,t=0;e=n.childNodes[t];t++)r[t]?r[t].push(e):r[t]=[e];return r}static testColumns_(e,t,n){const r=e[t];return!!r&&r.some(function(e){return e.childNodes.length&&n(e.childNodes[0])})&&r.every(function(e){return!e.childNodes.length||n(e.childNodes[0])})}setNodeFactory(e){g.getInstance().factory_=e,i.updateFactory(g.getInstance().factory_)}getNodeFactory(){return g.getInstance().factory_}identifierNode(e,t,n){if("MathML-Unit"===n)e.type="identifier",e.role="unit";else if(!t&&1===e.textContent.length&&("integer"===e.role||"latinletter"===e.role||"greekletter"===e.role)&&"normal"===e.font)return e.font="italic",i.run("simpleNamedFunction",e);return"unknown"===e.type&&(e.type="identifier"),g.exprFont_(e),i.run("simpleNamedFunction",e)}implicitNode(e){if(e=g.getInstance().getMixedNumbers_(e),1===(e=g.getInstance().combineUnits_(e)).length)return e[0];e=g.getInstance().implicitNode_(e);return i.run("combine_juxtaposition",e)}text(e,t){return g.exprFont_(e),e.type="text","MS"===t?e.role="string":"MSPACE"!==t&&!e.textContent.match(/^\s*$/)||(e.role="space"),e}row(e){return 0===(e=e.filter(function(e){return!c.isType(e,"empty")})).length?g.getInstance().factory_.makeEmptyNode():(e=g.getInstance().getFencesInRow_(e),e=g.getInstance().tablesInRow(e),e=g.getInstance().getPunctuationInRow_(e),e=g.getInstance().getTextInRow_(e),e=g.getInstance().getFunctionsInRow_(e),g.getInstance().relationsInRow_(e))}limitNode(e,t){if(!t.length)return g.getInstance().factory_.makeEmptyNode();let n,r=t[0],i="unknown";if(!t[1])return r;if(c.isLimitBase(r)){var o=(n=g.MML_TO_LIMIT_[e]).length;if(i=n.type,t=t.slice(0,n.length+1),1===o&&c.isAccent(t[1])||2===o&&c.isAccent(t[1])&&c.isAccent(t[2]))return n=g.MML_TO_BOUNDS_[e],g.getInstance().accentNode_(r,t,n.type,n.length,n.accent);if(2===o){if(c.isAccent(t[1]))return r=g.getInstance().accentNode_(r,[r,t[1]],{MSUBSUP:"subscript",MUNDEROVER:"underscore"}[e],1,!0),t[2]?g.getInstance().makeLimitNode_(r,[r,t[2]],null,"limupper"):r;if(t[2]&&c.isAccent(t[2]))return r=g.getInstance().accentNode_(r,[r,t[2]],{MSUBSUP:"superscript",MUNDEROVER:"overscore"}[e],1,!0),g.getInstance().makeLimitNode_(r,[r,t[1]],null,"limlower");t[o]||(i="limlower")}return g.getInstance().makeLimitNode_(r,t,null,i)}return n=g.MML_TO_BOUNDS_[e],g.getInstance().accentNode_(r,t,n.type,n.length,n.accent)}tablesInRow(e){let n=u.partitionNodes(e,c.tableIsMatrixOrVector),r=[];for(let e,t=0;e=n.rel[t];t++)(r=r.concat(n.comp.shift())).push(g.tableToMatrixOrVector_(e));r=r.concat(n.comp.shift()),n=u.partitionNodes(r,c.isTableOrMultiline),r=[];for(let e,t=0;e=n.rel[t];t++){const i=n.comp.shift();c.tableIsCases(e,i)&&g.tableToCases_(e,i.pop()),(r=r.concat(i)).push(e)}return r.concat(n.comp.shift())}mfenced(t,n,e,r){if(e&&0<r.length){const t=g.nextSeparatorFunction_(e),n=[r.shift()];r.forEach(e=>{n.push(g.getInstance().factory_.makeContentNode(t())),n.push(e)}),r=n}return t&&n?g.getInstance().horizontalFencedNode_(g.getInstance().factory_.makeContentNode(t),g.getInstance().factory_.makeContentNode(n),r):(t&&r.unshift(g.getInstance().factory_.makeContentNode(t)),n&&r.push(g.getInstance().factory_.makeContentNode(n)),g.getInstance().row(r))}fractionLikeNode(e,t,n,r){let i;if(r||!u.isZeroLength(n))return i=g.getInstance().fractionNode_(e,t),r&&i.addAnnotation("general","bevelled"),i;{const n=g.getInstance().factory_.makeBranchNode("line",[e],[]),r=g.getInstance().factory_.makeBranchNode("line",[t],[]);return i=g.getInstance().factory_.makeBranchNode("multiline",[n,r],[]),g.binomialForm_(i),g.classifyMultiline(i),i}}tensor(e,t,n,r,i){const o=g.getInstance().factory_.makeBranchNode("tensor",[e,g.getInstance().scriptNode_(t,"leftsub"),g.getInstance().scriptNode_(n,"leftsuper"),g.getInstance().scriptNode_(r,"rightsub"),g.getInstance().scriptNode_(i,"rightsuper")],[]);return o.role=e.role,o.embellished=c.isEmbellished(e),o}pseudoTensor(e,t,n){var r=e=>!c.isType(e,"empty"),i=t.filter(r).length,r=n.filter(r).length;if(!i&&!r)return e;const o=i?r?"MSUBSUP":"MSUB":"MSUP",s=[e];return i&&s.push(g.getInstance().scriptNode_(t,"rightsub",!0)),r&&s.push(g.getInstance().scriptNode_(n,"rightsuper",!0)),g.getInstance().limitNode(o,s)}font(e){return g.MATHJAX_FONTS[e]||e}proof(e,t,n){if(t.inference||t.axiom||console.log("Noise"),t.axiom){const t=g.getInstance().cleanInference(e.childNodes),r=t.length?g.getInstance().factory_.makeBranchNode("inference",n(t),[]):g.getInstance().factory_.makeEmptyNode();return r.role="axiom",r.mathmlTree=e,r}const r=g.getInstance().inference(e,t,n);return t.proof&&(r.role="proof",r.childNodes[0].role="final"),r}inference(e,t,n){if(t.inferenceRule){const t=g.getInstance().getFormulas(e,[],n);return g.getInstance().factory_.makeBranchNode("inference",[t.conclusion,t.premises],[])}const r=t.labelledRule,i=m.toArray(e.childNodes),o=[],s=("left"!==r&&"both"!==r||o.push(g.getInstance().getLabel(e,i,n,"left")),"right"!==r&&"both"!==r||o.push(g.getInstance().getLabel(e,i,n,"right")),g.getInstance().getFormulas(e,i,n)),a=g.getInstance().factory_.makeBranchNode("inference",[s.conclusion,s.premises],o);return a.mathmlTree=e,a}getLabel(e,t,n,r){const i=g.getInstance().findNestedRow(t,"prooflabel",r),o=g.getInstance().factory_.makeBranchNode("rulelabel",n(m.toArray(i.childNodes)),[]);return o.role=r,o.mathmlTree=i,o}getFormulas(e,t,n){const r=t.length?g.getInstance().findNestedRow(t,"inferenceRule"):e,i="up"===g.getSemantics(r).inferenceRule,o=i?r.childNodes[1]:r.childNodes[0],s=i?r.childNodes[0]:r.childNodes[1],a=o.childNodes[0].childNodes[0],l=m.toArray(a.childNodes[0].childNodes),c=[];let u=1;for(const e of l)u%2&&c.push(e.childNodes[0]),u++;const d=n(c),p=n(m.toArray(s.childNodes[0].childNodes))[0],h=g.getInstance().factory_.makeBranchNode("premises",d,[]),f=(h.mathmlTree=a,g.getInstance().factory_.makeBranchNode("conclusion",[p],[]));return f.mathmlTree=s.childNodes[0].childNodes[0],{conclusion:f,premises:h}}findNestedRow(e,t,n){return g.getInstance().findNestedRow_(e,t,0,n)}cleanInference(e){return m.toArray(e).filter(function(e){return"MSPACE"!==m.tagName(e)})}operatorNode(e){return"unknown"===e.type&&(e.type="operator"),i.run("multioperator",e)}implicitNode_(e){const t=g.getInstance().factory_.makeMultipleContentNodes(e.length-1,a.invisibleTimes()),n=(g.matchSpaces_(e,t),g.getInstance().infixNode_(e,t[0]));return n.role="implicit",t.forEach(function(e){e.parent=n}),n.contentNodes=t,n}infixNode_(e,t){const n=g.getInstance().factory_.makeBranchNode("infixop",e,[t],u.getEmbellishedInner(t).textContent);return n.role=t.role,i.run("propagateSimpleFunction",n)}explicitMixed_(n){var r=u.partitionNodes(n,function(e){return e.textContent===a.invisiblePlus()});if(!r.rel.length)return n;let i=[];for(let e,t=0;e=r.rel[t];t++){const a=r.comp[t],o=r.comp[t+1],s=a.length-1;if(a[s]&&o[0]&&c.isType(a[s],"number")&&!c.isRole(a[s],"mixed")&&c.isType(o[0],"fraction")){const n=g.getInstance().factory_.makeBranchNode("number",[a[s],o[0]],[]);n.role="mixed",(i=i.concat(a.slice(0,s))).push(n),o.shift()}else(i=i.concat(a)).push(e)}return i.concat(r.comp[r.comp.length-1])}concatNode_(e,t,n){if(0===t.length)return e;const r=t.map(function(e){return u.getEmbellishedInner(e).textContent}).join(" "),i=g.getInstance().factory_.makeBranchNode(n,[e],t,r);return 1<t.length&&(i.role="multiop"),i}prefixNode_(e,t){const n=u.partitionNodes(t,e=>c.isRole(e,"subtraction"));let r=g.getInstance().concatNode_(e,n.comp.pop(),"prefixop");for(1===r.contentNodes.length&&"addition"===r.contentNodes[0].role&&"+"===r.contentNodes[0].textContent&&(r.role="positive");0<n.rel.length;)(r=g.getInstance().concatNode_(r,[n.rel.pop()],"prefixop")).role="negative",r=g.getInstance().concatNode_(r,n.comp.pop(),"prefixop");return r}postfixNode_(e,t){return t.length?g.getInstance().concatNode_(e,t,"postfixop"):e}combineUnits_(t){const n=u.partitionNodes(t,function(e){return!c.isRole(e,"unit")});if(t.length===n.rel.length)return n.rel;const r=[];var i,o;do{const t=n.comp.shift();i=n.rel.shift();let e=null;(o=r.pop())&&(t.length&&c.isUnitCounter(o)?t.unshift(o):r.push(o)),1===t.length&&(e=t.pop()),1<t.length&&((e=g.getInstance().implicitNode_(t)).role="unit"),e&&r.push(e),i&&r.push(i)}while(i);return r}getMixedNumbers_(e){const n=u.partitionNodes(e,function(e){return c.isType(e,"fraction")&&c.isRole(e,"vulgar")});if(!n.rel.length)return e;let r=[];for(let e,t=0;e=n.rel[t];t++){const i=n.comp[t],o=i.length-1;if(i[o]&&c.isType(i[o],"number")&&(c.isRole(i[o],"integer")||c.isRole(i[o],"float"))){const n=g.getInstance().factory_.makeBranchNode("number",[i[o],e],[]);n.role="mixed",(r=r.concat(i.slice(0,o))).push(n)}else(r=r.concat(i)).push(e)}return r.concat(n.comp[n.comp.length-1])}getTextInRow_(e){if(e.length<=1)return e;var n=u.partitionNodes(e,e=>c.isType(e,"text"));if(0===n.rel.length)return e;const r=[];let i=n.comp[0];0<i.length&&r.push(g.getInstance().row(i));for(let e,t=0;e=n.rel[t];t++)r.push(e),0<(i=n.comp[t+1]).length&&r.push(g.getInstance().row(i));return[g.getInstance().dummyNode_(r)]}relationsInRow_(e){const t=u.partitionNodes(e,c.isRelation),n=t.rel[0];if(!n)return g.getInstance().operationsInRow_(e);if(1===e.length)return e[0];e=t.comp.map(g.getInstance().operationsInRow_);let r;return t.rel.some(function(e){return!e.equals(n)})?(r=g.getInstance().factory_.makeBranchNode("multirel",e,t.rel),t.rel.every(function(e){return e.role===n.role})&&(r.role=n.role)):(r=g.getInstance().factory_.makeBranchNode("relseq",e,t.rel,u.getEmbellishedInner(n).textContent)).role=n.role,r}operationsInRow_(e){if(0===e.length)return g.getInstance().factory_.makeEmptyNode();if(1===(e=g.getInstance().explicitMixed_(e)).length)return e[0];const t=[];for(;0<e.length&&c.isOperator(e[0]);)t.push(e.shift());if(0===e.length)return g.getInstance().prefixNode_(t.pop(),t);if(1===e.length)return g.getInstance().prefixNode_(e[0],t);e=i.run("convert_juxtaposition",e);var n=u.sliceNodes(e,c.isOperator),r=g.getInstance().prefixNode_(g.getInstance().implicitNode(n.head),t);return n.div?g.getInstance().operationsTree_(n.tail,r,n.div):r}operationsTree_(e,t,n,r){const i=r||[];if(0===e.length){if(i.unshift(n),"infixop"!==t.type)return g.getInstance().postfixNode_(t,i);{const e=g.getInstance().postfixNode_(t.childNodes.pop(),i);return t.appendChild(e),t}}r=u.sliceNodes(e,c.isOperator);if(0===r.head.length)return i.push(r.div),g.getInstance().operationsTree_(r.tail,t,n,i);e=g.getInstance().prefixNode_(g.getInstance().implicitNode(r.head),i),t=g.getInstance().appendOperand_(t,n,e);return r.div?g.getInstance().operationsTree_(r.tail,t,r.div,[]):t}appendOperand_(e,t,n){return"infixop"!==e.type?g.getInstance().infixNode_([e,n],t):g.getInstance().appendDivisionOp_(e,t,n)||(g.getInstance().appendExistingOperator_(e,t,n)?e:"multiplication"===t.role?g.getInstance().appendMultiplicativeOp_(e,t,n):g.getInstance().appendAdditiveOp_(e,t,n))}appendDivisionOp_(e,t,n){return"division"===t.role?c.isImplicit(e)?g.getInstance().infixNode_([e,n],t):g.getInstance().appendLastOperand_(e,t,n):"division"===e.role?g.getInstance().infixNode_([e,n],t):null}appendLastOperand_(e,t,n){let r=e,i=e.childNodes[e.childNodes.length-1];for(;i&&"infixop"===i.type&&!c.isImplicit(i);)i=(r=i).childNodes[e.childNodes.length-1];n=g.getInstance().infixNode_([r.childNodes.pop(),n],t);return r.appendChild(n),e}appendMultiplicativeOp_(e,t,n){if(c.isImplicit(e))return g.getInstance().infixNode_([e,n],t);let r=e,i=e.childNodes[e.childNodes.length-1];for(;i&&"infixop"===i.type&&!c.isImplicit(i);)i=(r=i).childNodes[e.childNodes.length-1];n=g.getInstance().infixNode_([r.childNodes.pop(),n],t);return r.appendChild(n),e}appendAdditiveOp_(e,t,n){return g.getInstance().infixNode_([e,n],t)}appendExistingOperator_(e,t,n){return!(!e||"infixop"!==e.type||c.isImplicit(e))&&(e.contentNodes[0].equals(t)?(e.appendContentNode(t),e.appendChild(n),!0):g.getInstance().appendExistingOperator_(e.childNodes[e.childNodes.length-1],t,n))}getFencesInRow_(e){let t=u.partitionNodes(e,c.isFence);e=(t=g.purgeFences_(t)).comp.shift();return g.getInstance().fences_(t.rel,t.comp,[],[e])}fences_(e,t,n,r){if(0===e.length&&0===n.length)return r[0];const i=e=>c.isRole(e,"open");if(0===e.length){const e=r.shift();for(;0<n.length;){if(i(n[0])){const t=n.shift();g.fenceToPunct_(t),e.push(t)}else{const t=u.sliceNodes(n,i),o=t.head.length-1,s=g.getInstance().neutralFences_(t.head,r.slice(0,o));r=r.slice(o),e.push(...s),t.div&&t.tail.unshift(t.div),n=t.tail}e.push(...r.shift())}return e}const o=n[n.length-1],s=e[0].role;if("open"===s||c.isNeutralFence(e[0])&&(!o||!c.compareNeutralFences(e[0],o))){n.push(e.shift());const i=t.shift();return i&&r.push(i),g.getInstance().fences_(e,t,n,r)}if(o&&"close"===s&&"open"===o.role){const i=g.getInstance().horizontalFencedNode_(n.pop(),e.shift(),r.pop());return r.push(r.pop().concat([i],t.shift())),g.getInstance().fences_(e,t,n,r)}if(o&&c.compareNeutralFences(e[0],o)){if(!c.elligibleLeftNeutral(o)||!c.elligibleRightNeutral(e[0])){n.push(e.shift());const i=t.shift();return i&&r.push(i),g.getInstance().fences_(e,t,n,r)}const i=g.getInstance().horizontalFencedNode_(n.pop(),e.shift(),r.pop());return r.push(r.pop().concat([i],t.shift())),g.getInstance().fences_(e,t,n,r)}if(o&&"close"===s&&c.isNeutralFence(o)&&n.some(i)){const o=u.sliceNodes(n,i,!0),s=r.pop(),c=r.length-o.tail.length+1,l=g.getInstance().neutralFences_(o.tail,r.slice(c));r=r.slice(0,c);var a=g.getInstance().horizontalFencedNode_(o.div,e.shift(),r.pop().concat(l,s));return r.push(r.pop().concat([a],t.shift())),g.getInstance().fences_(e,t,o.head,r)}const l=e.shift();return g.fenceToPunct_(l),r.push(r.pop().concat([l],t.shift())),g.getInstance().fences_(e,t,n,r)}neutralFences_(e,t){if(0===e.length)return e;if(1===e.length)return g.fenceToPunct_(e[0]),e;const n=e.shift();if(!c.elligibleLeftNeutral(n)){g.fenceToPunct_(n);const r=t.shift();return r.unshift(n),r.concat(g.getInstance().neutralFences_(e,t))}const r=u.sliceNodes(e,function(e){return c.compareNeutralFences(e,n)});if(!r.div){g.fenceToPunct_(n);const r=t.shift();return r.unshift(n),r.concat(g.getInstance().neutralFences_(e,t))}if(!c.elligibleRightNeutral(r.div))return g.fenceToPunct_(r.div),e.unshift(n),g.getInstance().neutralFences_(e,t);const i=g.getInstance().combineFencedContent_(n,r.div,r.head,t);if(0<r.tail.length){const e=i.shift(),t=g.getInstance().neutralFences_(r.tail,i);return e.concat(t)}return i[0]}combineFencedContent_(e,t,n,r){if(0===n.length){const n=g.getInstance().horizontalFencedNode_(e,t,r.shift());return 0<r.length?r[0].unshift(n):r=[[n]],r}const i=r.shift(),o=n.length-1,s=r.slice(0,o),a=(r=r.slice(o)).shift(),l=g.getInstance().neutralFences_(n,s);i.push(...l),i.push(...a);n=g.getInstance().horizontalFencedNode_(e,t,i);return 0<r.length?r[0].unshift(n):r=[[n]],r}horizontalFencedNode_(e,t,n){n=g.getInstance().row(n);let r=g.getInstance().factory_.makeBranchNode("fenced",[n],[e,t]);return"open"===e.role?(g.getInstance().classifyHorizontalFence_(r),r=i.run("propagateComposedFunction",r)):r.role=e.role,r=i.run("detect_cycle",r),g.rewriteFencedNode_(r)}classifyHorizontalFence_(e){e.role="leftright";var t=e.childNodes;if(c.isSetNode(e)&&!(1<t.length))if(0===t.length||"empty"===t[0].type)e.role="set empty";else{var n=t[0].type;if(1===t.length&&c.isSingletonSetContent(t[0]))e.role="set singleton";else{var r=t[0].role;if("punctuated"===n&&"sequence"===r){if("comma"!==t[0].contentNodes[0].role)return 1!==t[0].contentNodes.length||"vbar"!==t[0].contentNodes[0].role&&"colon"!==t[0].contentNodes[0].role?void 0:(e.role="set extended",void g.getInstance().setExtension_(e));e.role="set collection"}}}}setExtension_(e){const t=e.childNodes[0].childNodes[0];t&&"infixop"===t.type&&1===t.contentNodes.length&&c.isMembership(t.contentNodes[0])&&(t.addAnnotation("set","intensional"),t.contentNodes[0].addAnnotation("set","intensional"))}getPunctuationInRow_(n){if(n.length<=1)return n;const r=e=>{e=e.type;return"punctuation"===e||"text"===e||"operator"===e||"relation"===e},e=u.partitionNodes(n,function(e){if(!c.isPunctuation(e))return!1;if(c.isPunctuation(e)&&!c.isRole(e,"ellipsis"))return!0;e=n.indexOf(e);if(0===e)return!n[1]||!r(n[1]);var t=n[e-1];if(e===n.length-1)return!r(t);e=n[e+1];return!r(t)||!r(e)});if(0===e.rel.length)return n;const t=[];let i=e.comp.shift(),o=(0<i.length&&t.push(g.getInstance().row(i)),0);for(;0<e.comp.length;)t.push(e.rel[o++]),0<(i=e.comp.shift()).length&&t.push(g.getInstance().row(i));return[g.getInstance().punctuatedNode_(t,e.rel)]}punctuatedNode_(t,e){const n=g.getInstance().factory_.makeBranchNode("punctuated",t,e);if(e.length===t.length){const t=e[0].role;if("unknown"!==t&&e.every(function(e){return e.role===t}))return n.role=t,n}return c.singlePunctAtPosition(t,e,0)?n.role="startpunct":c.singlePunctAtPosition(t,e,t.length-1)?n.role="endpunct":e.every(e=>c.isRole(e,"dummy"))?n.role="text":e.every(e=>c.isRole(e,"space"))?n.role="space":n.role="sequence",n}dummyNode_(e){const t=g.getInstance().factory_.makeMultipleContentNodes(e.length-1,a.invisibleComma());return t.forEach(function(e){e.role="dummy"}),g.getInstance().punctuatedNode_(e,t)}accentRole_(e,t){if(!c.isAccent(e))return!1;var n=e.textContent,n=a.lookupSecondary("bar",n)||a.lookupSecondary("tilde",n)||e.role;return e.role="underscore"===t?"underaccent":"overaccent",e.addAnnotation("accent",n),!0}accentNode_(e,t,n,r,i){var o=(t=t.slice(0,r+1))[1],s=t[2];let a;if(!i&&s&&((a=g.getInstance().factory_.makeBranchNode("subscript",[e,o],[])).role="subsup",t=[a,s],n="superscript"),i){const r=g.getInstance().accentRole_(o,n);s&&(n=g.getInstance().accentRole_(s,"overscore")&&!r?(t=[a=g.getInstance().factory_.makeBranchNode("overscore",[e,s],[]),o],"underscore"):(t=[a=g.getInstance().factory_.makeBranchNode("underscore",[e,o],[]),s],"overscore"),a.role="underover")}return g.getInstance().makeLimitNode_(e,t,a,n)}makeLimitNode_(e,t,n,r){if("limupper"===r&&"limlower"===e.type)return e.childNodes.push(t[1]),(t[1].parent=e).type="limboth",e;if("limlower"===r&&"limupper"===e.type)return e.childNodes.splice(1,-1,t[1]),(t[1].parent=e).type="limboth",e;const i=g.getInstance().factory_.makeBranchNode(r,t,[]),o=c.isEmbellished(e);return n&&(n.embellished=o),i.embellished=o,i.role=e.role,i}getFunctionsInRow_(e,t){const n=t||[];if(0===e.length)return n;var t=e.shift(),r=g.classifyFunction_(t,e);if(!r)return n.push(t),g.getInstance().getFunctionsInRow_(e,n);e=g.getInstance().getFunctionsInRow_(e,[]),t=g.getInstance().getFunctionArgs_(t,e,r);return n.concat(t)}getFunctionArgs_(e,t,n){let r,i,o;switch(n){case"integral":{const n=g.getInstance().getIntegralArgs_(t);if(!n.intvar&&!n.integrand.length)return n.rest.unshift(e),n.rest;const r=g.getInstance().row(n.integrand);return o=g.getInstance().integralNode_(e,r,n.intvar),n.rest.unshift(o),n.rest}case"prefix":if(t[0]&&"fenced"===t[0].type){const n=t.shift();return c.isNeutralFence(n)||(n.role="leftright"),o=g.getInstance().functionNode_(e,n),t.unshift(o),t}if((r=u.sliceNodes(t,c.isPrefixFunctionBoundary)).head.length)i=g.getInstance().row(r.head),r.div&&r.tail.unshift(r.div);else{if(!r.div||!c.isType(r.div,"appl"))return t.unshift(e),t;i=r.div}return o=g.getInstance().functionNode_(e,i),r.tail.unshift(o),r.tail;case"bigop":return(r=u.sliceNodes(t,c.isBigOpBoundary)).head.length?(i=g.getInstance().row(r.head),o=g.getInstance().bigOpNode_(e,i),r.div&&r.tail.unshift(r.div),r.tail.unshift(o),r.tail):(t.unshift(e),t);default:{if(0===t.length)return[e];const n=t[0];return"fenced"===n.type&&!c.isNeutralFence(n)&&c.isSimpleFunctionScope(n)?(n.role="leftright",g.propagateFunctionRole_(e,"simple function"),o=g.getInstance().functionNode_(e,t.shift()),t.unshift(o)):t.unshift(e),t}}}getIntegralArgs_(e,t=[]){if(0===e.length)return{integrand:t,intvar:null,rest:e};const n=e[0];if(c.isGeneralFunctionBoundary(n))return{integrand:t,intvar:null,rest:e};if(c.isIntegralDxBoundarySingle(n))return n.role="integral",{integrand:t,intvar:n,rest:e.slice(1)};if(e[1]&&c.isIntegralDxBoundary(n,e[1])){const r=g.getInstance().prefixNode_(e[1],[n]);return r.role="integral",{integrand:t,intvar:r,rest:e.slice(2)}}return t.push(e.shift()),g.getInstance().getIntegralArgs_(e,t)}functionNode_(e,t){const n=g.getInstance().factory_.makeContentNode(a.functionApplication()),r=g.getInstance().funcAppls[e.id];r&&(n.mathmlTree=r.mathmlTree,n.mathml=r.mathml,n.annotation=r.annotation,n.attributes=r.attributes,delete g.getInstance().funcAppls[e.id]),n.type="punctuation",n.role="application";var i=g.getFunctionOp_(e,function(e){return c.isType(e,"function")||c.isType(e,"identifier")&&c.isRole(e,"simple function")});return g.getInstance().functionalNode_("appl",[e,t],i,[n])}bigOpNode_(e,t){var n=g.getFunctionOp_(e,e=>c.isType(e,"largeop"));return g.getInstance().functionalNode_("bigop",[e,t],n,[])}integralNode_(e,t,n){t=t||g.getInstance().factory_.makeEmptyNode(),n=n||g.getInstance().factory_.makeEmptyNode();var r=g.getFunctionOp_(e,e=>c.isType(e,"largeop"));return g.getInstance().functionalNode_("integral",[e,t,n],r,[])}functionalNode_(e,t,n,r){var i=t[0];let o;n&&(o=n.parent,r.push(n));const s=g.getInstance().factory_.makeBranchNode(e,t,r);return s.role=i.role,o&&(n.parent=o),s}fractionNode_(e,t){const n=g.getInstance().factory_.makeBranchNode("fraction",[e,t],[]);return n.role=n.childNodes.every(function(e){return c.isType(e,"number")&&c.isRole(e,"integer")})?"vulgar":n.childNodes.every(c.isPureUnit)?"unit":"division",i.run("propagateSimpleFunction",n)}scriptNode_(e,t,n){let r;switch(e.length){case 0:r=g.getInstance().factory_.makeEmptyNode();break;case 1:if(r=e[0],n)return r;break;default:r=g.getInstance().dummyNode_(e)}return r.role=t,r}findNestedRow_(n,r,i,o){if(3<i)return null;for(let e,t=0;e=n[t];t++){const n=m.tagName(e);if("MSPACE"!==n){if("MROW"===n)return g.getInstance().findNestedRow_(m.toArray(e.childNodes),r,i+1,o);if(g.findSemantics(e,r,o))return e}}return null}}(t.default=g).FENCE_TO_PUNCT_={metric:"metric",neutral:"vbar",open:"openfence",close:"closefence"},g.MML_TO_LIMIT_={MSUB:{type:"limlower",length:1},MUNDER:{type:"limlower",length:1},MSUP:{type:"limupper",length:1},MOVER:{type:"limupper",length:1},MSUBSUP:{type:"limboth",length:2},MUNDEROVER:{type:"limboth",length:2}},g.MML_TO_BOUNDS_={MSUB:{type:"subscript",length:1,accent:!1},MSUP:{type:"superscript",length:1,accent:!1},MSUBSUP:{type:"subscript",length:2,accent:!1},MUNDER:{type:"underscore",length:1,accent:!0},MOVER:{type:"overscore",length:1,accent:!0},MUNDEROVER:{type:"underscore",length:2,accent:!0}},g.CLASSIFY_FUNCTION_={integral:"integral",sum:"bigop","prefix function":"prefix","limit function":"prefix","simple function":"prefix","composed function":"prefix"},g.MATHJAX_FONTS={"-tex-caligraphic":"caligraphic","-tex-caligraphic-bold":"caligraphic-bold","-tex-calligraphic":"caligraphic","-tex-calligraphic-bold":"caligraphic-bold","-tex-oldstyle":"oldstyle","-tex-oldstyle-bold":"oldstyle-bold","-tex-mathit":"italic"}},7984:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticSkeleton=void 0;const r=n(1426),s=n(5024),a=n(8171);class l{constructor(e){this.parents=null,this.levelsMap=null,this.array=e=0===e?e:e||[]}static fromTree(e){return l.fromNode(e.root)}static fromNode(e){return new l(l.fromNode_(e))}static fromString(e){return new l(l.fromString_(e))}static simpleCollapseStructure(e){return"number"==typeof e}static contentCollapseStructure(e){return!!e&&!l.simpleCollapseStructure(e)&&"c"===e[0]}static interleaveIds(e,t){return r.interleaveLists(l.collapsedLeafs(e),l.collapsedLeafs(t))}static collapsedLeafs(...e){return e.reduce((e,t)=>{return e.concat((e=t,l.simpleCollapseStructure(e)?[e]:l.contentCollapseStructure(e[1])?e.slice(2):e.slice(1)))},[])}static fromStructure(e,t){return new l(l.tree_(e,t.root))}static combineContentChildren(e,t,n){switch(e.type){case"relseq":case"infixop":case"multirel":return r.interleaveLists(n,t);case"prefixop":return t.concat(n);case"postfixop":return n.concat(t);case"fenced":return n.unshift(t[0]),n.push(t[1]),n;case"appl":return[n[0],t[0],n[1]];case"root":return[n[1],n[0]];case"row":case"line":return t.length&&n.unshift(t[0]),n;default:return n}}static makeSexp_(e){return l.simpleCollapseStructure(e)?e.toString():l.contentCollapseStructure(e)?"(c "+e.slice(1).map(l.makeSexp_).join(" ")+")":"("+e.map(l.makeSexp_).join(" ")+")"}static fromString_(e){let t=e.replace(/\(/g,"[");return t=(t=(t=t.replace(/\)/g,"]")).replace(/ /g,",")).replace(/c/g,'"c"'),JSON.parse(t)}static fromNode_(e){if(!e)return[];const t=e.contentNodes;let n;t.length&&(n=t.map(l.fromNode_)).unshift("c");const r=e.childNodes;if(!r.length)return t.length?[e.id,n]:e.id;const i=r.map(l.fromNode_);return t.length&&i.unshift(n),i.unshift(e.id),i}static tree_(n,e){if(!e)return[];if(!e.childNodes.length)return e.id;const t=e.id,r=[t],i=s.evalXPath(`.//self::*[@${a.Attribute.ID}=${t}]`,n)[0],o=l.combineContentChildren(e,e.contentNodes.map(function(e){return e}),e.childNodes.map(function(e){return e}));i&&l.addOwns_(i,o);for(let e,t=0;e=o[t];t++)r.push(l.tree_(n,e));return r}static addOwns_(e,t){const n=e.getAttribute(a.Attribute.COLLAPSED),r=n?l.realLeafs_(l.fromString(n).array):t.map(e=>e.id);e.setAttribute(a.Attribute.OWNS,r.join(" "))}static realLeafs_(t){if(l.simpleCollapseStructure(t))return[t];if(l.contentCollapseStructure(t))return[];let n=[];for(let e=1;e<t.length;e++)n=n.concat(l.realLeafs_(t[e]));return n}populate(){this.parents&&this.levelsMap||(this.parents={},this.levelsMap={},this.populate_(this.array,this.array,[]))}toString(){return l.makeSexp_(this.array)}populate_(n,e,r){if(l.simpleCollapseStructure(n))return this.levelsMap[n]=e,void(this.parents[n]=n===r[0]?r.slice(1):r);const i=l.contentCollapseStructure(n)?n.slice(1):n,o=[i[0]].concat(r);for(let e=0,t=i.length;e<t;e++){const r=i[e];this.populate_(r,n,o)}}isRoot(e){return e===this.levelsMap[e][0]}directChildren(e){return this.isRoot(e)?this.levelsMap[e].slice(1).map(e=>l.simpleCollapseStructure(e)?e:l.contentCollapseStructure(e)?e[1]:e[0]):[]}subtreeNodes(e){if(!this.isRoot(e))return[];const n=(e,t)=>{l.simpleCollapseStructure(e)?t.push(e):(e=l.contentCollapseStructure(e)?e.slice(1):e).forEach(e=>n(e,t))},t=this.levelsMap[e],r=[];return n(t.slice(1),r),r}}t.SemanticSkeleton=l},1784:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTree=void 0;const r=n(6671),i=n(4036),o=n(241),s=n(8122),a=n(9444),l=n(6161);n(7103);class c{constructor(e){this.mathml=e,this.parser=new s.SemanticMathml,this.root=this.parser.parse(e),this.collator=this.parser.getFactory().leafMap.collateMeaning();var t=this.collator.newDefault();t&&(this.parser=new s.SemanticMathml,this.parser.getFactory().defaultMap=t,this.root=this.parser.parse(e)),u.visit(this.root,{}),(0,i.annotate)(this.root)}static empty(){const e=r.parseInput("<math/>"),t=new c(e);return t.mathml=e,t}static fromNode(e,t){const n=c.empty();return n.root=e,t&&(n.mathml=t),n}static fromRoot(e,t){let n=e;for(;n.parent;)n=n.parent;const r=c.fromNode(n);return t&&(r.mathml=t),r}static fromXml(e){const t=c.empty();return e.childNodes[0]&&(t.root=a.SemanticNode.fromXml(e.childNodes[0])),t}xml(e){const t=r.parseInput("<stree></stree>"),n=this.root.xml(t.ownerDocument,e);return t.appendChild(n),t}toString(e){return r.serializeXml(this.xml(e))}formatXml(e){e=this.toString(e);return r.formatXml(e)}displayTree(){this.root.displayTree()}replaceNode(e,t){const n=e.parent;n?n.replaceChild(e,t):this.root=t}toJson(){const e={};return e.stree=this.root.toJson(),e}}t.SemanticTree=c;const u=new o.SemanticVisitor("general","unit",(e,t)=>{if("infixop"===e.type&&("multiplication"===e.role||"implicit"===e.role)){const t=e.childNodes;t.length&&(l.isPureUnit(t[0])||l.isUnitCounter(t[0]))&&e.childNodes.slice(1).every(l.isPureUnit)&&(e.role="unit")}return!1})},8901:function(e,i,t){Object.defineProperty(i,"__esModule",{value:!0}),i.partitionNodes=i.sliceNodes=i.getEmbellishedInner=i.addAttributes=i.isZeroLength=i.purgeNodes=i.isOrphanedGlyph=i.hasDisplayTag=i.hasEmptyTag=i.hasIgnoreTag=i.hasLeafTag=i.hasMathTag=i.directSpeechKeys=i.DISPLAYTAGS=i.EMPTYTAGS=i.IGNORETAGS=i.LEAFTAGS=void 0;const o=t(6671);function n(e){return!!e&&-1!==i.LEAFTAGS.indexOf(o.tagName(e))}function s(n,r,i){i&&n.reverse();const o=[];for(let e,t=0;e=n[t];t++){if(r(e))return i?{head:n.slice(t+1).reverse(),div:e,tail:o.reverse()}:{head:o,div:e,tail:n.slice(t+1)};o.push(e)}return i?{head:[],div:null,tail:o.reverse()}:{head:o,div:null,tail:[]}}i.LEAFTAGS=["MO","MI","MN","MTEXT","MS","MSPACE"],i.IGNORETAGS=["MERROR","MPHANTOM","MALIGNGROUP","MALIGNMARK","MPRESCRIPTS","ANNOTATION","ANNOTATION-XML"],i.EMPTYTAGS=["MATH","MROW","MPADDED","MACTION","NONE","MSTYLE","SEMANTICS"],i.DISPLAYTAGS=["MROOT","MSQRT"],i.directSpeechKeys=["aria-label","exact-speech","alt"],i.hasMathTag=function(e){return!!e&&"MATH"===o.tagName(e)},i.hasLeafTag=n,i.hasIgnoreTag=function(e){return!!e&&-1!==i.IGNORETAGS.indexOf(o.tagName(e))},i.hasEmptyTag=function(e){return!!e&&-1!==i.EMPTYTAGS.indexOf(o.tagName(e))},i.hasDisplayTag=function(e){return!!e&&-1!==i.DISPLAYTAGS.indexOf(o.tagName(e))},i.isOrphanedGlyph=function(e){return!!e&&"MGLYPH"===o.tagName(e)&&!n(e.parentNode)},i.purgeNodes=function(n){const r=[];for(let e,t=0;e=n[t];t++)if(e.nodeType===o.NodeType.ELEMENT_NODE){const n=o.tagName(e);-1!==i.IGNORETAGS.indexOf(n)||-1!==i.EMPTYTAGS.indexOf(n)&&0===e.childNodes.length||r.push(e)}return r},i.isZeroLength=function(e){if(!e)return!1;if(-1!==["negativeveryverythinmathspace","negativeverythinmathspace","negativethinmathspace","negativemediummathspace","negativethickmathspace","negativeverythickmathspace","negativeveryverythickmathspace"].indexOf(e))return!0;e=e.match(/[0-9.]+/);return!!e&&0===parseFloat(e[0])},i.addAttributes=function(t,e){if(e.hasAttributes()){var n=e.attributes;for(let e=n.length-1;0<=e;e--){const r=n[e].name;r.match(/^ext/)&&(t.attributes[r]=n[e].value,t.nobreaking=!0),-1!==i.directSpeechKeys.indexOf(r)&&(t.attributes["ext-speech"]=n[e].value,t.nobreaking=!0),r.match(/texclass$/)&&(t.attributes.texclass=n[e].value),"href"===r&&(t.attributes.href=n[e].value,t.nobreaking=!0)}}},i.getEmbellishedInner=function e(t){return t&&t.embellished&&0<t.childNodes.length?e(t.childNodes[0]):t},i.sliceNodes=s,i.partitionNodes=function(e,t){let n=e;const r=[],i=[];for(var o;o=s(n,t),i.push(o.head),r.push(o.div),n=o.tail,o.div;);return r.pop(),{rel:r,comp:i}}},9135:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractSpeechGenerator=void 0;const r=n(985),i=n(8171),o=n(1848),s=n(144);t.AbstractSpeechGenerator=class{constructor(){this.modality=i.addPrefix("speech"),this.rebuilt_=null,this.options_={}}getRebuilt(){return this.rebuilt_}setRebuilt(e){this.rebuilt_=e}setOptions(e){this.options_=e||{},this.modality=i.addPrefix(this.options_.modality||"speech")}getOptions(){return this.options_}start(){}end(){}generateSpeech(e,t){return this.rebuilt_||(this.rebuilt_=new o.RebuildStree(t)),(0,r.setup)(this.options_),s.computeMarkup(this.getRebuilt().xml)}}},3153:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AdhocSpeechGenerator=void 0;class r extends n(9135).AbstractSpeechGenerator{getSpeech(e,t){t=this.generateSpeech(e,t);return e.setAttribute(this.modality,t),t}}t.AdhocSpeechGenerator=r},6281:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ColorGenerator=void 0;const r=n(8171),i=n(1123),o=n(1848),s=n(8835),a=n(9135);class l extends a.AbstractSpeechGenerator{constructor(){super(...arguments),this.modality=(0,r.addPrefix)("foreground"),this.contrast=new i.ContrastPicker}static visitStree_(t,n,r){if(t.childNodes.length){if(t.contentNodes.length&&("punctuated"===t.type&&t.contentNodes.forEach(e=>r[e.id]=!0),"implicit"!==t.role&&n.push(t.contentNodes.map(e=>e.id))),t.childNodes.length){if("implicit"===t.role){const i=[];let e=[];for(const n of t.childNodes){const t=[];l.visitStree_(n,t,r),t.length<=2&&i.push(t.shift()),e=e.concat(t)}return n.push(i),void e.forEach(e=>n.push(e))}t.childNodes.forEach(e=>l.visitStree_(e,n,r))}}else r[t.id]||n.push(t.id)}getSpeech(e,t){return s.getAttribute(e,this.modality)}generateSpeech(e,t){return this.getRebuilt()||this.setRebuilt(new o.RebuildStree(e)),this.colorLeaves_(e),s.getAttribute(e,this.modality)}colorLeaves_(t){const n=[];l.visitStree_(this.getRebuilt().streeRoot,n,{});for(const e of n){const n=this.contrast.generate();(Array.isArray(e)?e.map(e=>this.colorLeave_(t,e,n)).reduce((e,t)=>e||t,!1):this.colorLeave_(t,e.toString(),n))&&this.contrast.increment()}}colorLeave_(e,t,n){const r=s.getBySemanticId(e,t);return!!r&&(r.setAttribute(this.modality,n),!0)}}t.ColorGenerator=l},1565:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.DirectSpeechGenerator=void 0;const r=n(8835),i=n(9135);class o extends i.AbstractSpeechGenerator{getSpeech(e,t){return r.getAttribute(e,this.modality)}}t.DirectSpeechGenerator=o},7721:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.DummySpeechGenerator=void 0;class r extends n(9135).AbstractSpeechGenerator{getSpeech(e,t){return""}}t.DummySpeechGenerator=r},1558:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.NodeSpeechGenerator=void 0;const r=n(8835),i=n(7486);class o extends i.TreeSpeechGenerator{getSpeech(e,t){return super.getSpeech(e,t),r.getAttribute(e,this.modality)}}t.NodeSpeechGenerator=o},7317:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.generatorMapping_=t.generator=void 0;const r=n(3153),i=n(6281),o=n(1565),s=n(7721),a=n(1558),l=n(5778),c=n(7486);t.generator=function(e){return(t.generatorMapping_[e]||t.generatorMapping_.Direct)()},t.generatorMapping_={Adhoc:()=>new r.AdhocSpeechGenerator,Color:()=>new i.ColorGenerator,Direct:()=>new o.DirectSpeechGenerator,Dummy:()=>new s.DummySpeechGenerator,Node:()=>new a.NodeSpeechGenerator,Summary:()=>new l.SummarySpeechGenerator,Tree:()=>new c.TreeSpeechGenerator}},144:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.computeSummary_=t.retrieveSummary=t.connectAllMactions=t.connectMactions=t.nodeAtPosition_=t.computePrefix_=t.retrievePrefix=t.addPrefix=t.addModality=t.addSpeech=t.recomputeMarkup=t.computeMarkup=t.recomputeSpeech=t.computeSpeech=void 0;const r=n(4253),c=n(6671),i=n(5024),u=n(8171),o=n(6060),s=n(1784),d=n(8835);function a(e){return o.SpeechRuleEngine.getInstance().evaluateNode(e)}function l(e){return a(s.SemanticTree.fromNode(e).xml())}function p(e){e=l(e);return r.markup(e)}function h(e){e=f(e);return r.markup(e)}function f(e){const t=s.SemanticTree.fromRoot(e),n=i.evalXPath('.//*[@id="'+e.id+'"]',t.xml());let r=n[0];return(r=1<n.length?m(e,n)||r:r)?o.SpeechRuleEngine.getInstance().runInSetting({modality:"prefix",domain:"default",style:"default",strict:!0,speech:!0},function(){return o.SpeechRuleEngine.getInstance().evaluateNode(r)}):[]}function m(e,n){var t=n[0];if(!e.parent)return t;const r=[];for(;e;)r.push(e.id),e=e.parent;for(let e,t=0;e=n[t];t++)if(function(e,t){for(;t.length&&t.shift().toString()===e.getAttribute("id")&&e.parentNode&&e.parentNode.parentNode;)e=e.parentNode.parentNode;return!t.length}(e,r.slice()))return e;return t}function g(e){return e?o.SpeechRuleEngine.getInstance().runInSetting({modality:"summary",strict:!1,speech:!0},function(){return o.SpeechRuleEngine.getInstance().evaluateNode(e)}):[]}t.computeSpeech=a,t.recomputeSpeech=l,t.computeMarkup=function(e){e=a(e);return r.markup(e)},t.recomputeMarkup=p,t.addSpeech=function(e,t,n){n=c.querySelectorAllByAttrValue(n,"id",t.id.toString())[0],n=n?r.markup(a(n)):p(t);e.setAttribute(u.Attribute.SPEECH,n)},t.addModality=function(e,t,n){t=p(t);e.setAttribute(n,t)},t.addPrefix=function(e,t){t=h(t);t&&e.setAttribute(u.Attribute.PREFIX,t)},t.retrievePrefix=h,t.computePrefix_=f,t.nodeAtPosition_=m,t.connectMactions=function(n,e,r){const i=c.querySelectorAll(e,"maction");for(let t,e=0;t=i[e];e++){const i=t.getAttribute("id"),s=c.querySelectorAllByAttrValue(n,"id",i)[0];if(s){const a=t.childNodes[1],l=a.getAttribute(u.Attribute.ID);let e=d.getBySemanticId(n,l);var o;e&&"dummy"!==e.getAttribute(u.Attribute.TYPE)||(e=s.childNodes[0]).getAttribute("sre-highlighter-added")||((o=a.getAttribute(u.Attribute.PARENT))&&e.setAttribute(u.Attribute.PARENT,o),e.setAttribute(u.Attribute.TYPE,"dummy"),e.setAttribute(u.Attribute.ID,l),c.querySelectorAllByAttrValue(r,"id",l)[0].setAttribute("alternative",l))}}},t.connectAllMactions=function(e,n){const r=c.querySelectorAll(e,"maction");for(let e,t=0;e=r[t];t++){const r=e.childNodes[1].getAttribute(u.Attribute.ID);c.querySelectorAllByAttrValue(n,"id",r)[0].setAttribute("alternative",r)}},t.retrieveSummary=function(e){e=g(e);return r.markup(e)},t.computeSummary_=g},5778:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SummarySpeechGenerator=void 0;const r=n(9135),i=n(144);class o extends r.AbstractSpeechGenerator{getSpeech(e,t){return i.connectAllMactions(t,this.getRebuilt().xml),this.generateSpeech(e,t)}}t.SummarySpeechGenerator=o},7486:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TreeSpeechGenerator=void 0;const a=n(8171),l=n(8835),r=n(9135),c=n(144);class i extends r.AbstractSpeechGenerator{getSpeech(e,t){const n=this.generateSpeech(e,t),r=this.getRebuilt().nodeDict;for(const n in r){var i=r[n],o=l.getBySemanticId(t,n),s=l.getBySemanticId(e,n);o&&s&&(this.modality&&this.modality!==a.Attribute.SPEECH?c.addModality(s,i,this.modality):c.addSpeech(s,i,this.getRebuilt().xml),this.modality===a.Attribute.SPEECH&&c.addPrefix(s,i))}return n}}t.TreeSpeechGenerator=i},650:function(e,u,t){Object.defineProperty(u,"__esModule",{value:!0}),u.INTERVALS=u.makeLetter=u.numberRules=u.alphabetRules=u.getFont=u.makeInterval=u.generate=u.makeDomains_=u.Domains_=u.Base=u.Embellish=u.Font=void 0;const i=t(4886),o=t(2371),d=t(4524),n=t(3319),p=t(4161);var r,s,a;function l(){var e=d.LOCALE.ALPHABETS,t=(e,t)=>{const n={};return Object.keys(e).forEach(e=>n[e]=!0),Object.keys(t).forEach(e=>n[e]=!0),Object.keys(n)};u.Domains_.small=t(e.smallPrefix,e.letterTrans),u.Domains_.capital=t(e.capPrefix,e.letterTrans),u.Domains_.digit=t(e.digitPrefix,e.digitTrans)}function c([e,t],n){const r=parseInt(e,16),i=parseInt(t,16),o=[];for(let t=r;t<=i;t++){let e=3<(s=(s=t).toString(16).toUpperCase()).length?s:("000"+s).slice(-4);!1!==n[e]&&(e=n[e]||e,o.push(e))}var s;return o}function h(e){e="normal"!==e&&"fullwidth"!==e&&(d.LOCALE.MESSAGES.font[e]||d.LOCALE.MESSAGES.embellish[e])||"";return(0,n.localeFontCombiner)(e)}function f(i,o,s,e,a,l){var c=h(e);for(let e,t,n,r=0;e=i[r],t=o[r],n=s[r];r++){const i=l?d.LOCALE.ALPHABETS.capPrefix:d.LOCALE.ALPHABETS.smallPrefix,o=l?u.Domains_.capital:u.Domains_.small;g(c.combiner,e,t,n,c.font,i,a,d.LOCALE.ALPHABETS.letterTrans,o)}}function m(r,i,e,o,s){var a=h(e);for(let e,t,n=0;e=r[n],t=i[n];n++){const r=d.LOCALE.ALPHABETS.digitPrefix,i=n+s;g(a.combiner,e,t,i,a.font,r,o,d.LOCALE.ALPHABETS.digitTrans,u.Domains_.digit)}}function g(n,r,i,o,s,a,l,c,u){for(let e,t=0;e=u[t];t++){const u=e in c?c[e]:c.default,d=e in a?a[e]:a.default;p.defineRule(r.toString(),e,"default",l,i,n(u(o),s,d))}}(a=t=u.Font||(u.Font={})).BOLD="bold",a.BOLDFRAKTUR="bold-fraktur",a.BOLDITALIC="bold-italic",a.BOLDSCRIPT="bold-script",a.DOUBLESTRUCK="double-struck",a.FULLWIDTH="fullwidth",a.FRAKTUR="fraktur",a.ITALIC="italic",a.MONOSPACE="monospace",a.NORMAL="normal",a.SCRIPT="script",a.SANSSERIF="sans-serif",a.SANSSERIFITALIC="sans-serif-italic",a.SANSSERIFBOLD="sans-serif-bold",a.SANSSERIFBOLDITALIC="sans-serif-bold-italic",(s=a=u.Embellish||(u.Embellish={})).SUPER="super",s.SUB="sub",s.CIRCLED="circled",s.PARENTHESIZED="parenthesized",s.PERIOD="period",s.NEGATIVECIRCLED="negative-circled",s.DOUBLECIRCLED="double-circled",s.CIRCLEDSANSSERIF="circled-sans-serif",s.NEGATIVECIRCLEDSANSSERIF="negative-circled-sans-serif",s.COMMA="comma",s.SQUARED="squared",s.NEGATIVESQUARED="negative-squared",(r=s=u.Base||(u.Base={})).LATINCAP="latinCap",r.LATINSMALL="latinSmall",r.GREEKCAP="greekCap",r.GREEKSMALL="greekSmall",r.DIGIT="digit",u.Domains_={small:["default"],capital:["default"],digit:["default"]},u.makeDomains_=l,u.generate=function(e){const n=i.default.getInstance().locale;i.default.getInstance().locale=e,o.setLocale(),p.addSymbolRules({locale:e}),l();var r=u.INTERVALS;for(let e,t=0;e=r[t];t++){const u=c(e.interval,e.subst),n=u.map(function(e){return String.fromCodePoint(parseInt(e,16))});"offset"in e?m(u,n,e.font,e.category,e.offset||0):f(u,n,d.LOCALE.ALPHABETS[e.base],e.font,e.category,!!e.capital)}i.default.getInstance().locale=n,o.setLocale()},u.makeInterval=c,u.getFont=h,u.alphabetRules=f,u.numberRules=m,u.makeLetter=g,u.INTERVALS=[{interval:["1D400","1D419"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.BOLD},{interval:["1D41A","1D433"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.BOLD},{interval:["1D56C","1D585"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.BOLDFRAKTUR},{interval:["1D586","1D59F"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.BOLDFRAKTUR},{interval:["1D468","1D481"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.BOLDITALIC},{interval:["1D482","1D49B"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.BOLDITALIC},{interval:["1D4D0","1D4E9"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.BOLDSCRIPT},{interval:["1D4EA","1D503"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.BOLDSCRIPT},{interval:["1D538","1D551"],base:s.LATINCAP,subst:{"1D53A":"2102","1D53F":"210D","1D545":"2115","1D547":"2119","1D548":"211A","1D549":"211D","1D551":"2124"},capital:!0,category:"Lu",font:t.DOUBLESTRUCK},{interval:["1D552","1D56B"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.DOUBLESTRUCK},{interval:["1D504","1D51D"],base:s.LATINCAP,subst:{"1D506":"212D","1D50B":"210C","1D50C":"2111","1D515":"211C","1D51D":"2128"},capital:!0,category:"Lu",font:t.FRAKTUR},{interval:["1D51E","1D537"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.FRAKTUR},{interval:["FF21","FF3A"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.FULLWIDTH},{interval:["FF41","FF5A"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.FULLWIDTH},{interval:["1D434","1D44D"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.ITALIC},{interval:["1D44E","1D467"],base:s.LATINSMALL,subst:{"1D455":"210E"},capital:!1,category:"Ll",font:t.ITALIC},{interval:["1D670","1D689"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.MONOSPACE},{interval:["1D68A","1D6A3"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.MONOSPACE},{interval:["0041","005A"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.NORMAL},{interval:["0061","007A"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.NORMAL},{interval:["1D49C","1D4B5"],base:s.LATINCAP,subst:{"1D49D":"212C","1D4A0":"2130","1D4A1":"2131","1D4A3":"210B","1D4A4":"2110","1D4A7":"2112","1D4A8":"2133","1D4AD":"211B"},capital:!0,category:"Lu",font:t.SCRIPT},{interval:["1D4B6","1D4CF"],base:s.LATINSMALL,subst:{"1D4BA":"212F","1D4BC":"210A","1D4C4":"2134"},capital:!1,category:"Ll",font:t.SCRIPT},{interval:["1D5A0","1D5B9"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.SANSSERIF},{interval:["1D5BA","1D5D3"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.SANSSERIF},{interval:["1D608","1D621"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.SANSSERIFITALIC},{interval:["1D622","1D63B"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.SANSSERIFITALIC},{interval:["1D5D4","1D5ED"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.SANSSERIFBOLD},{interval:["1D5EE","1D607"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.SANSSERIFBOLD},{interval:["1D63C","1D655"],base:s.LATINCAP,subst:{},capital:!0,category:"Lu",font:t.SANSSERIFBOLDITALIC},{interval:["1D656","1D66F"],base:s.LATINSMALL,subst:{},capital:!1,category:"Ll",font:t.SANSSERIFBOLDITALIC},{interval:["0391","03A9"],base:s.GREEKCAP,subst:{"03A2":"03F4"},capital:!0,category:"Lu",font:t.NORMAL},{interval:["03B0","03D0"],base:s.GREEKSMALL,subst:{"03B0":"2207","03CA":"2202","03CB":"03F5","03CC":"03D1","03CD":"03F0","03CE":"03D5","03CF":"03F1","03D0":"03D6"},capital:!1,category:"Ll",font:t.NORMAL},{interval:["1D6A8","1D6C0"],base:s.GREEKCAP,subst:{},capital:!0,category:"Lu",font:t.BOLD},{interval:["1D6C1","1D6E1"],base:s.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:t.BOLD},{interval:["1D6E2","1D6FA"],base:s.GREEKCAP,subst:{},capital:!0,category:"Lu",font:t.ITALIC},{interval:["1D6FB","1D71B"],base:s.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:t.ITALIC},{interval:["1D71C","1D734"],base:s.GREEKCAP,subst:{},capital:!0,category:"Lu",font:t.BOLDITALIC},{interval:["1D735","1D755"],base:s.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:t.BOLDITALIC},{interval:["1D756","1D76E"],base:s.GREEKCAP,subst:{},capital:!0,category:"Lu",font:t.SANSSERIFBOLD},{interval:["1D76F","1D78F"],base:s.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:t.SANSSERIFBOLD},{interval:["1D790","1D7A8"],base:s.GREEKCAP,subst:{},capital:!0,category:"Lu",font:t.SANSSERIFBOLDITALIC},{interval:["1D7A9","1D7C9"],base:s.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:t.SANSSERIFBOLDITALIC},{interval:["0030","0039"],base:s.DIGIT,subst:{},offset:0,category:"Nd",font:t.NORMAL},{interval:["2070","2079"],base:s.DIGIT,subst:{2071:"00B9",2072:"00B2",2073:"00B3"},offset:0,category:"No",font:a.SUPER},{interval:["2080","2089"],base:s.DIGIT,subst:{},offset:0,category:"No",font:a.SUB},{interval:["245F","2473"],base:s.DIGIT,subst:{"245F":"24EA"},offset:0,category:"No",font:a.CIRCLED},{interval:["3251","325F"],base:s.DIGIT,subst:{},offset:21,category:"No",font:a.CIRCLED},{interval:["32B1","32BF"],base:s.DIGIT,subst:{},offset:36,category:"No",font:a.CIRCLED},{interval:["2474","2487"],base:s.DIGIT,subst:{},offset:1,category:"No",font:a.PARENTHESIZED},{interval:["2487","249B"],base:s.DIGIT,subst:{2487:"1F100"},offset:0,category:"No",font:a.PERIOD},{interval:["2775","277F"],base:s.DIGIT,subst:{2775:"24FF"},offset:0,category:"No",font:a.NEGATIVECIRCLED},{interval:["24EB","24F4"],base:s.DIGIT,subst:{},offset:11,category:"No",font:a.NEGATIVECIRCLED},{interval:["24F5","24FE"],base:s.DIGIT,subst:{},offset:1,category:"No",font:a.DOUBLECIRCLED},{interval:["277F","2789"],base:s.DIGIT,subst:{"277F":"1F10B"},offset:0,category:"No",font:a.CIRCLEDSANSSERIF},{interval:["2789","2793"],base:s.DIGIT,subst:{2789:"1F10C"},offset:0,category:"No",font:a.NEGATIVECIRCLEDSANSSERIF},{interval:["FF10","FF19"],base:s.DIGIT,subst:{},offset:0,category:"Nd",font:t.FULLWIDTH},{interval:["1D7CE","1D7D7"],base:s.DIGIT,subst:{},offset:0,category:"Nd",font:t.BOLD},{interval:["1D7D8","1D7E1"],base:s.DIGIT,subst:{},offset:0,category:"Nd",font:t.DOUBLESTRUCK},{interval:["1D7E2","1D7EB"],base:s.DIGIT,subst:{},offset:0,category:"Nd",font:t.SANSSERIF},{interval:["1D7EC","1D7F5"],base:s.DIGIT,subst:{},offset:0,category:"Nd",font:t.SANSSERIFBOLD},{interval:["1D7F6","1D7FF"],base:s.DIGIT,subst:{},offset:0,category:"Nd",font:t.MONOSPACE},{interval:["1F101","1F10A"],base:s.DIGIT,subst:{},offset:0,category:"No",font:a.COMMA},{interval:["24B6","24CF"],base:s.LATINCAP,subst:{},capital:!0,category:"So",font:a.CIRCLED},{interval:["24D0","24E9"],base:s.LATINSMALL,subst:{},capital:!1,category:"So",font:a.CIRCLED},{interval:["1F110","1F129"],base:s.LATINCAP,subst:{},capital:!0,category:"So",font:a.PARENTHESIZED},{interval:["249C","24B5"],base:s.LATINSMALL,subst:{},capital:!1,category:"So",font:a.PARENTHESIZED},{interval:["1F130","1F149"],base:s.LATINCAP,subst:{},capital:!0,category:"So",font:a.SQUARED},{interval:["1F170","1F189"],base:s.LATINCAP,subst:{},capital:!0,category:"So",font:a.NEGATIVESQUARED},{interval:["1F150","1F169"],base:s.LATINCAP,subst:{},capital:!0,category:"So",font:a.NEGATIVECIRCLED}]},3955:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.Comparator=t.ClearspeakPreferences=void 0;const r=n(4886),s=n(4998),o=n(8310),a=n(8310),i=n(4161),l=n(6060);class c extends o.DynamicCstr{constructor(e,t){super(e),this.preference=t}static comparator(){return new d(r.default.getInstance().dynamicCstr,a.DynamicProperties.createProp([o.DynamicCstr.DEFAULT_VALUES[a.Axis.LOCALE]],[o.DynamicCstr.DEFAULT_VALUES[a.Axis.MODALITY]],[o.DynamicCstr.DEFAULT_VALUES[a.Axis.DOMAIN]],[o.DynamicCstr.DEFAULT_VALUES[a.Axis.STYLE]]))}static fromPreference(e){const n=e.split(":"),r={},i=u.getProperties(),o=Object.keys(i);for(let e,t=0;e=n[t];t++){const n=e.split("_");var s;-1!==o.indexOf(n[0])&&((s=n[1])&&s!==c.AUTO&&-1!==i[n[0]].indexOf(s)&&(r[n[0]]=n[1]))}return r}static toPreference(t){const n=Object.keys(t),r=[];for(let e=0;e<n.length;e++)r.push(n[e]+"_"+t[n[e]]);return r.length?r.join(":"):o.DynamicCstr.DEFAULT_VALUE}static getLocalePreferences(e){e=e||i.enumerate(l.SpeechRuleEngine.getInstance().enumerate());return c.getLocalePreferences_(e)}static smartPreferences(e,t){const n=c.getLocalePreferences()[t];if(!n)return[];const r=e.explorers.speech,i=c.relevantPreferences(r.walker.getFocus().getSemanticPrimary()),o=s.DOMAIN_TO_STYLES.clearspeak;return[{type:"radio",content:"No Preferences",id:"clearspeak-default",variable:"speechRules"},{type:"radio",content:"Current Preferences",id:"clearspeak-"+o,variable:"speechRules"},{type:"rule"},{type:"label",content:"Preferences for "+i},{type:"rule"}].concat(n[i].map(function(e){e=e.split("_");return{type:"radio",content:e[1],id:"clearspeak-"+c.addPreference(o,e[0],e[1]),variable:"speechRules"}}))}static relevantPreferences(e){var t=f[e.type];return t&&(t[e.role]||t[""])||"ImpliedTimes"}static findPreference(e,t){return"default"!==e&&c.fromPreference(e)[t]||c.AUTO}static addPreference(e,t,n){if("default"===e)return t+"_"+n;const r=c.fromPreference(e);return r[t]=n,c.toPreference(r)}static getLocalePreferences_(e){const t={};for(const n in e)if(e[n].speech&&e[n].speech.clearspeak){const r=Object.keys(e[n].speech.clearspeak),i=t[n]={};for(const e in u.getProperties()){const t=u.getProperties()[e],o=[e+"_Auto"];if(t)for(const s of t)-1!==r.indexOf(e+"_"+s)&&o.push(e+"_"+s);i[e]=o}}return t}equal(e){if(!super.equal(e))return!1;var n=Object.keys(this.preference),r=e.preference;if(n.length!==Object.keys(r).length)return!1;for(let e,t=0;e=n[t];t++)if(this.preference[e]!==r[e])return!1;return!0}}(t.ClearspeakPreferences=c).AUTO="Auto";const u=new a.DynamicProperties({AbsoluteValue:["Auto","AbsEnd","Cardinality","Determinant"],Bar:["Auto","Conjugate"],Caps:["Auto","SayCaps"],CombinationPermutation:["Auto","ChoosePermute"],Currency:["Auto","Position","Prefix"],Ellipses:["Auto","AndSoOn"],Enclosed:["Auto","EndEnclose"],Exponent:["Auto","AfterPower","Ordinal","OrdinalPower","Exponent"],Fraction:["Auto","EndFrac","FracOver","General","GeneralEndFrac","Ordinal","Over","OverEndFrac","Per"],Functions:["Auto","None","Reciprocal"],ImpliedTimes:["Auto","MoreImpliedTimes","None"],Log:["Auto","LnAsNaturalLog"],Matrix:["Auto","Combinatoric","EndMatrix","EndVector","SilentColNum","SpeakColNum","Vector"],MultiLineLabel:["Auto","Case","Constraint","Equation","Line","None","Row","Step"],MultiLineOverview:["Auto","None"],MultiLinePausesBetweenColumns:["Auto","Long","Short"],MultsymbolDot:["Auto","Dot"],MultsymbolX:["Auto","By","Cross"],Paren:["Auto","CoordPoint","Interval","Silent","Speak","SpeakNestingLevel"],Prime:["Auto","Angle","Length"],Roots:["Auto","PosNegSqRoot","PosNegSqRootEnd","RootEnd"],SetMemberSymbol:["Auto","Belongs","Element","Member","In"],Sets:["Auto","SilentBracket","woAll"],TriangleSymbol:["Auto","Delta"],Trig:["Auto","ArcTrig","TrigInverse","Reciprocal"],VerticalLine:["Auto","Divides","Given","SuchThat"]});class d extends a.DefaultComparator{constructor(e,t){super(e,t),this.preference=e instanceof c?e.preference:{}}match(n){if(!(n instanceof c))return super.match(n);if("default"===n.getComponents()[a.Axis.STYLE])return!0;var r=Object.keys(n.preference);for(let e,t=0;e=r[t];t++)if(this.preference[e]!==n.preference[e])return!1;return!0}compare(e,t){var n=super.compare(e,t);if(0!==n)return n;var n=e instanceof c,r=t instanceof c;if(!n&&r)return 1;if(n&&!r)return-1;if(!n&&!r)return 0;n=Object.keys(e.preference).length,r=Object.keys(t.preference).length;return r<n?-1:n<r?1:0}}t.Comparator=d;class p extends a.DynamicCstrParser{constructor(){super([a.Axis.LOCALE,a.Axis.MODALITY,a.Axis.DOMAIN,a.Axis.STYLE])}parse(e){const t=super.parse(e);let n=t.getValue(a.Axis.STYLE);var e=t.getValue(a.Axis.LOCALE),r=t.getValue(a.Axis.MODALITY);let i={};return n!==o.DynamicCstr.DEFAULT_VALUE&&(i=this.fromPreference(n),n=this.toPreference(i)),new c({locale:e,modality:r,domain:"clearspeak",style:n},i)}fromPreference(e){return c.fromPreference(e)}toPreference(e){return c.toPreference(e)}}t.Parser=p;const h=[["AbsoluteValue","fenced","neutral","metric"],["Bar","overscore","overaccent"],["Caps","identifier","latinletter"],["CombinationPermutation","appl","unknown"],["Ellipses","punctuation","ellipsis"],["Exponent","superscript",""],["Fraction","fraction",""],["Functions","appl","simple function"],["ImpliedTimes","operator","implicit"],["Log","appl","prefix function"],["Matrix","matrix",""],["Matrix","vector",""],["MultiLineLabel","multiline","label"],["MultiLineOverview","multiline","table"],["MultiLinePausesBetweenColumns","multiline","table"],["MultiLineLabel","table","label"],["MultiLineOverview","table","table"],["MultiLinePausesBetweenColumns","table","table"],["MultiLineLabel","cases","label"],["MultiLineOverview","cases","table"],["MultiLinePausesBetweenColumns","cases","table"],["MultsymbolDot","operator","multiplication"],["MultsymbolX","operator","multiplication"],["Paren","fenced","leftright"],["Prime","superscript","prime"],["Roots","root",""],["Roots","sqrt",""],["SetMemberSymbol","relation","element"],["Sets","fenced","set extended"],["TriangleSymbol","identifier","greekletter"],["Trig","appl","prefix function"],["VerticalLine","punctuated","vbar"]],f=function(){const n={};for(let t,e=0;t=h[e];e++){var r=t[0];let e=n[t[1]];e||(e={},n[t[1]]=e),e[t[2]]=r}return n}();r.default.getInstance().comparators.clearspeak=c.comparator,r.default.getInstance().parsers.clearspeak=new p},127:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ClearspeakRules=void 0;const r=n(8310),i=n(931),o=n(8662),s=n(3269),a=n(2110),l=n(7278);t.ClearspeakRules=function(){l.addStore(r.DynamicCstr.BASE_LOCALE+".speech.clearspeak","",{CTFpauseSeparator:i.pauseSeparator,CTFnodeCounter:o.nodeCounter,CTFcontentIterator:i.contentIterator,CSFvulgarFraction:a.vulgarFraction,CQFvulgarFractionSmall:o.isSmallVulgarFraction,CQFcellsSimple:o.allCellsSimple,CSFordinalExponent:o.ordinalExponent,CSFwordOrdinal:o.wordOrdinal,CQFmatchingFences:o.matchingFences,CSFnestingDepth:o.nestingDepth,CQFfencedArguments:o.fencedArguments,CQFsimpleArguments:o.simpleArguments,CQFspaceoutNumber:s.spaceoutNumber})}},8662:function(e,o,t){Object.defineProperty(o,"__esModule",{value:!0}),o.wordOrdinal=o.layoutFactor_=o.fencedFactor_=o.simpleFactor_=o.simpleArguments=o.fencedArguments=o.insertNesting=o.matchingFences=o.nestingDepth=o.NESTING_DEPTH=o.ordinalExponent=o.allTextLastContent_=o.isUnitExpression=o.isSmallVulgarFraction=o.allCellsSimple=o.allIndices_=o.isInteger_=o.simpleCell_=o.simpleNode=o.hasPreference=o.isSimpleFraction_=o.isSimpleNumber_=o.isNumber_=o.isLetter_=o.isSimple_=o.isSimpleLetters_=o.isSimpleDegree_=o.isSimpleNegative_=o.isSimpleFunction_=o.isSimpleExpression=o.nodeCounter=void 0;const i=t(6671),n=t(4886),s=t(5024),a=t(4524),r=t(9385),l=t(1058),c=t(931),u=t(4036),d=t(241),p=t(4020);function h(e){return N(e)||b(e)||g(e)||m(e)||f(e)}function f(e){return"appl"===e.type&&("prefix function"===e.childNodes[0].role||"simple function"===e.childNodes[0].role)&&(y(e.childNodes[1])||"fenced"===e.childNodes[1].type&&y(e.childNodes[1].childNodes[0]))}function m(e){return"prefixop"===e.type&&"negative"===e.role&&y(e.childNodes[0])&&"prefixop"!==e.childNodes[0].type&&"appl"!==e.childNodes[0].type&&"punctuated"!==e.childNodes[0].type}function g(e){return"punctuated"===e.type&&"endpunct"===e.role&&2===e.childNodes.length&&"degree"===e.childNodes[1].role&&(S(e.childNodes[0])||E(e.childNodes[0])||"prefixop"===e.childNodes[0].type&&"negative"===e.childNodes[0].role&&(S(e.childNodes[0].childNodes[0])||E(e.childNodes[0].childNodes[0])))}function b(e){return S(e)||"infixop"===e.type&&"implicit"===e.role&&(2===e.childNodes.length&&(S(e.childNodes[0])||N(e.childNodes[0]))&&S(e.childNodes[1])||3===e.childNodes.length&&N(e.childNodes[0])&&S(e.childNodes[1])&&S(e.childNodes[2]))}function y(e){return e.hasAnnotation("clearspeak","simple")}function S(e){return"identifier"===e.type&&("latinletter"===e.role||"greekletter"===e.role||"otherletter"===e.role||"simple function"===e.role)}function E(e){return"number"===e.type&&("integer"===e.role||"float"===e.role)}function N(e){return E(e)||v(e)}function v(e){if(A("Fraction_Over")||A("Fraction_FracOver"))return!1;if("fraction"!==e.type||"vulgar"!==e.role)return!1;if(A("Fraction_Ordinal"))return!0;var t=parseInt(e.childNodes[0].textContent,10),e=parseInt(e.childNodes[1].textContent,10);return 0<t&&t<20&&0<e&&e<11}function A(e){return n.default.getInstance().style===e}function _(e){if(!e.hasAttribute("annotation"))return!1;e=e.getAttribute("annotation");return!!/clearspeak:simple$|clearspeak:simple;/.exec(e)}function C(e){if(_(e))return!0;if("subscript"!==e.tagName)return!1;const t=e.childNodes[0].childNodes,n=t[1];return"identifier"===t[0].tagName&&(M(n)||"infixop"===n.tagName&&n.hasAttribute("role")&&"implicit"===n.getAttribute("role")&&O(n))}function M(e){return"number"===e.tagName&&e.hasAttribute("role")&&"integer"===e.getAttribute("role")}function O(e){return s.evalXPath("children/*",e).every(e=>M(e)||"identifier"===e.tagName)}function T(e){return"text"===e.type||"punctuated"===e.type&&"text"===e.role&&E(e.childNodes[0])&&x(e.childNodes.slice(1))||"identifier"===e.type&&"unit"===e.role||"infixop"===e.type&&("implicit"===e.role||"unit"===e.role)}function x(t){for(let e=0;e<t.length-1;e++)if("text"!==t[e].type||""!==t[e].textContent)return!1;return"text"===t[t.length-1].type}function I(e,t){if(!t||!e)return e;var n=e.match(/^(open|close) /);return n?n[0]+t+" "+e.substring(n[0].length):t+" "+e}function L(e){return!!e&&("number"===e.tagName||"identifier"===e.tagName||"function"===e.tagName||"appl"===e.tagName||"fraction"===e.tagName)}function P(e){return e&&("fenced"===e.tagName||e.hasAttribute("role")&&"leftright"===e.getAttribute("role")||R(e))}function R(e){return!!e&&("matrix"===e.tagName||"vector"===e.tagName)}o.nodeCounter=function(e,t){const n=t.split("-"),r=c.nodeCounter(e,n[0]||""),i=n[1]||"",o=n[2]||"";let s=!0;return function(){var e=r();return s?(s=!1,o+e+i):e+i}},o.isSimpleExpression=h,o.isSimpleFunction_=f,o.isSimpleNegative_=m,o.isSimpleDegree_=g,o.isSimpleLetters_=b,o.isSimple_=y,o.isLetter_=S,o.isNumber_=E,o.isSimpleNumber_=N,o.isSimpleFraction_=v,o.hasPreference=A,(0,u.register)(new d.SemanticAnnotator("clearspeak","simple",function(e){return h(e)?"simple":""})),o.simpleNode=_,o.simpleCell_=C,o.isInteger_=M,o.allIndices_=O,o.allCellsSimple=function(e){var t="matrix"===e.tagName?"children/row/children/cell/children/*":"children/line/children/*";return s.evalXPath(t,e).every(C)?[e]:[]},o.isSmallVulgarFraction=function(e){return(0,r.vulgarFractionSmall)(e,20,11)?[e]:[]},o.isUnitExpression=T,o.allTextLastContent_=x,(0,u.register)(new d.SemanticAnnotator("clearspeak","unit",function(e){return T(e)?"unit":""})),o.ordinalExponent=function(e){var t=parseInt(e.textContent,10);return isNaN(t)?e.textContent:10<t?a.LOCALE.NUMBERS.numericOrdinal(t):a.LOCALE.NUMBERS.wordOrdinal(t)},o.NESTING_DEPTH=null,o.nestingDepth=function(e){let t=0;var n=e.textContent,r="open"===e.getAttribute("role")?0:1;let i=e.parentNode;for(;i;)"fenced"===i.tagName&&i.childNodes[0].childNodes[r].textContent===n&&t++,i=i.parentNode;return o.NESTING_DEPTH=1<t?a.LOCALE.NUMBERS.wordOrdinal(t):"",o.NESTING_DEPTH},o.matchingFences=function(e){var t=e.previousSibling;let n,r;return(r=t?(n=t,e):(n=e).nextSibling)&&(0,p.isMatchingFence)(n.textContent,r.textContent)?[e]:[]},o.insertNesting=I,l.Grammar.getInstance().setCorrection("insertNesting",I),o.fencedArguments=function(e){const t=i.toArray(e.parentNode.childNodes),n=s.evalXPath("../../children/*",e),r=t.indexOf(e);return P(n[r])||P(n[r+1])?[e]:[]},o.simpleArguments=function(e){const t=i.toArray(e.parentNode.childNodes),n=s.evalXPath("../../children/*",e),r=t.indexOf(e);return L(n[r])&&n[r+1]&&(L(n[r+1])||"root"===n[r+1].tagName||"sqrt"===n[r+1].tagName||"superscript"===n[r+1].tagName&&n[r+1].childNodes[0].childNodes[0]&&("number"===n[r+1].childNodes[0].childNodes[0].tagName||"identifier"===n[r+1].childNodes[0].childNodes[0].tagName)&&("2"===n[r+1].childNodes[0].childNodes[1].textContent||"3"===n[r+1].childNodes[0].childNodes[1].textContent))?[e]:[]},o.simpleFactor_=L,o.fencedFactor_=P,o.layoutFactor_=R,o.wordOrdinal=function(e){return a.LOCALE.NUMBERS.wordOrdinal(parseInt(e.textContent,10))}},5659:function(e,t,n){var r=this&&this.__awaiter||function(e,s,a,l){return new(a=a||Promise)(function(n,t){function r(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,i)}o((l=l.apply(e,s||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.loadAjax=t.loadFileSync=t.loadFile=t.parseMaps=t.retrieveFiles=t.standardLoader=t.loadLocale=t.store=void 0;const i=n(9501),o=n(4886),s=n(4998),a=n(7129),l=n(4755),c=n(8310),u=n(4161),d=n(6060),p=n(2371),h=n(650),f={functions:(t.store=u).addFunctionRules,symbols:u.addSymbolRules,units:u.addUnitRules,si:u.setSiPrefixes};let m=!1;function g(e=o.default.getInstance().locale){o.EnginePromise.loaded[e]||(o.EnginePromise.loaded[e]=[!1,!1],e=e,(o.default.getInstance().isIE&&o.default.getInstance().mode===s.Mode.HTTP?function e(t,n){let r=n||1;i.mapsForIE?E(i.mapsForIE,t):r<=5&&setTimeout((()=>e(t,r++)).bind(this),300)}:y)(e))}function b(){switch(o.default.getInstance().mode){case s.Mode.ASYNC:return N;case s.Mode.HTTP:return A;default:s.Mode.SYNC;return v}}function y(n){const e=o.default.getInstance().customLoader?o.default.getInstance().customLoader:b(),t=new Promise(t=>{e(n).then(e=>{S(e),o.EnginePromise.loaded[n]=[!0,!0],t(n)},e=>{o.EnginePromise.loaded[n]=[!0,!1],console.error("Unable to load locale: "+n),o.default.getInstance().locale=o.default.getInstance().defaultLocale,t(n)})});o.EnginePromise.promises[n]=t}function S(e){E(JSON.parse(e))}function E(n,r){let i=!0;for(let e,t=0;e=Object.keys(n)[t];t++){var o=e.split("/");r&&r!==o[0]||("rules"===o[1]?d.SpeechRuleEngine.getInstance().addStore(n[e]):"messages"===o[1]?(0,p.completeLocale)(n[e]):(i&&(h.generate(o[0]),i=!1),n[e].forEach(f[o[1]])))}}function N(e){const t=a.localePath(e);return new Promise((n,r)=>{l.default.fs.readFile(t,"utf8",(e,t)=>{if(e)return r(e);n(t)})})}function v(e){const r=a.localePath(e);return new Promise((e,t)=>{let n="{}";try{n=l.default.fs.readFileSync(r,"utf8")}catch(e){return t(e)}e(n)})}function A(e){const r=a.localePath(e),i=new XMLHttpRequest;return new Promise((t,n)=>{i.onreadystatechange=function(){var e;4===i.readyState&&(0===(e=i.status)||200<=e&&e<400?t(i.responseText):n(e))},i.open("GET",r,!0),i.send()})}t.loadLocale=function(t=o.default.getInstance().locale){return r(this,void 0,void 0,function*(){return m||(g(c.DynamicCstr.BASE_LOCALE),m=!0),o.EnginePromise.promises[c.DynamicCstr.BASE_LOCALE].then(()=>r(this,void 0,void 0,function*(){var e=o.default.getInstance().defaultLocale;return e?(g(e),o.EnginePromise.promises[e].then(()=>r(this,void 0,void 0,function*(){return g(t),o.EnginePromise.promises[t]}))):(g(t),o.EnginePromise.promises[t])}))})},t.standardLoader=b,t.retrieveFiles=y,t.parseMaps=S,t.loadFile=N,t.loadFileSync=v,t.loadAjax=A},3784:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.leftSubscriptBrief=t.leftSuperscriptBrief=t.leftSubscriptVerbose=t.leftSuperscriptVerbose=t.baselineBrief=t.baselineVerbose=void 0;const r=n(3269);t.baselineVerbose=function(e){return r.baselineVerbose(e).replace(/-$/,"")},t.baselineBrief=function(e){return r.baselineBrief(e).replace(/-$/,"")},t.leftSuperscriptVerbose=function(e){return r.superscriptVerbose(e).replace(/^exposant/,"exposant gauche")},t.leftSubscriptVerbose=function(e){return r.subscriptVerbose(e).replace(/^indice/,"indice gauche")},t.leftSuperscriptBrief=function(e){return r.superscriptBrief(e).replace(/^sup/,"sup gauche")},t.leftSubscriptBrief=function(e){return r.subscriptBrief(e).replace(/^sub/,"sub gauche")}},4972:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.MathspeakRules=void 0;const r=n(8310),i=n(931),o=n(3784),s=n(3269),a=n(2110),l=n(7278),c=n(9771);t.MathspeakRules=function(){l.addStore(r.DynamicCstr.BASE_LOCALE+".speech.mathspeak","",{CQFspaceoutNumber:s.spaceoutNumber,CQFspaceoutIdentifier:s.spaceoutIdentifier,CSFspaceoutText:s.spaceoutText,CSFopenFracVerbose:s.openingFractionVerbose,CSFcloseFracVerbose:s.closingFractionVerbose,CSFoverFracVerbose:s.overFractionVerbose,CSFopenFracBrief:s.openingFractionBrief,CSFcloseFracBrief:s.closingFractionBrief,CSFopenFracSbrief:s.openingFractionSbrief,CSFcloseFracSbrief:s.closingFractionSbrief,CSFoverFracSbrief:s.overFractionSbrief,CSFvulgarFraction:a.vulgarFraction,CQFvulgarFractionSmall:s.isSmallVulgarFraction,CSFopenRadicalVerbose:s.openingRadicalVerbose,CSFcloseRadicalVerbose:s.closingRadicalVerbose,CSFindexRadicalVerbose:s.indexRadicalVerbose,CSFopenRadicalBrief:s.openingRadicalBrief,CSFcloseRadicalBrief:s.closingRadicalBrief,CSFindexRadicalBrief:s.indexRadicalBrief,CSFopenRadicalSbrief:s.openingRadicalSbrief,CSFindexRadicalSbrief:s.indexRadicalSbrief,CQFisSmallRoot:s.smallRoot,CSFsuperscriptVerbose:s.superscriptVerbose,CSFsuperscriptBrief:s.superscriptBrief,CSFsubscriptVerbose:s.subscriptVerbose,CSFsubscriptBrief:s.subscriptBrief,CSFbaselineVerbose:s.baselineVerbose,CSFbaselineBrief:s.baselineBrief,CSFleftsuperscriptVerbose:s.superscriptVerbose,CSFleftsubscriptVerbose:s.subscriptVerbose,CSFrightsuperscriptVerbose:s.superscriptVerbose,CSFrightsubscriptVerbose:s.subscriptVerbose,CSFleftsuperscriptBrief:s.superscriptBrief,CSFleftsubscriptBrief:s.subscriptBrief,CSFrightsuperscriptBrief:s.superscriptBrief,CSFrightsubscriptBrief:s.subscriptBrief,CSFunderscript:s.nestedUnderscript,CSFoverscript:s.nestedOverscript,CSFendscripts:s.endscripts,CTFordinalCounter:a.ordinalCounter,CTFwordCounter:a.wordCounter,CTFcontentIterator:i.contentIterator,CQFdetIsSimple:s.determinantIsSimple,CSFRemoveParens:s.removeParens,CQFresetNesting:s.resetNestingDepth,CGFbaselineConstraint:s.generateBaselineConstraint,CGFtensorRules:s.generateTensorRules}),l.addStore("es.speech.mathspeak",r.DynamicCstr.BASE_LOCALE+".speech.mathspeak",{CTFunitMultipliers:c.unitMultipliers,CQFoneLeft:c.oneLeft}),l.addStore("fr.speech.mathspeak",r.DynamicCstr.BASE_LOCALE+".speech.mathspeak",{CSFbaselineVerbose:o.baselineVerbose,CSFbaselineBrief:o.baselineBrief,CSFleftsuperscriptVerbose:o.leftSuperscriptVerbose,CSFleftsubscriptVerbose:o.leftSubscriptVerbose,CSFleftsuperscriptBrief:o.leftSuperscriptBrief,CSFleftsubscriptBrief:o.leftSubscriptBrief})}},3269:function(e,a,t){Object.defineProperty(a,"__esModule",{value:!0}),a.smallRoot=a.generateTensorRules=a.removeParens=a.generateBaselineConstraint=a.determinantIsSimple=a.nestedOverscript=a.endscripts=a.overscoreNestingDepth=a.nestedUnderscript=a.underscoreNestingDepth=a.indexRadicalSbrief=a.openingRadicalSbrief=a.indexRadicalBrief=a.closingRadicalBrief=a.openingRadicalBrief=a.indexRadicalVerbose=a.closingRadicalVerbose=a.openingRadicalVerbose=a.getRootIndex=a.nestedRadical=a.radicalNestingDepth=a.baselineBrief=a.baselineVerbose=a.superscriptBrief=a.superscriptVerbose=a.subscriptBrief=a.subscriptVerbose=a.nestedSubSuper=a.isSmallVulgarFraction=a.overFractionSbrief=a.closingFractionSbrief=a.openingFractionSbrief=a.closingFractionBrief=a.openingFractionBrief=a.overFractionVerbose=a.closingFractionVerbose=a.openingFractionVerbose=a.nestedFraction=a.fractionNestingDepth=a.computeNestingDepth_=a.containsAttr=a.getNestingDepth=a.resetNestingDepth=a.nestingBarriers=a.spaceoutIdentifier=a.spaceoutNumber=a.spaceoutNodes=a.spaceoutText=void 0;const l=t(1426),c=t(6671),r=t(5024),s=t(4524),u=t(7793);let d={};function n(e,n){const r=Array.from(e.textContent),i=[],o=u.default.getInstance(),s=e.ownerDocument;for(let e,t=0;e=r[t];t++){const r=o.getNodeFactory().makeLeafNode(e,"unknown"),a=o.identifierNode(r,"unknown","");n(a),i.push(a.xml(s))}return i}function i(e,t,n,r,i,o){r=r||a.nestingBarriers,i=i||{},o=o||function(e){return!1};var s=c.serializeXml(t);if(d[e]||(d[e]={}),d[e][s])return d[e][s];if(o(t)||n.indexOf(t.tagName)<0)return 0;t=h(t,n,l.setdifference(r,n),i,o,0);return d[e][s]=t}function p(e,n){if(!e.attributes)return!1;var r=c.toArray(e.attributes);for(let e,t=0;e=r[t];t++)if(n[e.nodeName]===e.nodeValue)return!0;return!1}function h(e,t,n,r,i,o){if(i(e)||-1<n.indexOf(e.tagName)||p(e,r))return o;if(-1<t.indexOf(e.tagName)&&o++,!e.childNodes||0===e.childNodes.length)return o;const s=c.toArray(e.childNodes);return Math.max.apply(null,s.map(function(e){return h(e,t,n,r,i,o)}))}function o(e){return i("fraction",e,["fraction"],a.nestingBarriers,{},s.LOCALE.FUNCTIONS.fracNestDepth)}function f(e,t,n){const r=o(e),i=Array(r).fill(t);return n&&i.push(n),i.join(s.LOCALE.MESSAGES.regexp.JOINER_FRAC)}function m(e,t,n){for(;e.parentNode;){var r=e.parentNode,i=r.parentNode;if(!i)break;var o=e.getAttribute&&e.getAttribute("role");("subscript"===i.tagName&&e===r.childNodes[1]||"tensor"===i.tagName&&o&&("leftsub"===o||"rightsub"===o))&&(t=n.sub+s.LOCALE.MESSAGES.regexp.JOINER_SUBSUPER+t),("superscript"===i.tagName&&e===r.childNodes[1]||"tensor"===i.tagName&&o&&("leftsuper"===o||"rightsuper"===o))&&(t=n.sup+s.LOCALE.MESSAGES.regexp.JOINER_SUBSUPER+t),e=i}return t.trim()}function g(e){return i("radical",e,["sqrt","root"],a.nestingBarriers,{})}function b(e,t,n){var r=g(e),e=y(e);return n=e?s.LOCALE.FUNCTIONS.combineRootIndex(n,e):n,1===r?n:s.LOCALE.FUNCTIONS.combineNestedRadical(t,s.LOCALE.FUNCTIONS.radicalNestDepth(r-1),n)}function y(e){e="sqrt"===e.tagName?"2":r.evalXPath("children/*[1]",e)[0].textContent.trim();return s.LOCALE.MESSAGES.MSroots[e]||""}function S(e){return i("underscore",e,["underscore"],a.nestingBarriers,{},function(e){return e.tagName&&"underscore"===e.tagName&&"underaccent"===e.childNodes[0].childNodes[1].getAttribute("role")})}function E(e){return i("overscore",e,["overscore"],a.nestingBarriers,{},function(e){return e.tagName&&"overscore"===e.tagName&&"overaccent"===e.childNodes[0].childNodes[1].getAttribute("role")})}a.spaceoutText=function(e){return Array.from(e.textContent).join(" ")},a.spaceoutNodes=n,a.spaceoutNumber=function(e){return n(e,function(e){e.textContent.match(/\W/)||(e.type="number")})},a.spaceoutIdentifier=function(e){return n(e,function(e){e.font="unknown",e.type="identifier"})},a.nestingBarriers=["cases","cell","integral","line","matrix","multiline","overscore","root","row","sqrt","subscript","superscript","table","underscore","vector"],a.resetNestingDepth=function(e){return d={},[e]},a.getNestingDepth=i,a.containsAttr=p,a.computeNestingDepth_=h,a.fractionNestingDepth=o,a.nestedFraction=f,a.openingFractionVerbose=function(e){return f(e,s.LOCALE.MESSAGES.MS.START,s.LOCALE.MESSAGES.MS.FRAC_V)},a.closingFractionVerbose=function(e){return f(e,s.LOCALE.MESSAGES.MS.END,s.LOCALE.MESSAGES.MS.FRAC_V)},a.overFractionVerbose=function(e){return f(e,s.LOCALE.MESSAGES.MS.FRAC_OVER)},a.openingFractionBrief=function(e){return f(e,s.LOCALE.MESSAGES.MS.START,s.LOCALE.MESSAGES.MS.FRAC_B)},a.closingFractionBrief=function(e){return f(e,s.LOCALE.MESSAGES.MS.END,s.LOCALE.MESSAGES.MS.FRAC_B)},a.openingFractionSbrief=function(e){e=o(e);return 1===e?s.LOCALE.MESSAGES.MS.FRAC_S:s.LOCALE.FUNCTIONS.combineNestedFraction(s.LOCALE.MESSAGES.MS.NEST_FRAC,s.LOCALE.FUNCTIONS.radicalNestDepth(e-1),s.LOCALE.MESSAGES.MS.FRAC_S)},a.closingFractionSbrief=function(e){e=o(e);return 1===e?s.LOCALE.MESSAGES.MS.ENDFRAC:s.LOCALE.FUNCTIONS.combineNestedFraction(s.LOCALE.MESSAGES.MS.NEST_FRAC,s.LOCALE.FUNCTIONS.radicalNestDepth(e-1),s.LOCALE.MESSAGES.MS.ENDFRAC)},a.overFractionSbrief=function(e){e=o(e);return 1===e?s.LOCALE.MESSAGES.MS.FRAC_OVER:s.LOCALE.FUNCTIONS.combineNestedFraction(s.LOCALE.MESSAGES.MS.NEST_FRAC,s.LOCALE.FUNCTIONS.radicalNestDepth(e-1),s.LOCALE.MESSAGES.MS.FRAC_OVER)},a.isSmallVulgarFraction=function(e){return s.LOCALE.FUNCTIONS.fracNestDepth(e)?[e]:[]},a.nestedSubSuper=m,a.subscriptVerbose=function(e){return m(e,s.LOCALE.MESSAGES.MS.SUBSCRIPT,{sup:s.LOCALE.MESSAGES.MS.SUPER,sub:s.LOCALE.MESSAGES.MS.SUB})},a.subscriptBrief=function(e){return m(e,s.LOCALE.MESSAGES.MS.SUB,{sup:s.LOCALE.MESSAGES.MS.SUP,sub:s.LOCALE.MESSAGES.MS.SUB})},a.superscriptVerbose=function(e){return m(e,s.LOCALE.MESSAGES.MS.SUPERSCRIPT,{sup:s.LOCALE.MESSAGES.MS.SUPER,sub:s.LOCALE.MESSAGES.MS.SUB})},a.superscriptBrief=function(e){return m(e,s.LOCALE.MESSAGES.MS.SUP,{sup:s.LOCALE.MESSAGES.MS.SUP,sub:s.LOCALE.MESSAGES.MS.SUB})},a.baselineVerbose=function(e){const t=m(e,"",{sup:s.LOCALE.MESSAGES.MS.SUPER,sub:s.LOCALE.MESSAGES.MS.SUB});return t?t.replace(new RegExp(s.LOCALE.MESSAGES.MS.SUB+"$"),s.LOCALE.MESSAGES.MS.SUBSCRIPT).replace(new RegExp(s.LOCALE.MESSAGES.MS.SUPER+"$"),s.LOCALE.MESSAGES.MS.SUPERSCRIPT):s.LOCALE.MESSAGES.MS.BASELINE},a.baselineBrief=function(e){return m(e,"",{sup:s.LOCALE.MESSAGES.MS.SUP,sub:s.LOCALE.MESSAGES.MS.SUB})||s.LOCALE.MESSAGES.MS.BASE},a.radicalNestingDepth=g,a.nestedRadical=b,a.getRootIndex=y,a.openingRadicalVerbose=function(e){return b(e,s.LOCALE.MESSAGES.MS.NESTED,s.LOCALE.MESSAGES.MS.STARTROOT)},a.closingRadicalVerbose=function(e){return b(e,s.LOCALE.MESSAGES.MS.NESTED,s.LOCALE.MESSAGES.MS.ENDROOT)},a.indexRadicalVerbose=function(e){return b(e,s.LOCALE.MESSAGES.MS.NESTED,s.LOCALE.MESSAGES.MS.ROOTINDEX)},a.openingRadicalBrief=function(e){return b(e,s.LOCALE.MESSAGES.MS.NEST_ROOT,s.LOCALE.MESSAGES.MS.STARTROOT)},a.closingRadicalBrief=function(e){return b(e,s.LOCALE.MESSAGES.MS.NEST_ROOT,s.LOCALE.MESSAGES.MS.ENDROOT)},a.indexRadicalBrief=function(e){return b(e,s.LOCALE.MESSAGES.MS.NEST_ROOT,s.LOCALE.MESSAGES.MS.ROOTINDEX)},a.openingRadicalSbrief=function(e){return b(e,s.LOCALE.MESSAGES.MS.NEST_ROOT,s.LOCALE.MESSAGES.MS.ROOT)},a.indexRadicalSbrief=function(e){return b(e,s.LOCALE.MESSAGES.MS.NEST_ROOT,s.LOCALE.MESSAGES.MS.INDEX)},a.underscoreNestingDepth=S,a.nestedUnderscript=function(e){e=S(e);return Array(e).join(s.LOCALE.MESSAGES.MS.UNDER)+s.LOCALE.MESSAGES.MS.UNDERSCRIPT},a.overscoreNestingDepth=E,a.endscripts=function(e){return s.LOCALE.MESSAGES.MS.ENDSCRIPTS},a.nestedOverscript=function(e){e=E(e);return Array(e).join(s.LOCALE.MESSAGES.MS.OVER)+s.LOCALE.MESSAGES.MS.OVERSCRIPT},a.determinantIsSimple=function(e){if("matrix"!==e.tagName||"determinant"!==e.getAttribute("role"))return[];const n=r.evalXPath("children/row/children/cell/children/*",e);for(let e,t=0;e=n[t];t++)if("number"!==e.tagName){if("identifier"===e.tagName){const n=e.getAttribute("role");if("latinletter"===n||"greekletter"===n||"otherletter"===n)continue}return[]}return[e]},a.generateBaselineConstraint=function(){const e=e=>e.map(e=>"ancestor::"+e),t=e=>"not("+e+")",n=t(e(["subscript","superscript","tensor"]).join(" or ")),r=e(["relseq","multrel"]),i=e(["fraction","punctuation","fenced","sqrt","root"]);let o=[];for(let t,e=0;t=i[e];e++)o=o.concat(r.map(function(e){return t+"/"+e}));return[["ancestor::*/following-sibling::*",n,t(o.join(" | "))].join(" and ")]},a.removeParens=function(e){if(!e.childNodes.length||!e.childNodes[0].childNodes.length||!e.childNodes[0].childNodes[0].childNodes.length)return"";const t=e.childNodes[0].childNodes[0].childNodes[0].textContent;return t.match(/^\(.+\)$/)?t.slice(1,-1):t};const N=new Map([[3,"CSFleftsuperscript"],[4,"CSFleftsubscript"],[2,"CSFbaseline"],[1,"CSFrightsubscript"],[0,"CSFrightsuperscript"]]),v=new Map([[4,2],[3,3],[2,1],[1,4],[0,5]]);a.generateTensorRules=function(o,s=!0){var t=["11111","11110","11101","11100","10111","10110","10101","10100","01111","01110","01101","01100"];for(let i,e=0;i=t[e];e++){let e="tensor"+i,[t,n,r]=function(e){const t=[];let n="",r="",i=parseInt(e,2);for(let e=0;e<5;e++){var o="children/*["+v.get(e)+"]";if(1&i){const t=N.get(e%5);n="[t] "+t+"Verbose; [n] "+o+";"+n,r="[t] "+t+"Brief; [n] "+o+";"+r}else t.unshift("name("+o+')="empty"');i>>=1}return[t,n,r]}(i);o.defineRule(e,"default",n,"self::tensor",...t),s&&(o.defineRule(e,"brief",r,"self::tensor",...t),o.defineRule(e,"sbrief",r,"self::tensor",...t));var a=N.get(2),a=(n+="; [t]"+a+"Verbose",r+="; [t]"+a+"Brief",e+="-baseline","((.//*[not(*)])[last()]/@id)!=(((.//ancestor::fraction|ancestor::root|ancestor::sqrt|ancestor::cell|ancestor::line|ancestor::stree)[1]//*[not(*)])[last()]/@id)");o.defineRule(e,"default",n,"self::tensor",a,...t),s&&(o.defineRule(e,"brief",r,"self::tensor",a,...t),o.defineRule(e,"sbrief",r,"self::tensor",a,...t))}},a.smallRoot=function(e){var t=Object.keys(s.LOCALE.MESSAGES.MSroots).length;if(!t)return[];if(t++,!e.childNodes||0===e.childNodes.length||!e.childNodes[0].childNodes)return[];var n=e.childNodes[0].childNodes[0].textContent;if(!/^\d+$/.test(n))return[];n=parseInt(n,10);return 1<n&&n<=t?[e]:[]}},9570:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.implicitIterator=r.relationIterator=r.propagateNumber=r.checkParent_=r.NUMBER_INHIBITORS_=r.NUMBER_PROPAGATORS_=r.enlargeFence=r.indexRadical=r.closingRadical=r.openingRadical=r.radicalNestingDepth=r.nestedRadical=r.overBevelledFraction=r.overFraction=r.closingFraction=r.openingFraction=void 0;const d=t(4148),p=t(6671),n=t(5024),i=t(1058),h=t(4886),o=t(4036),s=t(241),f=t(4524),m=t(3269);function a(e,t){e=l(e);return 1===e?t:new Array(e).join(f.LOCALE.MESSAGES.MS.NESTED)+t}function l(e,t){t=t||0;return e.parentNode?l(e.parentNode,"root"===e.tagName||"sqrt"===e.tagName?t+1:t):t}function c(e){if(1===e.length)return"⠠"+e;const t=e.split("");return t.every(function(e){return"⠳"===e})?"⠠"+t.join("⠠"):e.slice(0,-1)+"⠠"+e.slice(-1)}function u(e,t){e=e.parent;if(!e)return!1;var n=e.type;return-1!==r.NUMBER_PROPAGATORS_.indexOf(n)||"prefixop"===n&&"negative"===e.role&&!t.script||"prefixop"===n&&"geometry"===e.role||!("punctuated"!==n||t.enclosed&&"text"!==e.role)}function g(e,t){return e.childNodes.length?(-1!==r.NUMBER_INHIBITORS_.indexOf(e.type)&&(t.script=!0),"fenced"===e.type?(t.number=!1,t.enclosed=!0):u(e,t)&&(t.number=!0,t.enclosed=!1),["",t]):(u(e,t)&&(t.number=!0,t.script=!1,t.enclosed=!1),[t.number?"number":"",{number:!1,enclosed:t.enclosed,script:t.script}])}r.openingFraction=function(e){e=m.fractionNestingDepth(e);return new Array(e).join(f.LOCALE.MESSAGES.MS.FRACTION_REPEAT)+f.LOCALE.MESSAGES.MS.FRACTION_START},r.closingFraction=function(e){e=m.fractionNestingDepth(e);return new Array(e).join(f.LOCALE.MESSAGES.MS.FRACTION_REPEAT)+f.LOCALE.MESSAGES.MS.FRACTION_END},r.overFraction=function(e){e=m.fractionNestingDepth(e);return new Array(e).join(f.LOCALE.MESSAGES.MS.FRACTION_REPEAT)+f.LOCALE.MESSAGES.MS.FRACTION_OVER},r.overBevelledFraction=function(e){e=m.fractionNestingDepth(e);return new Array(e).join(f.LOCALE.MESSAGES.MS.FRACTION_REPEAT)+"⠸"+f.LOCALE.MESSAGES.MS.FRACTION_OVER},r.nestedRadical=a,r.radicalNestingDepth=l,r.openingRadical=function(e){return a(e,f.LOCALE.MESSAGES.MS.STARTROOT)},r.closingRadical=function(e){return a(e,f.LOCALE.MESSAGES.MS.ENDROOT)},r.indexRadical=function(e){return a(e,f.LOCALE.MESSAGES.MS.ROOTINDEX)},r.enlargeFence=c,i.Grammar.getInstance().setCorrection("enlargeFence",c),r.NUMBER_PROPAGATORS_=["multirel","relseq","appl","row","line"],r.NUMBER_INHIBITORS_=["subscript","superscript","overscore","underscore"],r.checkParent_=u,r.propagateNumber=g,(0,o.register)(new s.SemanticVisitor("nemeth","number",g,{number:!0})),r.relationIterator=function(e,a){const l=e.slice(0);let c,u=!0;return c=0<e.length?n.evalXPath("../../content/*",e[0]):[],function(){const e=c.shift(),t=l.shift(),n=l[0],r=a?[d.AuditoryDescription.create({text:a},{translate:!0})]:[];if(!e)return r;var i=t?m.nestedSubSuper(t,"",{sup:f.LOCALE.MESSAGES.MS.SUPER,sub:f.LOCALE.MESSAGES.MS.SUB}):"",i=t&&"EMPTY"!==p.tagName(t)||u&&e.parentNode.parentNode&&e.parentNode.parentNode.previousSibling?[d.AuditoryDescription.create({text:"⠀"+i},{})]:[],o=n&&"EMPTY"!==p.tagName(n)||!c.length&&e.parentNode.parentNode&&e.parentNode.parentNode.nextSibling?[d.AuditoryDescription.create({text:"⠀"},{})]:[],s=h.default.evaluateNode(e);return u=!1,r.concat(i,s,o)}},r.implicitIterator=function(e,s){const a=e.slice(0);let l;return l=0<e.length?n.evalXPath("../../content/*",e[0]):[],function(){const e=a.shift(),t=a[0],n=l.shift(),r=s?[d.AuditoryDescription.create({text:s},{translate:!0})]:[];if(!n)return r;var i=e&&"NUMBER"===p.tagName(e),o=t&&"NUMBER"===p.tagName(t);return r.concat(i&&o&&"space"===n.getAttribute("role")?[d.AuditoryDescription.create({text:"⠀"},{})]:[])}}},2110:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ordinalPosition=t.vulgarFraction=t.wordCounter=t.ordinalCounter=void 0;const r=n(1930),i=n(6671),o=n(4524),s=n(9385);t.ordinalCounter=function(e,t){let n=0;return function(){return o.LOCALE.NUMBERS.numericOrdinal(++n)+" "+t}},t.wordCounter=function(e,t){let n=0;return function(){return o.LOCALE.NUMBERS.numberToOrdinal(++n,!1)+" "+t}},t.vulgarFraction=function(e){var t=(0,s.convertVulgarFraction)(e,o.LOCALE.MESSAGES.MS.FRAC_OVER);return t.convertible&&t.enumerator&&t.denominator?[new r.Span(o.LOCALE.NUMBERS.numberToWords(t.enumerator),{extid:e.childNodes[0].childNodes[0].getAttribute("extid"),separator:""}),new r.Span(o.LOCALE.NUMBERS.vulgarSep,{separator:""}),new r.Span(o.LOCALE.NUMBERS.numberToOrdinal(t.denominator,1!==t.enumerator),{extid:e.childNodes[0].childNodes[1].getAttribute("extid")})]:[new r.Span(t.content||"",{extid:e.getAttribute("extid")})]},t.ordinalPosition=function(e){const t=i.toArray(e.parentNode.childNodes);return o.LOCALE.NUMBERS.numericOrdinal(t.indexOf(e)+1).toString()}},3724:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.BrailleRules=t.OtherRules=t.PrefixRules=void 0;const r=n(8310),i=n(931),o=n(3269),s=n(9570),a=n(2110),l=n(7278);t.PrefixRules=function(){l.addStore("en.prefix.default","",{CSFordinalPosition:a.ordinalPosition})},t.OtherRules=function(){l.addStore("en.speech.chromevox","",{CTFnodeCounter:i.nodeCounter,CTFcontentIterator:i.contentIterator}),l.addStore("en.speech.emacspeak","en.speech.chromevox",{CQFvulgarFractionSmall:o.isSmallVulgarFraction,CSFvulgarFraction:a.vulgarFraction})},t.BrailleRules=function(){l.addStore("nemeth.braille.default",r.DynamicCstr.BASE_LOCALE+".speech.mathspeak",{CSFopenFraction:s.openingFraction,CSFcloseFraction:s.closingFraction,CSFoverFraction:s.overFraction,CSFoverBevFraction:s.overBevelledFraction,CSFopenRadical:s.openingRadical,CSFcloseRadical:s.closingRadical,CSFindexRadical:s.indexRadical,CSFsubscript:o.subscriptVerbose,CSFsuperscript:o.superscriptVerbose,CSFbaseline:o.baselineVerbose,CGFtensorRules:e=>o.generateTensorRules(e,!1),CTFrelationIterator:s.relationIterator,CTFimplicitIterator:s.implicitIterator})}},9805:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.INIT_=void 0;const r=n(127),i=n(4972),o=n(3724);t.INIT_=!1,t.init=function(){t.INIT_||((0,i.MathspeakRules)(),(0,r.ClearspeakRules)(),(0,o.PrefixRules)(),(0,o.OtherRules)(),(0,o.BrailleRules)(),t.INIT_=!0)}},7278:function(e,i,t){Object.defineProperty(i,"__esModule",{value:!0}),i.getStore=i.addStore=i.funcStore=void 0;const r=t(8310);i.funcStore=new Map,i.addStore=function(e,t,n){var r={};if(t){const e=i.funcStore.get(t)||{};Object.assign(r,e)}i.funcStore.set(e,Object.assign(r,n))},i.getStore=function(e,t,n){return i.funcStore.get([e,t,n].join("."))||i.funcStore.get([r.DynamicCstr.DEFAULT_VALUES[r.Axis.LOCALE],t,n].join("."))||i.funcStore.get([r.DynamicCstr.BASE_LOCALE,t,n].join("."))||{}}},9771:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.oneLeft=t.leftMostUnit=t.rightMostUnit=t.unitMultipliers=void 0;const i=n(4148),r=n(5024),o=n(4524),s=(t.unitMultipliers=function(e,t){const n=e;let r=0;return function(){var e=i.AuditoryDescription.create({text:a(n[r])&&l(n[r+1])?o.LOCALE.MESSAGES.unitTimes:""},{});return r++,[e]}},["superscript","subscript","overscore","underscore"]);function a(e){for(;e;){if("unit"===e.getAttribute("role"))return!0;var t=e.tagName,n=r.evalXPath("children/*",e);e=-1!==s.indexOf(t)?n[0]:n[n.length-1]}return!1}function l(e){for(;e;){if("unit"===e.getAttribute("role"))return!0;e=r.evalXPath("children/*",e)[0]}return!1}t.rightMostUnit=a,t.leftMostUnit=l,t.oneLeft=function(e){for(;e;){if("number"===e.tagName&&"1"===e.textContent)return[e];if("infixop"!==e.tagName||"multiplication"!==e.getAttribute("role")&&"implicit"!==e.getAttribute("role"))return[];e=r.evalXPath("children/*",e)[0]}return[]}},4660:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractWalker=void 0;const i=n(4148),o=n(4253),s=n(6671),r=n(4998),a=n(985),l=n(6988),c=n(8171),u=n(4524),d=n(1058),p=n(7984),h=n(7317),f=n(144),m=n(3955),g=n(5658),b=n(1848),y=n(8119),S=n(8835),E=n(5024);class N{constructor(e,t,n,r){this.node=e,this.generator=t,this.highlighter=n,this.modifier=!1,this.keyMapping=new Map([[l.KeyCode.UP,this.up.bind(this)],[l.KeyCode.DOWN,this.down.bind(this)],[l.KeyCode.RIGHT,this.right.bind(this)],[l.KeyCode.LEFT,this.left.bind(this)],[l.KeyCode.TAB,this.repeat.bind(this)],[l.KeyCode.DASH,this.expand.bind(this)],[l.KeyCode.SPACE,this.depth.bind(this)],[l.KeyCode.HOME,this.home.bind(this)],[l.KeyCode.X,this.summary.bind(this)],[l.KeyCode.Z,this.detail.bind(this)],[l.KeyCode.V,this.virtualize.bind(this)],[l.KeyCode.P,this.previous.bind(this)],[l.KeyCode.U,this.undo.bind(this)],[l.KeyCode.LESS,this.previousRules.bind(this)],[l.KeyCode.GREATER,this.nextRules.bind(this)]]),this.cursors=[],this.xml_=null,this.rebuilt_=null,this.focus_=null,this.active_=!1,this.node.id?this.id=this.node.id:this.node.hasAttribute(N.SRE_ID_ATTR)?this.id=this.node.getAttribute(N.SRE_ID_ATTR):(this.node.setAttribute(N.SRE_ID_ATTR,N.ID_COUNTER.toString()),this.id=N.ID_COUNTER++),this.rootNode=S.getSemanticRoot(e),this.rootId=this.rootNode.getAttribute(c.Attribute.ID),this.xmlString_=r,this.moved=y.WalkerMoves.ENTER}getXml(){return this.xml_||(this.xml_=s.parseInput(this.xmlString_)),this.xml_}getRebuilt(){return this.rebuilt_||this.rebuildStree(),this.rebuilt_}isActive(){return this.active_}activate(){this.isActive()||(this.generator.start(),this.toggleActive_())}deactivate(){this.isActive()&&(y.WalkerState.setState(this.id,this.primaryId()),this.generator.end(),this.toggleActive_())}getFocus(e=!1){return this.focus_||(this.focus_=this.singletonFocus(this.rootId)),e&&this.updateFocus(),this.focus_}setFocus(e){this.focus_=e}getDepth(){return this.levels.depth()-1}isSpeech(){return this.generator.modality===c.Attribute.SPEECH}focusDomNodes(){return this.getFocus().getDomNodes()}focusSemanticNodes(){return this.getFocus().getSemanticNodes()}speech(){var n=this.focusDomNodes();if(!n.length)return"";const r=this.specialMove();if(null!==r)return r;switch(this.moved){case y.WalkerMoves.DEPTH:return this.depth_();case y.WalkerMoves.SUMMARY:return this.summary_();case y.WalkerMoves.DETAIL:return this.detail_();default:{const r=[],s=this.focusSemanticNodes();for(let e=0,t=n.length;e<t;e++){var i=n[e],o=s[e];r.push(i?this.generator.getSpeech(i,this.getXml()):f.recomputeMarkup(o))}return this.mergePrefix_(r)}}}move(e){const t=this.keyMapping.get(e);if(!t)return null;e=t();return!(!e||e===this.getFocus()||(this.setFocus(e),this.moved===y.WalkerMoves.HOME&&(this.levels=this.initLevels()),0))}up(){return this.moved=y.WalkerMoves.UP,this.getFocus()}down(){return this.moved=y.WalkerMoves.DOWN,this.getFocus()}left(){return this.moved=y.WalkerMoves.LEFT,this.getFocus()}right(){return this.moved=y.WalkerMoves.RIGHT,this.getFocus()}repeat(){return this.moved=y.WalkerMoves.REPEAT,this.getFocus().clone()}depth(){return this.moved=this.isSpeech()?y.WalkerMoves.DEPTH:y.WalkerMoves.REPEAT,this.getFocus().clone()}home(){return this.moved=y.WalkerMoves.HOME,this.singletonFocus(this.rootId)}getBySemanticId(e){return S.getBySemanticId(this.node,e)}primaryId(){return this.getFocus().getSemanticPrimary().id.toString()}expand(){const e=this.getFocus().getDomPrimary(),t=this.actionable_(e);return t?(this.moved=y.WalkerMoves.EXPAND,t.dispatchEvent(new Event("click")),this.getFocus().clone()):this.getFocus()}expandable(e){return!!this.actionable_(e)&&0===e.childNodes.length}collapsible(e){return!!this.actionable_(e)&&0<e.childNodes.length}restoreState(){if(this.highlighter){const t=y.WalkerState.getState(this.id);if(t){let e=this.getRebuilt().nodeDict[t];const n=[];for(;e;)n.push(e.id),e=e.parent;for(n.pop();0<n.length;){this.down();const t=n.pop(),e=this.findFocusOnLevel(t);if(!e)break;this.setFocus(e)}this.moved=y.WalkerMoves.ENTER}}}updateFocus(){this.setFocus(g.Focus.factory(this.getFocus().getSemanticPrimary().id.toString(),this.getFocus().getSemanticNodes().map(e=>e.id.toString()),this.getRebuilt(),this.node))}rebuildStree(){this.rebuilt_=new b.RebuildStree(this.getXml()),this.rootId=this.rebuilt_.stree.root.id.toString(),this.generator.setRebuilt(this.rebuilt_),this.skeleton=p.SemanticSkeleton.fromTree(this.rebuilt_.stree),this.skeleton.populate(),this.focus_=this.singletonFocus(this.rootId),this.levels=this.initLevels(),f.connectMactions(this.node,this.getXml(),this.rebuilt_.xml)}previousLevel(){var e=this.getFocus().getDomPrimary();return e?S.getAttribute(e,c.Attribute.PARENT):this.getFocus().getSemanticPrimary().parent.id.toString()}nextLevel(){var e=this.getFocus().getDomPrimary();let t,n;if(e){t=S.splitAttribute(S.getAttribute(e,c.Attribute.CHILDREN)),n=S.splitAttribute(S.getAttribute(e,c.Attribute.CONTENT));const r=S.getAttribute(e,c.Attribute.TYPE),i=S.getAttribute(e,c.Attribute.ROLE);return this.combineContentChildren(r,i,n,t)}const r=e=>e.id.toString(),i=this.getRebuilt().nodeDict[this.primaryId()];return t=i.childNodes.map(r),n=i.contentNodes.map(r),0===t.length?[]:this.combineContentChildren(i.type,i.role,n,t)}singletonFocus(e){this.getRebuilt();var t=this.retrieveVisuals(e);return this.focusFromId(e,t)}retrieveVisuals(e){if(!this.skeleton)return[e];const t=parseInt(e,10),n=this.skeleton.subtreeNodes(t);if(!n.length)return[e];n.unshift(t);const r={},i=[];E.updateEvaluator(this.getXml());for(const e of n)r[e]||(i.push(e.toString()),r[e]=!0,this.subtreeIds(e,r));return i}subtreeIds(e,t){e=E.evalXPath(`//*[@data-semantic-id="${e}"]`,this.getXml());E.evalXPath("*//@data-semantic-id",e[0]).forEach(e=>t[parseInt(e.textContent,10)]=!0)}focusFromId(e,t){return g.Focus.factory(e,t,this.getRebuilt(),this.node)}summary(){return this.moved=this.isSpeech()?y.WalkerMoves.SUMMARY:y.WalkerMoves.REPEAT,this.getFocus().clone()}detail(){return this.moved=this.isSpeech()?y.WalkerMoves.DETAIL:y.WalkerMoves.REPEAT,this.getFocus().clone()}specialMove(){return null}virtualize(e){return this.cursors.push({focus:this.getFocus(),levels:this.levels,undo:e||!this.cursors.length}),this.levels=this.levels.clone(),this.getFocus().clone()}previous(){var e=this.cursors.pop();return e?(this.levels=e.levels,e.focus):this.getFocus()}undo(){let e;for(;(e=this.cursors.pop())&&!e.undo;);return e?(this.levels=e.levels,e.focus):this.getFocus()}update(e){this.generator.setOptions(e),(0,a.setup)(e).then(()=>h.generator("Tree").getSpeech(this.node,this.getXml()))}nextRules(){const e=this.generator.getOptions();return"speech"!==e.modality?this.getFocus():(r.DOMAIN_TO_STYLES[e.domain]=e.style,e.domain="mathspeak"===e.domain?"clearspeak":"mathspeak",e.style=r.DOMAIN_TO_STYLES[e.domain],this.update(e),this.moved=y.WalkerMoves.REPEAT,this.getFocus().clone())}nextStyle(e,t){if("mathspeak"===e){const e=["default","brief","sbrief"],r=e.indexOf(t);return-1===r?t:r>=e.length-1?e[0]:e[r+1]}if("clearspeak"!==e)return t;{const e=m.ClearspeakPreferences.getLocalePreferences().en;if(!e)return"default";const i=m.ClearspeakPreferences.relevantPreferences(this.getFocus().getSemanticPrimary()),o=m.ClearspeakPreferences.findPreference(t,i),s=e[i].map(function(e){return e.split("_")[1]}),a=s.indexOf(o);if(-1===a)return t;var n=a>=s.length-1?s[0]:s[a+1];return m.ClearspeakPreferences.addPreference(t,i,n)}}previousRules(){const e=this.generator.getOptions();return"speech"!==e.modality?this.getFocus():(e.style=this.nextStyle(e.domain,e.style),this.update(e),this.moved=y.WalkerMoves.REPEAT,this.getFocus().clone())}refocus(){let e,t=this.getFocus();for(;!t.getNodes().length;){e=this.levels.peek();var n=this.up();if(!n)break;this.setFocus(n),t=this.getFocus(!0)}this.levels.push(e),this.setFocus(t)}toggleActive_(){this.active_=!this.active_}mergePrefix_(e,t=[]){var n=this.isSpeech()?this.prefix_():"",n=(n&&e.unshift(n),this.isSpeech()?this.postfix_():"");return n&&e.push(n),o.finalize(o.merge(t.concat(e)))}prefix_(){var e=this.getFocus().getDomNodes(),t=this.getFocus().getSemanticNodes();return e[0]?S.getAttribute(e[0],c.Attribute.PREFIX):f.retrievePrefix(t[0])}postfix_(){var e=this.getFocus().getDomNodes();return e[0]?S.getAttribute(e[0],c.Attribute.POSTFIX):""}depth_(){var e=d.Grammar.getInstance().getParameter("depth"),t=(d.Grammar.getInstance().setParameter("depth",!0),this.getFocus().getDomPrimary()),t=this.expandable(t)?u.LOCALE.MESSAGES.navigate.EXPANDABLE:this.collapsible(t)?u.LOCALE.MESSAGES.navigate.COLLAPSIBLE:"",n=u.LOCALE.MESSAGES.navigate.LEVEL+" "+this.getDepth(),r=this.getFocus().getSemanticNodes(),r=f.retrievePrefix(r[0]),n=[new i.AuditoryDescription({text:n,personality:{}}),new i.AuditoryDescription({text:r,personality:{}}),new i.AuditoryDescription({text:t,personality:{}})];return d.Grammar.getInstance().setParameter("depth",e),o.finalize(o.markup(n))}actionable_(e){e=null==e?void 0:e.parentNode;return e&&this.highlighter.isMactionNode(e)?e:null}summary_(){var e=this.getFocus().getSemanticPrimary().id.toString(),e=this.getRebuilt().xml.getAttribute("id")===e?this.getRebuilt().xml:s.querySelectorAllByAttrValue(this.getRebuilt().xml,"id",e)[0],e=f.retrieveSummary(e);return this.mergePrefix_([e])}detail_(){const e=this.getFocus().getSemanticPrimary().id.toString(),t=this.getRebuilt().xml.getAttribute("id")===e?this.getRebuilt().xml:s.querySelectorAllByAttrValue(this.getRebuilt().xml,"id",e)[0],n=t.getAttribute("alternative");t.removeAttribute("alternative");var r=f.computeMarkup(t),r=this.mergePrefix_([r]);return t.setAttribute("alternative",n),r}}(t.AbstractWalker=N).ID_COUNTER=0,N.SRE_ID_ATTR="sre-explorer-id"},4296:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.DummyWalker=void 0;class r extends n(4660).AbstractWalker{up(){return null}down(){return null}left(){return null}right(){return null}repeat(){return null}depth(){return null}home(){return null}getDepth(){return 0}initLevels(){return null}combineContentChildren(e,t,n,r){return[]}findFocusOnLevel(e){return null}}t.DummyWalker=r},5658:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Focus=void 0;const d=n(8835);class p{constructor(e,t){this.nodes=e,this.primary=t,this.domNodes=[],this.domPrimary_=null,this.allNodes=[]}static factory(e,t,n,r){const i=e=>d.getBySemanticId(r,e),o=n.nodeDict,s=i(e),a=t.map(i),l=t.map(function(e){return o[e]}),c=new p(l,o[e]);return c.domNodes=a,c.domPrimary_=s,c.allNodes=p.generateAllVisibleNodes_(t,a,o,r),c}static generateAllVisibleNodes_(n,r,i,o){var s=e=>d.getBySemanticId(o,e);let a=[];for(let e=0,t=n.length;e<t;e++)if(r[e])a.push(r[e]);else{const l=i[n[e]];if(l){const c=l.childNodes.map(function(e){return e.id.toString()}),u=c.map(s);a=a.concat(p.generateAllVisibleNodes_(c,u,i,o))}}return a}getSemanticPrimary(){return this.primary}getSemanticNodes(){return this.nodes}getNodes(){return this.allNodes}getDomNodes(){return this.domNodes}getDomPrimary(){return this.domPrimary_}toString(){return"Primary:"+this.domPrimary_+" Nodes:"+this.domNodes}clone(){const e=new p(this.nodes,this.primary);return e.domNodes=this.domNodes,e.domPrimary_=this.domPrimary_,e.allNodes=this.allNodes,e}}t.Focus=p},1497:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Levels=void 0;t.Levels=class n{constructor(){this.level_=[]}push(e){this.level_.push(e)}pop(){return this.level_.pop()}peek(){return this.level_[this.level_.length-1]||null}indexOf(e){const t=this.peek();return t?t.indexOf(e):null}find(n){var r=this.peek();if(!r)return null;for(let e=0,t=r.length;e<t;e++)if(n(r[e]))return r[e];return null}get(e){var t=this.peek();return!t||e<0||e>=t.length?null:t[e]}depth(){return this.level_.length}clone(){const e=new n;return e.level_=this.level_.slice(0),e}toString(){let n="";for(let e,t=0;e=this.level_[t];t++)n+="\n"+e.map(function(e){return e.toString()});return n}}},1848:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.RebuildStree=void 0;const r=n(6671),c=n(8171),i=n(4020),o=n(4790),s=n(7793),a=n(7984),l=n(1784),u=n(8901),d=n(8835);class p{constructor(e){this.mathml=e,this.factory=new o.SemanticNodeFactory,this.nodeDict={},this.mmlRoot=d.getSemanticRoot(e),this.streeRoot=this.assembleTree(this.mmlRoot),this.stree=l.SemanticTree.fromNode(this.streeRoot,this.mathml),this.xml=this.stree.xml(),s.default.getInstance().setNodeFactory(this.factory)}static addAttributes(e,t,n){n&&1===t.childNodes.length&&t.childNodes[0].nodeType!==r.NodeType.TEXT_NODE&&u.addAttributes(e,t.childNodes[0]),u.addAttributes(e,t)}static textContent(e,t,n){!n&&t.textContent?e.textContent=t.textContent:1<(n=d.splitAttribute(d.getAttribute(t,c.Attribute.OPERATOR))).length&&(e.textContent=n[1])}static isPunctuated(e){return!a.SemanticSkeleton.simpleCollapseStructure(e)&&e[1]&&a.SemanticSkeleton.contentCollapseStructure(e[1])}getTree(){return this.stree}assembleTree(e){const t=this.makeNode(e),n=d.splitAttribute(d.getAttribute(e,c.Attribute.CHILDREN)),r=d.splitAttribute(d.getAttribute(e,c.Attribute.CONTENT));if(p.addAttributes(t,e,!(n.length||r.length)),0===r.length&&0===n.length)return p.textContent(t,e),t;if(0<r.length){const e=d.getBySemanticId(this.mathml,r[0]);e&&p.textContent(t,e,!0)}t.contentNodes=r.map(e=>this.setParent(e,t)),t.childNodes=n.map(e=>this.setParent(e,t));e=d.getAttribute(e,c.Attribute.COLLAPSED);return e?this.postProcess(t,e):t}makeNode(e){const t=d.getAttribute(e,c.Attribute.TYPE),n=d.getAttribute(e,c.Attribute.ROLE),r=d.getAttribute(e,c.Attribute.FONT),i=d.getAttribute(e,c.Attribute.ANNOTATION)||"",o=d.getAttribute(e,c.Attribute.ID),s=d.getAttribute(e,c.Attribute.EMBELLISHED),a=d.getAttribute(e,c.Attribute.FENCEPOINTER),l=this.createNode(parseInt(o,10));return l.type=t,l.role=n,l.font=r||"unknown",l.parseAnnotation(i),a&&(l.fencePointer=a),s&&(l.embellished=s),l}makePunctuation(e){const t=this.createNode(e);return t.updateContent((0,i.invisibleComma)()),t.role="dummy",t}makePunctuated(e,t,n){const r=this.createNode(t[0]),i=(r.type="punctuated",r.embellished=e.embellished,r.fencePointer=e.fencePointer,r.role=n,t.splice(1,1)[0].slice(1));r.contentNodes=i.map(this.makePunctuation.bind(this)),this.collapsedChildren_(t)}makeEmpty(e,t,n){const r=this.createNode(t);r.type="empty",r.embellished=e.embellished,r.fencePointer=e.fencePointer,r.role=n}makeIndex(e,t,n){if(p.isPunctuated(t))return this.makePunctuated(e,t,n),void t[0];a.SemanticSkeleton.simpleCollapseStructure(t)&&!this.nodeDict[t.toString()]&&this.makeEmpty(e,t,n)}postProcess(e,t){const n=a.SemanticSkeleton.fromString(t).array;if("subsup"===e.type){const t=this.createNode(n[1][0]);return t.type="subscript",t.role="subsup",e.type="superscript",t.embellished=e.embellished,t.fencePointer=e.fencePointer,this.makeIndex(e,n[1][2],"rightsub"),this.makeIndex(e,n[2],"rightsuper"),this.collapsedChildren_(n),e}if("subscript"===e.type)return this.makeIndex(e,n[2],"rightsub"),this.collapsedChildren_(n),e;if("superscript"===e.type)return this.makeIndex(e,n[2],"rightsuper"),this.collapsedChildren_(n),e;if("tensor"===e.type)return this.makeIndex(e,n[2],"leftsub"),this.makeIndex(e,n[3],"leftsuper"),this.makeIndex(e,n[4],"rightsub"),this.makeIndex(e,n[5],"rightsuper"),this.collapsedChildren_(n),e;if("punctuated"===e.type){if(p.isPunctuated(n)){const t=n.splice(1,1)[0].slice(1);e.contentNodes=t.map(this.makePunctuation.bind(this))}return e}if("underover"!==e.type)return e;{const t=this.createNode(n[1][0]);return"overaccent"===e.childNodes[1].role?(t.type="overscore",e.type="underscore"):(t.type="underscore",e.type="overscore"),t.role="underover",t.embellished=e.embellished,t.fencePointer=e.fencePointer,this.collapsedChildren_(n),e}}createNode(e){var t=this.factory.makeNode(e);return this.nodeDict[e.toString()]=t}collapsedChildren_(e){const o=n=>{const r=this.nodeDict[n[0]];r.childNodes=[];for(let e=1,t=n.length;e<t;e++){var i=n[e];r.childNodes.push(a.SemanticSkeleton.simpleCollapseStructure(i)?this.nodeDict[i]:o(i))}return r};o(e)}setParent(e,t){const n=d.getBySemanticId(this.mathml,e),r=this.assembleTree(n);return r.parent=t,r}}t.RebuildStree=p},1937:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticWalker=void 0;const r=n(4660),i=n(1497);class o extends r.AbstractWalker{constructor(e,t,n,r){super(e,t,n,r),this.node=e,this.generator=t,this.highlighter=n,this.levels=null,this.restoreState()}initLevels(){const e=new i.Levels;return e.push([this.getFocus()]),e}up(){super.up();const t=this.previousLevel();return t?(this.levels.pop(),this.levels.find(function(e){return e.getSemanticNodes().some(function(e){return e.id.toString()===t})})):null}down(){super.down();var e=this.nextLevel();return 0===e.length?null:(this.levels.push(e),e[0])}combineContentChildren(e,t,n,r){switch(e){case"relseq":case"infixop":case"multirel":return this.makePairList(r,n);case"prefixop":return[this.focusFromId(r[0],n.concat(r))];case"postfixop":return[this.focusFromId(r[0],r.concat(n))];case"matrix":case"vector":case"fenced":return[this.focusFromId(r[0],[n[0],r[0],n[1]])];case"cases":return[this.focusFromId(r[0],[n[0],r[0]])];case"punctuated":return"text"===t?r.map(this.singletonFocus.bind(this)):r.length===n.length?n.map(this.singletonFocus.bind(this)):this.combinePunctuations(r,n,[],[]);case"appl":return[this.focusFromId(r[0],[r[0],n[0]]),this.singletonFocus(r[1])];case"root":return[this.singletonFocus(r[1]),this.singletonFocus(r[0])];default:return r.map(this.singletonFocus.bind(this))}}combinePunctuations(e,t,n,r){if(0===e.length)return r;var i=e.shift(),o=t.shift();return i===o?(n.push(o),this.combinePunctuations(e,t,n,r)):(t.unshift(o),n.push(i),e.length===t.length?(r.push(this.focusFromId(i,n.concat(t))),r):(r.push(this.focusFromId(i,n)),this.combinePunctuations(e,t,[],r)))}makePairList(n,r){if(0===n.length)return[];if(1===n.length)return[this.singletonFocus(n[0])];const i=[this.singletonFocus(n.shift())];for(let e=0,t=n.length;e<t;e++)i.push(this.focusFromId(n[e],[r[e],n[e]]));return i}left(){super.left();var e=this.levels.indexOf(this.getFocus());return null!==e&&this.levels.get(e-1)||null}right(){super.right();var e=this.levels.indexOf(this.getFocus());return null!==e&&this.levels.get(e+1)||null}findFocusOnLevel(t){return this.levels.find(e=>e.getSemanticPrimary().id===t)}}t.SemanticWalker=o},3531:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SyntaxWalker=void 0;const i=n(1426),r=n(4660),o=n(1497);class s extends r.AbstractWalker{constructor(e,t,n,r){super(e,t,n,r),this.node=e,this.generator=t,this.highlighter=n,this.levels=null,this.restoreState()}initLevels(){const e=new o.Levels;return e.push([this.primaryId()]),e}up(){super.up();var e=this.previousLevel();return e?(this.levels.pop(),this.singletonFocus(e)):null}down(){super.down();var e=this.nextLevel();if(0===e.length)return null;var t=this.singletonFocus(e[0]);return t&&this.levels.push(e),t}combineContentChildren(e,t,n,r){switch(e){case"relseq":case"infixop":case"multirel":return(0,i.interleaveLists)(r,n);case"prefixop":return n.concat(r);case"postfixop":return r.concat(n);case"matrix":case"vector":case"fenced":return r.unshift(n[0]),r.push(n[1]),r;case"cases":return r.unshift(n[0]),r;case"punctuated":return"text"===t?(0,i.interleaveLists)(r,n):r;case"appl":return[r[0],n[0],r[1]];case"root":return[r[1],r[0]];default:return r}}left(){super.left();var e=this.levels.indexOf(this.primaryId());if(null===e)return null;e=this.levels.get(e-1);return e?this.singletonFocus(e):null}right(){super.right();var e=this.levels.indexOf(this.primaryId());if(null===e)return null;e=this.levels.get(e+1);return e?this.singletonFocus(e):null}findFocusOnLevel(e){return this.singletonFocus(e.toString())}focusDomNodes(){return[this.getFocus().getDomPrimary()]}focusSemanticNodes(){return[this.getFocus().getSemanticPrimary()]}}t.SyntaxWalker=s},4051:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TableWalker=void 0;const o=n(6671),i=n(6988),r=n(3531),s=n(8119);class a extends r.SyntaxWalker{constructor(e,t,n,r){super(e,t,n,r),this.node=e,this.generator=t,this.highlighter=n,this.firstJump=null,this.key_=null,this.row_=0,this.currentTable_=null,this.keyMapping.set(i.KeyCode.ZERO,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.ONE,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.TWO,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.THREE,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.FOUR,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.FIVE,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.SIX,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.SEVEN,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.EIGHT,this.jumpCell.bind(this)),this.keyMapping.set(i.KeyCode.NINE,this.jumpCell.bind(this))}move(e){this.key_=e;e=super.move(e);return this.modifier=!1,e}up(){return this.moved=s.WalkerMoves.UP,this.eligibleCell_()?this.verticalMove_(!1):super.up()}down(){return this.moved=s.WalkerMoves.DOWN,this.eligibleCell_()?this.verticalMove_(!0):super.down()}jumpCell(){if(!this.isInTable_()||null===this.key_)return this.getFocus();if(this.moved===s.WalkerMoves.ROW){this.moved=s.WalkerMoves.CELL;const e=this.key_-i.KeyCode.ZERO;return this.isLegalJump_(this.row_,e)?this.jumpCell_(this.row_,e):this.getFocus()}const e=this.key_-i.KeyCode.ZERO;return e>this.currentTable_.childNodes.length?this.getFocus():(this.row_=e,this.moved=s.WalkerMoves.ROW,this.getFocus().clone())}undo(){var e=super.undo();return e===this.firstJump&&(this.firstJump=null),e}eligibleCell_(){var e=this.getFocus().getSemanticPrimary();return this.modifier&&"cell"===e.type&&-1!==a.ELIGIBLE_CELL_ROLES.indexOf(e.role)}verticalMove_(e){var t=this.previousLevel();if(!t)return null;var n=this.getFocus(),r=this.levels.indexOf(this.primaryId()),i=this.levels.pop(),t=this.levels.indexOf(t),e=this.levels.get(e?t+1:t-1);if(!e)return this.levels.push(i),null;this.setFocus(this.singletonFocus(e));t=this.nextLevel();return t[r]?(this.levels.push(t),this.singletonFocus(t[r])):(this.setFocus(n),this.levels.push(i),null)}jumpCell_(e,t){this.firstJump?this.virtualize(!1):(this.firstJump=this.getFocus(),this.virtualize(!0));var n=this.currentTable_.id.toString();let r;for(;-1===(r=this.levels.pop()).indexOf(n););this.levels.push(r),this.setFocus(this.singletonFocus(n)),this.levels.push(this.nextLevel());const i=this.currentTable_.childNodes[e-1];return this.setFocus(this.singletonFocus(i.id.toString())),this.levels.push(this.nextLevel()),this.singletonFocus(i.childNodes[t-1].id.toString())}isLegalJump_(e,t){const n=o.querySelectorAllByAttrValue(this.getRebuilt().xml,"id",this.currentTable_.id.toString())[0];if(!n||n.hasAttribute("alternative"))return!1;const r=this.currentTable_.childNodes[e-1];if(!r)return!1;const i=o.querySelectorAllByAttrValue(n,"id",r.id.toString())[0];return!(!i||i.hasAttribute("alternative")||!r||!r.childNodes[t-1])}isInTable_(){let e=this.getFocus().getSemanticPrimary();for(;e;){if(-1!==a.ELIGIBLE_TABLE_TYPES.indexOf(e.type))return this.currentTable_=e,!0;e=e.parent}return!1}}(t.TableWalker=a).ELIGIBLE_CELL_ROLES=["determinant","rowvector","binomial","squarematrix","multiline","matrix","vector","cases","table"],a.ELIGIBLE_TABLE_TYPES=["multiline","matrix","vector","cases","table"]},8119:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WalkerState=t.WalkerMoves=void 0,(n=t.WalkerMoves||(t.WalkerMoves={})).UP="up",n.DOWN="down",n.LEFT="left",n.RIGHT="right",n.REPEAT="repeat",n.DEPTH="depth",n.ENTER="enter",n.EXPAND="expand",n.HOME="home",n.SUMMARY="summary",n.DETAIL="detail",n.ROW="row",n.CELL="cell";class r{static resetState(e){delete r.STATE[e]}static setState(e,t){r.STATE[e]=t}static getState(e){return r.STATE[e]}}(t.WalkerState=r).STATE={}},907:function(e,o,t){Object.defineProperty(o,"__esModule",{value:!0}),o.walkerMapping_=o.walker=void 0;const i=t(4296),s=t(1937),a=t(3531),l=t(4051);o.walker=function(e,t,n,r,i){return(o.walkerMapping_[e.toLowerCase()]||o.walkerMapping_.dummy)(t,n,r,i)},o.walkerMapping_={dummy:(e,t,n,r)=>new i.DummyWalker(e,t,n,r),semantic:(e,t,n,r)=>new s.SemanticWalker(e,t,n,r),syntax:(e,t,n,r)=>new a.SyntaxWalker(e,t,n,r),table:(e,t,n,r)=>new l.TableWalker(e,t,n,r)}},8835:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getBySemanticId=t.getSemanticRoot=t.getAttribute=t.splitAttribute=void 0;const r=n(6671),i=n(8171);t.splitAttribute=function(e){return e?e.split(/,/):[]},t.getAttribute=function(e,t){return e.getAttribute(t)},t.getSemanticRoot=function(e){if(e.hasAttribute(i.Attribute.TYPE)&&!e.hasAttribute(i.Attribute.PARENT))return e;var n=r.querySelectorAllByAttr(e,i.Attribute.TYPE);for(let e,t=0;e=n[t];t++)if(!e.hasAttribute(i.Attribute.PARENT))return e;return e},t.getBySemanticId=function(e,t){return e.getAttribute(i.Attribute.ID)===t?e:r.querySelectorAllByAttrValue(e,i.Attribute.ID,t)[0]}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var __webpack_exports__={},global,version,MJContextMenu,Menu,MenuHandler,MmlVisitor,SelectableInfo,global=__webpack_require__(8723),version=__webpack_require__(7306),MJContextMenu=__webpack_require__(3021),Menu=__webpack_require__(1062),MenuHandler=__webpack_require__(9003),MmlVisitor=__webpack_require__(9232),SelectableInfo=__webpack_require__(7309);MathJax.loader&&MathJax.loader.checkVersion("ui/menu",version.q,"ui"),(0,global.combineWithMathJax)({_:{ui:{menu:{MJContextMenu:MJContextMenu,Menu:Menu,MenuHandler:MenuHandler,MmlVisitor:MmlVisitor,SelectableInfo:SelectableInfo}}}}),MathJax.startup&&"undefined"!=typeof window&&MathJax.startup.extendHandler(function(e){return(0,MenuHandler.MenuHandler)(e)},20)}();